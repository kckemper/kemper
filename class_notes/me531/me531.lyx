#LyX 1.6.7 created this file. For more info see http://www.lyx.org/
\lyxformat 345
\begin_document
\begin_header
\textclass article
\begin_preamble
\usepackage{color}
\end_preamble
\use_default_options true
\language english
\inputencoding auto
\font_roman default
\font_sans default
\font_typewriter default
\font_default_family default
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100

\graphics default
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen true
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder false
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle true
\papersize letterpaper
\use_geometry true
\use_amsmath 1
\use_esint 1
\cite_engine basic
\use_bibtopic false
\paperorientation portrait
\leftmargin 0.75in
\topmargin 0.75in
\rightmargin 0.75in
\bottommargin 0.75in
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\defskip medskip
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\author "" 
\author "" 
\end_header

\begin_body

\begin_layout Title
ME531 Multivariable Linear Control: Notes
\end_layout

\begin_layout Author
Kevin Kemper
\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
Changes to make
\end_layout

\begin_layout Itemize
Change 
\begin_inset Formula $\tilde{N}$
\end_inset

 to something else to not get confused with errors.
\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
9/27/2010
\end_layout

\begin_layout Subsection
Control system components
\end_layout

\begin_layout Standard
A control system is a device or process whose behaviors is influnecd by
 external stimuli (control inputs) according to a set of rules (system dynamics).
 It is defined by:
\end_layout

\begin_layout Itemize

\series bold
State
\series default
: the minimum number of variables that characterize the behavior of the
 system.
\end_layout

\begin_layout Itemize

\series bold
Inputs:
\series default
 variables that can be manipulated to affect the outputs.
\end_layout

\begin_layout Itemize

\series bold
Outputs:
\series default
 variables of interest and are measured by sensors.
\end_layout

\begin_layout Itemize

\series bold
System dynamics/plant: 
\series default
object under control.
\end_layout

\begin_layout Itemize

\series bold
Control limts:
\end_layout

\begin_layout Subsection
Approaches to control:
\end_layout

\begin_layout Standard
For linear time-invariant systems there are typically two approaches to
 control.
\end_layout

\begin_layout Itemize
The frequency domain (clasical control) approach.
\end_layout

\begin_layout Itemize
Time domain (state-space/modern) control approach.
\end_layout

\begin_layout Subsubsection
Classical control approach overview
\end_layout

\begin_layout Itemize
Take laplace transform of the equation of motion of the system.
\end_layout

\begin_layout Itemize
Analyze response characteristics and stability vs.
 performance specifications.
\end_layout

\begin_layout Itemize
Design controller to achieve stability and performance specifications
\end_layout

\begin_deeper
\begin_layout Itemize
Routh's criterion (stability)
\end_layout

\begin_layout Itemize
Root locus (performance specifcations)
\end_layout

\begin_layout Itemize
Bode plots (gain and phase margin 
\begin_inset Formula $\rightarrow$
\end_inset

 relative stability, bandwidth 
\begin_inset Formula $\rightarrow$
\end_inset

 perfromance specifications)
\end_layout

\begin_layout Itemize
Nyquist criterion (stablitiy)
\end_layout

\end_deeper
\begin_layout Paragraph
Advantages
\end_layout

\begin_layout Itemize
Relatively easy to develop a controller to meet set of performance specification
s.
\end_layout

\begin_layout Itemize
Also include some well developed tools for studying robustness to disturbances,
 sensor noise, and model uncertainty.
\end_layout

\begin_layout Paragraph
Disadvantages
\end_layout

\begin_layout Itemize
Approach focuses on single input single output (SISO) systems.
 While classical techniques can be extended to multiple input multiple output
 (MIMO) systems, the process is tedious and Ad Hoc.
\end_layout

\begin_layout Itemize
This approach is only valid for linear time-invariant (LTI) systems.
\end_layout

\begin_layout Subsubsection
State-space approach
\end_layout

\begin_layout Standard
Have 
\begin_inset Formula $n^{th}$
\end_inset

 order system (set of 
\begin_inset Formula $n^{th}$
\end_inset

 order DEs) and represent it by a set of first order differential equations
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}+B\bar{u}\\
\bar{y} & = & C\bar{x}+D\bar{u}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\bar{x} & = & \text{state}\\
\bar{u} & = & \text{control (inputs)}\\
\bar{y} & = & \text{output}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Paragraph
Advantages
\end_layout

\begin_layout Itemize
Easily treat MIMO systems.
\end_layout

\begin_layout Itemize
Straight forward extensions exist for linear time-variant systems.
\end_layout

\begin_layout Itemize
Optimal control problems are formulated and solved using the state space
 approach.
\end_layout

\begin_layout Itemize
System properties, such as controllability and observability, are defined
 in this setting.
\end_layout

\begin_layout Paragraph
Disadvantages
\end_layout

\begin_layout Itemize
More difficult to describe how performance specifications should influence
 the compensator design.
\end_layout

\begin_layout Itemize
Feedback control in this formulation typically requires knowledge of the
 full state, which can be difficult/expensive.
\end_layout

\begin_layout Subsection
State-space models
\end_layout

\begin_layout Standard
These can be generated from:
\end_layout

\begin_layout Itemize
\begin_inset Formula $n^{th}$
\end_inset

 order DEs
\end_layout

\begin_deeper
\begin_layout Itemize
Linear
\end_layout

\begin_layout Itemize
Nonlinear (linearization)
\end_layout

\end_deeper
\begin_layout Standard
Converting to state-space is simply a change of variables.
 An 
\begin_inset Formula $n^{th}$
\end_inset

 order ODE will generate 
\begin_inset Formula $n$
\end_inset

 
\begin_inset Formula $1^{st}$
\end_inset

 order ODEs when transformed into state-space.
 For each ODE, defien a new varialbe for each derivative of the orignal
 variable, up to the 
\begin_inset Formula $n-1$
\end_inset

 derivative.
 Substitute these varable inot the orginal EOM and solve for the 
\begin_inset Formula $1^{st}$
\end_inset

 order derivative.
\end_layout

\begin_layout Subsubsection
Example 1
\end_layout

\begin_layout Standard
\begin_inset Formula \[
\dddot{z}+3\ddot{z}+2\dot{z}+z=F\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
x_{1} & = & z\\
x_{2} & = & \dot{z}=\dot{x}_{1}\\
x_{3} & = & \ddot{z}=\dot{x}_{2}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{x}_{3}+3x_{3}+2x_{2}+x_{1} & = & F\\
\dot{x}_{3} & = & F-3x_{3}-2x_{2}-x_{1}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{x}_{1} & = & x_{2}\\
\dot{x}_{2} & = & x_{3}\\
\dot{x}_{3} & = & F-3x_{3}-2x_{2}-x_{1}\end{eqnarray*}

\end_inset


\begin_inset Formula \[
\begin{Bmatrix}\dot{x}_{1}\\
\dot{x}_{2}\\
\dot{x}_{3}\end{Bmatrix}=\begin{bmatrix}0 & 1 & 0\\
0 & 0 & 1\\
-1 & -2 & -3\end{bmatrix}\begin{Bmatrix}x_{1}\\
x_{2}\\
x_{3}\end{Bmatrix}+\begin{Bmatrix}0\\
0\\
1\end{Bmatrix}F\]

\end_inset


\end_layout

\begin_layout Subsubsection
Example 2
\end_layout

\begin_layout Standard
(missing cool picture)
\begin_inset Formula \begin{eqnarray*}
m_{i} & = & \text{mass}\\
k_{i} & = & \text{spring constant}\\
c_{i} & = & \text{damping constant}\\
u_{i} & = & \text{input forces}\\
z & = & \text{deflection of }m_{1}\\
y & = & \text{deflection of }m_{2}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
m_{1}\ddot{z}+\left(c_{1}+c_{2}\right)\dot{z}-c_{2}\dot{y}+\left(k_{1}+k_{2}\right)z-k_{2}y & = & u_{1}\\
m_{2}\ddot{y}+c_{2}\dot{y}-c_{2}\dot{z}+k_{2}y-k_{2}z & = & u_{2}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
x_{1} & = & z\\
x_{2} & = & \dot{z}\\
x_{3} & = & y\\
x_{4} & = & \dot{y}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
m_{1}\dot{x}_{2}+\left(c_{1}+c_{2}\right)x_{2}-c_{2}x_{4}+\left(k_{1}+k_{2}\right)x_{1}-k_{2}x_{3} & = & u_{1}\\
m_{2}\dot{x}_{4}+c_{2}x_{4}-c_{2}x_{2}+k_{2}x_{3}-k_{2}x_{1} & = & u_{2}\end{eqnarray*}

\end_inset


\begin_inset Formula \[
\begin{Bmatrix}\dot{x}_{1}\\
\dot{x}_{2}\\
\dot{x}_{3}\\
\dot{x}_{4}\end{Bmatrix}=\begin{bmatrix}0 & 1 & 0 & 0\\
\frac{-\left(k_{1}+k_{2}\right)}{m_{1}} & \frac{-\left(c_{1}+c_{2}\right)}{m_{1}} & \frac{k_{2}}{m_{1}} & \frac{c_{2}}{m_{1}}\\
0 & 0 & 0 & 1\\
\frac{k_{2}}{m_{2}} & \frac{c_{2}}{m_{2}} & \frac{-k_{2}}{m_{2}} & -\frac{c_{2}}{m_{2}}\end{bmatrix}\begin{Bmatrix}x_{1}\\
x_{2}\\
x_{3}\\
x_{4}\end{Bmatrix}+\begin{bmatrix}0 & 0\\
\frac{1}{m_{1}} & 0\\
0 & 0\\
0 & \frac{1}{m_{2}}\end{bmatrix}\begin{Bmatrix}u_{1}\\
u_{2}\end{Bmatrix}\]

\end_inset

If outputs were the positions:
\begin_inset Formula \[
\begin{Bmatrix}y_{1}\\
y_{2}\end{Bmatrix}=\begin{bmatrix}1 & 0 & 0 & 0\\
0 & 0 & 1 & 0\end{bmatrix}\begin{Bmatrix}x_{1}\\
x_{2}\\
x_{3}\\
x_{4}\end{Bmatrix}+\begin{bmatrix}0 & 0\\
0 & 0\end{bmatrix}\begin{Bmatrix}u_{1}\\
u_{2}\end{Bmatrix}\]

\end_inset


\end_layout

\begin_layout Section
9/29/2010
\end_layout

\begin_layout Itemize
Derivations of state-space equations from ODEs
\end_layout

\begin_deeper
\begin_layout Itemize
Finish state-space representation
\end_layout

\end_deeper
\begin_layout Itemize
Non-linear equations
\end_layout

\begin_deeper
\begin_layout Itemize
Linearization of non-linear systems
\end_layout

\end_deeper
\begin_layout Itemize
Transfer functions
\end_layout

\begin_deeper
\begin_layout Itemize
Converting transfer functions to state space representation
\end_layout

\begin_layout Itemize
Matrix transfer functions from state-space models
\end_layout

\end_deeper
\begin_layout Standard
In general our state-space formulation
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A(t)\bar{x}+B(t)\bar{u}\\
\bar{y} & = & C(t)\bar{x}+D(t)\bar{u}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
x(t) & \in & \mathbb{R}^{n}\text{ is the state}\\
y(t) & \in & \mathbb{R}^{p}\text{ is the output}\\
u(t) & \in & \mathbb{R}^{m}\text{ is the input or control}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
The matrices
\begin_inset Formula \begin{eqnarray*}
A(t) & \in & \mathbb{R}^{n\times n}\text{ dynamics matrix}\\
B(t) & \in & \mathbb{R}^{n\times m}\text{ input matrix}\\
C(t) & \in & \mathbb{R}^{p\times n}\text{ output/sensor matrix}\\
D(t) & \in & \mathbb{R}^{p\times m}\text{ feedthrough matrix}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
For LTI systems 
\begin_inset Formula $A$
\end_inset

, 
\begin_inset Formula $B$
\end_inset

, 
\begin_inset Formula $C$
\end_inset

, and 
\begin_inset Formula $D$
\end_inset

 are constant.
\end_layout

\begin_layout Subsection
Nonlinear systems
\end_layout

\begin_layout Standard
Nonlinear system:
\begin_inset Formula \begin{eqnarray}
\dot{\bar{x}} & = & \bar{f}\left(\bar{x},\bar{u},t\right)\label{eq:nl1}\\
\bar{y} & = & \bar{h}\left(\bar{x},\bar{u},t\right)\label{eq:nl2}\end{eqnarray}

\end_inset


\begin_inset Formula $\bar{f}$
\end_inset

 and 
\begin_inset Formula $\bar{h}$
\end_inset

 are vector valued, suitably smooth functions.
\end_layout

\begin_layout Standard
Defie a solution/trajectory 
\begin_inset Formula $\left(\tilde{\bar{x}}(t),\tilde{\bar{u}}(t)\right)$
\end_inset

 that satisfies 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:nl1"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:nl2"

\end_inset


\begin_inset Formula \[
\dot{\tilde{\bar{x}}}=\bar{f}\left(\tilde{\bar{x}},\tilde{\bar{u}},t\right)\]

\end_inset


\end_layout

\begin_layout Standard
Given this solution, expand 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:nl1"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:nl2"

\end_inset

 about it in a multivariable taylor series.
\begin_inset Formula \begin{equation}
\dot{\bar{x}}=\bar{f}\left(\tilde{\bar{x}},\tilde{\bar{u}},t\right)+\left(\frac{\delta\bar{f}}{\delta\bar{x}}\right)^{*}\left(\bar{x}-\tilde{\bar{x}}\right)+\left(\frac{\delta\bar{f}}{\delta\bar{u}}\right)^{*}\left(\bar{u}-\tilde{\bar{u}}\right)+\text{higher order terms}\label{eq:nl3}\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $\left(\right)^{*}$
\end_inset

 denotes evaluation along the solution.
\begin_inset Formula \[
\dot{\bar{x}}-\dot{\tilde{\bar{x}}}=\left(\frac{\delta\bar{f}}{\delta\bar{x}}\right)^{*}\left(\bar{x}-\tilde{\bar{x}}\right)+\left(\frac{\delta\bar{f}}{\delta\bar{u}}\right)^{*}\left(\bar{u}-\tilde{\bar{u}}\right)+h.o.t.\]

\end_inset

Linearization assuems that 
\begin_inset Formula $\begin{Vmatrix}\left(\bar{x}-\tilde{\bar{x}}\right)\end{Vmatrix}$
\end_inset

 and 
\begin_inset Formula $\begin{Vmatrix}\left(\bar{u}-\tilde{\bar{u}}\right)\end{Vmatrix}$
\end_inset

 are small so that we can neglect 
\begin_inset Formula $h.o.t.$
\end_inset

 in the expansion.
\end_layout

\begin_layout Paragraph
Define
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\Delta\bar{x} & = & \bar{x}-\tilde{\bar{x}}\\
\Delta\bar{u} & = & \bar{u}-\tilde{\bar{u}}\\
\left(\frac{\delta\bar{f}}{\delta\bar{x}}\right)^{*} & = & A(t)\\
\left(\frac{\delta\bar{f}}{\delta\bar{u}}\right)^{*} & = & B(t)\end{eqnarray*}

\end_inset

The linearized state equations:
\begin_inset Formula \[
\frac{d}{dt}\Delta\bar{x}=A(t)\Delta\bar{x}+B(t)\Delta\bar{u}\]

\end_inset


\end_layout

\begin_layout Standard
As long as the diviations from the trajectory 
\begin_inset Formula $\Delta\bar{x}$
\end_inset

 and 
\begin_inset Formula $\Delta\bar{u}$
\end_inset

 remain 
\begin_inset Quotes eld
\end_inset

small
\begin_inset Quotes erd
\end_inset

 then the linearization is a good approximation of the non-linear dynamics.
\end_layout

\begin_layout Subsubsection
Linearized output equation
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\bar{y} & = & \bar{h}\left(\tilde{\bar{x}},\tilde{\bar{u}},t\right)+\left(\frac{\delta\bar{h}}{\delta\bar{x}}\right)^{*}\left(\bar{x}-\tilde{\bar{x}}\right)+\left(\frac{\delta\bar{h}}{\delta\bar{u}}\right)^{*}\left(\bar{u}-\tilde{\bar{u}}\right)\\
\bar{y}-\tilde{\bar{y}} & = & \left(\frac{\delta\bar{h}}{\delta\bar{x}}\right)^{*}\left(\bar{x}-\tilde{\bar{x}}\right)+\left(\frac{\delta\bar{h}}{\delta\bar{u}}\right)^{*}\left(\bar{u}-\tilde{\bar{u}}\right)+h.o.t.\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\Delta\bar{y} & = & \bar{y}-\tilde{\bar{y}}\\
\Delta\bar{u} & = & \bar{u}-\tilde{\bar{u}}\\
\left(\frac{\delta\bar{h}}{\delta\bar{x}}\right)^{*} & = & C(t)\\
\left(\frac{\delta\bar{h}}{\delta\bar{u}}\right)^{*} & = & D(t)\end{eqnarray*}

\end_inset


\begin_inset Formula \[
\Delta\bar{y}=C(t)\Delta\bar{x}+D(t)\Delta\bar{u}\]

\end_inset


\end_layout

\begin_layout Standard
If we assume 
\begin_inset Formula $\tilde{\bar{x}}(t),\tilde{\bar{u}}(t)=\bar{0}$
\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A(t)\bar{x}+B(t)\bar{u}\\
\bar{y} & = & C(t)\bar{x}+D(t)\bar{u}\end{eqnarray*}

\end_inset

If (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:nl1"

\end_inset

) and (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:nl2"

\end_inset

) are time invariant 
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}+B\bar{u}\\
\bar{y} & = & C\bar{x}+D\bar{u}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsubsection
Example
\end_layout

\begin_layout Standard
System with a non-linear spring.
\end_layout

\begin_layout Itemize
Linear spring: 
\begin_inset Formula $m\ddot{x}=-kx$
\end_inset


\end_layout

\begin_layout Itemize
Non-linear spring: 
\begin_inset Formula $m\ddot{x}=-k_{1}x-k_{2}x^{3}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
x_{1} & = & x\text{ (assume }m=1\text{)}\\
x_{2} & = & \dot{x}\\
\\\dot{x}_{1} & = & x_{2}=f_{1}\left(x_{1},x_{2}\right)\\
\dot{x}_{2} & = & -k_{1}x_{1}-k_{2}x_{1}^{3}=f_{2}\left(x_{1},x_{2}\right)\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Equilibrium points:
\begin_inset Formula \begin{eqnarray*}
\dot{x}_{1}=0 & = & x_{2}\\
\dot{x}_{2}=0 & = & x_{1}\underbrace{\left(-k_{1}-k_{2}x_{1}^{2}\right)}_{x_{1}=\sqrt{\frac{-k_{1}}{k_{2}}}}\\
\left(x_{1},x_{2}\right) & = & \left(0,0\right)\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Linearize about 
\begin_inset Formula $\left(x_{1},x_{2}\right)=\left(0,0\right)$
\end_inset


\begin_inset Formula \begin{eqnarray*}
\begin{bmatrix}\dot{x}_{1}\\
\dot{x}_{2}\end{bmatrix} & = & \left.\underbrace{\begin{bmatrix}\frac{\delta f_{1}}{\delta x_{1}} & \frac{\delta f_{1}}{\delta x_{2}}\\
\frac{\delta f_{2}}{\delta x_{1}} & \frac{\delta f_{2}}{\delta x_{2}}\end{bmatrix}}_{\hat{=}\text{ Jacobian}}\right|_{\left(x_{1},x_{2}\right)=\left(0,0\right)}\begin{Bmatrix}x_{1}-0\\
x_{2}-0\end{Bmatrix}\\
\\ & = & \left.\begin{bmatrix}0 & 1\\
-k_{1}-3k_{2}x_{1}^{3} & 0\end{bmatrix}\right|_{\left(0,0\right)}\begin{Bmatrix}x_{1}-0\\
x_{2}-0\end{Bmatrix}\\
 & = & \begin{bmatrix}0 & 1\\
-k_{1} & 0\end{bmatrix}\begin{Bmatrix}x_{1}\\
x_{2}\end{Bmatrix}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsection
Transfer functions to state-space models
\end_layout

\begin_layout Standard

\series bold
Goal:
\series default
 Develop a state-space model from a transfer function 
\begin_inset Formula $G(s)$
\end_inset


\end_layout

\begin_layout Standard
3 Primary cases:
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\frac{y}{u}=G(s)=\frac{\text{constant}}{\text{polynomial in }s}$
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
e.g.
 
\begin_inset Formula $\frac{1}{s^{2}+2s+1}$
\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
Numerator order less than denominator order in 
\begin_inset Formula $s$
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
e.g.
 
\begin_inset Formula $\frac{y}{u}=G(s)=\frac{as+b}{s^{2}+cs+d}=\frac{N(s)}{D(s)}$
\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
Numerator order greater than or equal to denominator order.
\end_layout

\begin_layout Subsubsection
Case 1
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray}
\frac{y}{u} & = & \frac{1}{s^{n}+a_{n-1}s^{n-1}+\dots+a_{0}}\nonumber \\
\nonumber \\y\left(s^{n}+a_{n-1}s^{n-1}+\dots+a_{0}\right) & = & u\label{eq:tfss1}\end{eqnarray}

\end_inset

For zero initial conditions: 
\begin_inset Formula $\mathcal{L}\left(\frac{d^{n}y}{dt^{n}}\right)=s^{n}y$
\end_inset

 (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:tfss1"

\end_inset

) becomes 
\begin_inset Formula $\frac{d^{n}y}{dt^{n}}+a_{n-1}\frac{d^{n-1}y}{dt^{n-1}}+\dots+a_{1}\frac{dy}{dt}+a_{0}=u$
\end_inset

.
\end_layout

\begin_layout Standard
If we define our state vectors as
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \begin{bmatrix}0 & 1 & 0 & \dots & 0\\
0 & 0 & 1 & \dots & 0\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
-a_{0} & -a_{1} & -a_{2} & \dots & -a_{n-1}\end{bmatrix}\bar{x}+\begin{Bmatrix}0\\
0\\
\vdots\\
1\end{Bmatrix}\bar{u}\\
\bar{y} & = & \begin{bmatrix}1 & 0 & 0 & \dots & 0\end{bmatrix}\bar{x}+0u\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsubsection
Case 2
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\frac{y}{u} & = & \frac{b_{n-1}s^{n-1}+b_{n-2}s^{n-2}+\dots+b_{0}}{s^{n}+a_{n-1}s^{n-1}+\dots+a_{0}}=\frac{N(s)}{D(s)}\end{eqnarray*}

\end_inset

If we let 
\begin_inset Formula $\frac{y}{u}=\frac{y}{v}\,\frac{v}{u}=\underbrace{N(s)}_{\frac{y}{v}}\underbrace{\frac{1}{D(s)}}_{\frac{v}{u}}$
\end_inset


\begin_inset Formula \[
\frac{v}{u}=\frac{1}{D(s)}\ \rightarrow\text{ of the form considered in case 1}\]

\end_inset

with state vector:
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \begin{bmatrix}0 & 1 & 0 & \dots & 0\\
0 & 0 & 1 & \dots & 0\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
-a_{0} & -a_{1} & -a_{2} & \dots & -a_{n-1}\end{bmatrix}\bar{x}+\begin{Bmatrix}0\\
0\\
\vdots\\
1\end{Bmatrix}\bar{u}\\
\bar{y} & = & \begin{bmatrix}b_{0} & b_{1} & \dots & b_{n-1}\end{bmatrix}\bar{x}+0u\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsubsection
Case 3
\end_layout

\begin_layout Standard
\begin_inset Formula \[
G(s)=\frac{y}{u}=\frac{b_{n}s^{n}+b_{n-1}s^{n-1}+\dots+b_{0}}{s^{n}+a_{n-1}s^{n-1}+\dots+a_{0}}=\underbrace{\frac{c_{n-1}s^{n-1}+c_{n-2}s^{n-2}+\dots+c_{0}}{s^{n}+a_{n-1}s^{n-1}+\dots+a_{0}}}_{G_{1}(s)}+D\]

\end_inset


\end_layout

\begin_layout Standard
To find 
\begin_inset Formula $c_{i}$
\end_inset

 and 
\begin_inset Formula $D$
\end_inset

 equate the two expressions
\begin_inset Formula \[
c_{n-1}s^{n-1}+c_{n-2}s^{n-2}+\dots+c_{0}+D\left(s^{n}+a_{n-1}s^{n-1}+\dots+a_{0}\right)=b_{n}s^{n}+b_{n-1}s^{n-1}+\dots+b_{0}\]

\end_inset


\end_layout

\begin_layout Standard
Equating orders of s
\begin_inset Formula \begin{eqnarray*}
s^{n}: &  & D=b_{n}\\
s^{n-1}: &  & c_{n-1}+Da_{n-1}=b_{n-1}\\
 & \vdots\end{eqnarray*}

\end_inset

and the process continues for remaining 
\begin_inset Formula $c_{i}$
\end_inset

.
 Once we have solved for all of our 
\begin_inset Formula $c$
\end_inset

 values, then we have 
\begin_inset Formula $G_{1}(s)$
\end_inset

 defined.
\end_layout

\begin_layout Itemize
\begin_inset Formula $G_{1}(s)$
\end_inset

 is just a transferfunction fo the form considered in case 2 (can develop
 a state space model from that).
\end_layout

\begin_layout Itemize
Simply add the feed through term 
\begin_inset Formula $Du$
\end_inset

 to the output of the model develpped from 
\begin_inset Formula $G_{1}(s)$
\end_inset


\end_layout

\begin_layout Subsubsection
Example: case 2
\end_layout

\begin_layout Standard
Find state-space represenatation of
\begin_inset Formula \[
G(s)=\frac{2s+1}{s^{3}+2s^{2}+3s+4}\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
A & = & \begin{bmatrix}0 & 1 & 0\\
0 & 0 & 1\\
-4 & -3 & -2\end{bmatrix}\\
B & = & \begin{bmatrix}0\\
0\\
1\end{bmatrix}\\
C & = & \begin{bmatrix}1 & 2 & 0\end{bmatrix}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \begin{bmatrix}0 & 1 & 0\\
0 & 0 & 1\\
-4 & -3 & -2\end{bmatrix}\bar{x}+\begin{bmatrix}0\\
0\\
1\end{bmatrix}u\\
y & = & \begin{bmatrix}1 & 2 & 0\end{bmatrix}\bar{x}+0u\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsubsection
Example: case 3
\end_layout

\begin_layout Standard
\begin_inset Formula \[
G(s)=\frac{4s^{3}+3s^{2}+2s+1}{s^{3}+2s^{2}+3s+4}\]

\end_inset


\begin_inset Formula \[
G(s)=G_{1}(s)+D\]

\end_inset


\begin_inset Formula \[
D\left(s^{3}+2s^{2}+3s+4\right)+c_{2}s^{2}+c_{1}s+c_{0}=4s^{3}+3s^{2}+2s+1\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
s^{3}: &  & D=4\\
s^{2}: &  & 2D+c_{2}=3\\
s^{1}: &  & 3D+c_{1}=2\\
s^{0}: &  & 4D+c_{0}=1\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
c_{2} & = & 3-2D=-5\\
c_{1} & = & 2-3D=-10\\
c_{0} & = & 1-4D=-15\end{eqnarray*}

\end_inset


\begin_inset Formula \[
G(s)=\underbrace{\frac{-5s^{2}-10s-15}{s^{3}+2s^{2}+3s+4}}_{G_{1}(s)\rightarrow\text{case 2}}+4\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
A & = & \begin{bmatrix}0 & 1 & 0\\
0 & 0 & 1\\
-4 & -3 & -2\end{bmatrix}\\
B & = & \begin{bmatrix}0\\
0\\
1\end{bmatrix}\\
C & = & \begin{bmatrix}-15 & -10 & -5\end{bmatrix}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \begin{bmatrix}0 & 1 & 0\\
0 & 0 & 1\\
-4 & -3 & -2\end{bmatrix}\bar{x}+\begin{bmatrix}0\\
0\\
1\end{bmatrix}u\\
y & = & \begin{bmatrix}-15 & -10 & -5\end{bmatrix}\bar{x}+4u\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Section
10/4/2010
\end_layout

\begin_layout Itemize
Transfer functions from state-space models
\end_layout

\begin_layout Itemize
State-space transforms
\end_layout

\begin_layout Itemize
Time reponse of LTI systems
\end_layout

\begin_deeper
\begin_layout Itemize
Zero input
\end_layout

\begin_layout Itemize
Modal analyis
\end_layout

\begin_layout Itemize
Zero state
\end_layout

\end_deeper
\begin_layout Subsection
Transfer functions from state-space models
\end_layout

\begin_layout Standard

\series bold
Given:
\begin_inset Formula \begin{eqnarray*}
\text{LTI system:}\\
\dot{\bar{x}} & = & Ax+Bu\\
\bar{y} & = & Cx+Du\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard

\series bold
Find:
\series default

\begin_inset Formula \begin{eqnarray*}
G(s) & = & \frac{Y(s)}{u(s)}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard

\series bold
Take the laplace:
\series default

\begin_inset Formula \begin{eqnarray*}
s\bar{X}(s)-\bar{x_{0}} & = & A\bar{X}(s)+BU(s)\\
\bar{Y(s)} & = & C\bar{X}(s)+DU(s)\\
\\\left(sI-A\right)\bar{X}(s) & = & \bar{x_{0}}+BU(s)\\
\bar{X}(s) & = & \left(sI-A\right)^{-1}\left(\bar{x_{0}}+BU(s)\right)\\
\\\text{Substitute into output eq:}\\
\bar{Y(s)} & = & C\left(sI-A\right)^{-1}\bar{x_{0}}+\left[C\left(sI-A\right)^{-1}B+D\right]U(s)\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
For a TF, by def.
 we have zero initial conditions 
\begin_inset Formula $\rightarrow\bar{x_{0}}=0$
\end_inset


\begin_inset Formula \[
Y(s)=\left[C\left(sI-A\right)^{-1}B+D\right]U(s)\]

\end_inset


\end_layout

\begin_layout Standard
Our matrix 
\begin_inset Formula $\left[C\left(sI-A\right)^{-1}B+D\right]$
\end_inset

 maps the vector 
\begin_inset Formula $U(s)$
\end_inset

 of input signals to the vector 
\begin_inset Formula $\bar{Y(s)}$
\end_inset

 of output signals 
\begin_inset Formula $\rightarrow$
\end_inset

transfer function matrix.
\end_layout

\begin_layout Subsubsection
Computing G(s):
\end_layout

\begin_layout Standard
\begin_inset Formula \[
G(s)=C\left(sI-A\right)^{-1}B+D\]

\end_inset


\end_layout

\begin_layout Standard

\series bold
For a SISO system:
\series default

\begin_inset Formula \[
G(s)=\frac{det\left[\begin{array}{cc}
sI-A & -B\\
C & D\end{array}\right]}{det\left[sI-A\right]}\]

\end_inset


\end_layout

\begin_layout Standard

\series bold
For MIMO systems:
\series default

\begin_inset Formula \[
G_{i,j}(s)=\frac{\left|sI-A+b_{j}c_{i}\right|+\left(d_{i,j}-1\right)\left|sI-A\right|}{\left|sI-A\right|}\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
b_{j} & = & \text{column of B}\\
c_{i} & = & \text{row of C}\\
d_{i,j} & = & \text{corresponding entry in D}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsubsection
Example:
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \left[\begin{array}{cc}
1 & 2\\
3 & 4\end{array}\right]\bar{x}+\left[\begin{array}{cc}
2 & 0\\
0 & 1\end{array}\right]\bar{u}\\
\bar{y} & = & \left[\begin{array}{cc}
3 & 0\\
0 & 4\end{array}\right]\bar{x}+\left[\begin{array}{cc}
1 & 0\\
0 & 2\end{array}\right]\bar{u}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Paragraph

\series bold
Find G(s)
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
G(s) & = & C\left(sI-A\right)^{-1}B+D\\
 & = & \left[\begin{array}{cc}
3 & 0\\
0 & 4\end{array}\right]\left[\begin{array}{cc}
s-1 & -2\\
-3 & s-4\end{array}\right]^{-1}\left[\begin{array}{cc}
2 & 0\\
0 & 1\end{array}\right]+\left[\begin{array}{cc}
1 & 0\\
0 & 2\end{array}\right]\\
 & = & \left[\begin{array}{cc}
3 & 0\\
0 & 4\end{array}\right]\frac{1}{det\left[\begin{array}{cc}
s-1 & -2\\
-3 & s-4\end{array}\right]}\left[\begin{array}{cc}
s-4 & 2\\
3 & s-1\end{array}\right]\left[\begin{array}{cc}
2 & 0\\
0 & 1\end{array}\right]+\left[\begin{array}{cc}
1 & 0\\
0 & 2\end{array}\right]\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
det\left[\begin{array}{cc}
s-1 & -2\\
-3 & s-4\end{array}\right] & = & (s-1)(s-4)-6\\
 & = & s^{2}-5s-2\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
G(s) & = & \frac{1}{s^{2}-5s-2}\left[\begin{array}{cc}
3 & 0\\
0 & 4\end{array}\right]\left[\begin{array}{cc}
2s-8 & 2\\
6 & s-1\end{array}\right]+\left[\begin{array}{cc}
1 & 0\\
0 & 2\end{array}\right]\\
 & = & \frac{1}{s^{2}-5s-2}\left[\begin{array}{cc}
6s-24 & 6\\
24 & 4s-4\end{array}\right]+\frac{s^{2}-5s-2}{s^{2}-5s-2}\left[\begin{array}{cc}
1 & 0\\
0 & 2\end{array}\right]\\
\\\left[\begin{array}{c}
Y_{1}(s)\\
Y_{0}(s)\end{array}\right] & = & \frac{1}{s^{2}-5s-2}\left[\begin{array}{cc}
s^{2}+s-24 & 6\\
24 & 2s^{2}-6s-8\end{array}\right]\left[\begin{array}{c}
U_{1}(s)\\
U_{0}(s)\end{array}\right]\end{eqnarray*}

\end_inset

 
\begin_inset Formula \begin{eqnarray*}
G_{1,1}(s) & = & \frac{\left|\left[\begin{array}{cc}
s-1 & -2\\
-3 & s-4\end{array}\right]+\left[\begin{array}{c}
2\\
0\end{array}\right]\left[\begin{array}{cc}
3 & 0\end{array}\right]\right|+(1-1)\left|sI-A\right|}{s^{2}-5s-2}\\
\\ & = & \frac{\left|\begin{array}{cc}
s+5 & -2\\
-3 & s-4\end{array}\right|}{s^{2}-5s-2}\\
\\G_{1,1}(s) & = & \frac{s^{2}+s-26}{s^{2}-5s-2}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsection
State-space transformations:
\end_layout

\begin_layout Itemize
State-space representations are not unique since we have choice in our represent
ation of the state vector.
\end_layout

\begin_layout Itemize
Give a model, we can transform it to another equivilent representation (in
 terms of the input-output relationship).
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}+B\bar{u}\\
\bar{y} & = & C\bar{x}+D\bar{u}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Paragraph

\series bold
Introduce a transformation:
\end_layout

\begin_layout Standard
\begin_inset Formula $\bar{x}=T\bar{z}$
\end_inset

 where
\begin_inset Formula $\bar{z}$
\end_inset

 is a new state vector.
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
T\dot{\bar{z}} & = & AT\bar{z}+B\bar{u}\,\rightarrow\,\dot{\bar{z}}=T^{-1}AT\bar{z}+T^{-1}B\bar{u}\\
\bar{y} & = & CT\bar{z}+D\bar{u}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Paragraph

\series bold
Rewrite
\series default
:
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{z}} & = & \hat{A}\bar{z}+\hat{B}\bar{u}\\
\bar{y} & = & \hat{C}\bar{z}+\hat{D}\bar{u}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\hat{A} & = & T^{-1}AT\\
\hat{B} & = & T^{-1}BT\\
\hat{C} & = & CT\\
\hat{D} & = & D\end{eqnarray*}

\end_inset

 If this is an equivalent model:
\begin_inset Formula \begin{eqnarray*}
G_{1}(s)=C(sI-A)^{-1}B+D & = & \hat{C}(sI-\hat{A})^{-1}\hat{B}+\hat{D}\\
 & = & G_{2}(s)\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
G_{1}(s) & = & C(sI-A)^{-1}B+D\\
 & = & C\left(TT^{-1}\right)\left(sI-A\right)^{-1}\left(TT^{-1}\right)B+D\\
 & = & CT\left[T^{-1}\left(sI-A\right)^{-1}T\right]\left(T^{-1}B\right)+D\\
 & = & \hat{C}\left[T^{-1}\left(sI-A\right)^{-1}T\right]\hat{B}+\hat{D}\\
\text{Use fact:}\\
\left[\begin{array}{ccc}
m & n & o\end{array}\right]^{-1} & = & \left[\begin{array}{ccc}
o^{-1} & n^{-1} & m^{-1}\end{array}\right]\\
\\ & = & \hat{C}\left[T^{-1}\left(sI-A\right)T\right]^{-1}\hat{B}+\hat{D}\\
 & = & \hat{C}[(sI-A)]^{-1}\hat{B}+\hat{D}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
Enen though state space representations are not uniquie, the transfer function
 matrix is.
\end_layout

\begin_layout Subsection
Time response of LTI systems
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}+B\bar{u}\\
\bar{y} & = & C\bar{x}+D\bar{u}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
The time response is going to be the sum of two responses: zero input &
 zero state response.
\end_layout

\begin_layout Subsubsection
Zero input response (transient/homogeneous response)
\end_layout

\begin_layout Standard
\begin_inset Formula \[
\dot{\bar{x}}=A\bar{x},\ \bar{x}(0)=\text{known}\]

\end_inset


\end_layout

\begin_layout Standard
Take the Laplace transform:
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
s\bar{X}(s)-\bar{x}(0) & = & A\bar{X}(s)\\
\bar{X}(s) & = & (sI-A)^{-1}\bar{x}(0)\\
\\\text{It can be shown that:}\\
(sI-A)^{-1} & = & \frac{I}{s}+\frac{A}{s^{2}}+\frac{A^{2}}{s^{3}}+\dots\\
\\\text{Such that:}\\
\mathcal{L}^{-1}\left\{ (sI-A)^{-1}\right\}  & = & I+At+\frac{A^{2}t^{2}}{2!}+\frac{A^{3}t^{3}}{3!}+\dots\\
\\e^{at} & = & f(0)+\frac{f'(0)}{1!}(t-0)+\frac{f''(0)}{2!}(t-0)^{2}+\dots\\
 & = & 1+at+\frac{a^{2}t^{2}}{2!}+\dots\\
\\ & = & e^{At}\hat{=}\text{matrix exponetial, state transition matrix }\Phi\text{ for LTI systems}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \[
\bar{x}(t)=e^{At}\bar{x}(0)\]

\end_inset


\end_layout

\begin_layout Subsubsection
Properties of 
\begin_inset Formula $e^{At}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
e^{A0} & = & I\\
e^{A\left(t_{1}+t_{2}\right)} & = & e^{At_{1}}e^{At_{2}}\\
\left(e^{At}\right)^{-1} & = & e^{-At}\\
e^{A^{T}t} & = & \left(e^{At}\right)^{T}\\
Ae^{At} & = & e^{At}A\\
\frac{d}{dt}e^{At} & = & Ae^{At}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsection
Review: Eigenvalues & Eigenvectors
\end_layout

\begin_layout Standard

\series bold
Def:
\series default
 
\begin_inset Formula $\lambda$
\end_inset

 is an eigenvalue of the matrix A if:
\begin_inset Formula \begin{equation}
det\left[\lambda I-A\right]=0\label{eq:def_lam}\end{equation}

\end_inset

 Which is true iff there exists a non-zero 
\begin_inset Formula $\bar{v}$
\end_inset

 (eigenvector) for which 
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
A\bar{v}=\lambda\bar{v}\text{ or }\left[\lambda I-A\right]\bar{v}=0\label{eq:def_lam2}\end{equation}

\end_inset


\series bold
To compute:
\end_layout

\begin_layout Itemize
Compute 
\begin_inset Formula $det\left[\lambda I-A\right]=0$
\end_inset

.
\end_layout

\begin_layout Itemize
Find roots (i.e.
 values of 
\begin_inset Formula $\lambda$
\end_inset

) that satisfy the resulting equation.
\end_layout

\begin_layout Itemize
Fore each 
\begin_inset Formula $\lambda$
\end_inset

, solve for 
\begin_inset Formula $\bar{v}$
\end_inset

 from 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:def_lam2"

\end_inset

.
\end_layout

\begin_layout Itemize
Once all 
\begin_inset Formula $\lambda_{i}$
\end_inset

, 
\begin_inset Formula $\bar{v}_{i}$
\end_inset

 have been determined (assuming all 
\begin_inset Formula $\lambda_{i}$
\end_inset

 are independent) then we can write:
\begin_inset Formula \begin{eqnarray*}
A\bar{v}_{i} & = & \lambda_{i}\bar{v}_{i}\ i=1\dots n\\
\\A\left[\bar{v}_{1}\dots\bar{v}_{n}\right] & = & \left[\bar{v}_{1}\dots\bar{v}_{n}\right]\left[\begin{array}{ccc}
\lambda_{1} & \dots & 0\\
\vdots & \ddots & \vdots\\
0 & \dots & \lambda_{n}\end{array}\right]\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Paragraph

\series bold
Define:
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
T & = & \left[\bar{v}_{1}\dots\bar{v}_{n}\right]\\
\Lambda & = & \left[\begin{array}{ccc}
\lambda_{1} & \dots & 0\\
\vdots & \ddots & \vdots\\
0 & \dots & \lambda_{n}\end{array}\right]\\
\\AT & = & T\Lambda\\
T^{-1}AT & = & \Lambda\end{eqnarray*}

\end_inset

For our system 
\begin_inset Formula $\dot{\bar{x}}=A\bar{x}$
\end_inset

, if we make the transformation:
\begin_inset Formula \[
\bar{x}=T\bar{z}\text{ with }T=\left[\bar{v}_{1}\dots\bar{v}_{n}\right]\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \[
\dot{\bar{z}}=T^{-1}AT\bar{z}=\Lambda\bar{z}\]

\end_inset


\end_layout

\begin_layout Standard
And our system is diagonalized.
 
\end_layout

\begin_layout Standard
Otherwise if 
\begin_inset Formula $\lambda_{i}$
\end_inset

 are not independent, calculate generalized eigenvectors from 
\begin_inset Formula $\left[A-\lambda I\right]\bar{v}_{k}=\bar{v}_{k-1}$
\end_inset

 for 
\begin_inset Formula $k=1\dots n$
\end_inset

, 
\begin_inset Formula $\bar{v}_{0}=\bar{0}$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Example
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \left[\begin{array}{cc}
-1 & 1\\
-8 & 5\end{array}\right]\bar{x}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Diagonalize the system.
\end_layout

\begin_layout Standard
Find eigenvalues and eigenvectors
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\det\begin{bmatrix}\lambda+1 & -1\\
8 & \lambda-5\end{bmatrix}=0 & = & \left(\lambda+1\right)\left(\lambda-5\right)+8\\
0 & = & \lambda^{2}-4\lambda-5+8\\
 & = & \lambda^{2}-4\lambda+3\\
 & = & \left(\lambda-1\right)\left(\lambda-3\right)\end{eqnarray*}

\end_inset

Eigenvalues: 
\begin_inset Formula $\lambda_{1}=1$
\end_inset

, 
\begin_inset Formula $\lambda_{2}=3$
\end_inset


\end_layout

\begin_layout Standard
Computing eigenvectors:
\begin_inset Formula \begin{eqnarray*}
\lambda_{1} & = & 1\\
\begin{bmatrix}\lambda_{1}+1 & -1\\
8 & \lambda_{1}-5\end{bmatrix}\begin{bmatrix}v_{11}\\
v_{21}\end{bmatrix} & = & \begin{bmatrix}0\\
0\end{bmatrix}\\
\begin{bmatrix}2 & -1\\
8 & -4\end{bmatrix}\begin{bmatrix}v_{11}\\
v_{21}\end{bmatrix} & = & \begin{bmatrix}0\\
0\end{bmatrix}\\
\\\bar{v}_{1} & = & \begin{bmatrix}1\\
2\end{bmatrix}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\lambda_{2} & = & 3\\
\begin{bmatrix}\lambda_{2}+1 & -1\\
8 & \lambda_{2}-5\end{bmatrix}\begin{bmatrix}v_{12}\\
v_{22}\end{bmatrix} & = & \begin{bmatrix}0\\
0\end{bmatrix}\\
\begin{bmatrix}4 & -1\\
8 & -2\end{bmatrix}\begin{bmatrix}v_{12}\\
v_{22}\end{bmatrix} & = & \begin{bmatrix}0\\
0\end{bmatrix}\\
\\\bar{v}_{2} & = & \begin{bmatrix}1\\
4\end{bmatrix}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
T & = & \begin{bmatrix}\bar{v}_{1} & \bar{v}_{2}\end{bmatrix}\\
T & = & \begin{bmatrix}1 & 1\\
2 & 4\end{bmatrix}\end{eqnarray*}

\end_inset


\begin_inset Formula \[
\text{if }\bar{x}=T\bar{z}\ \rightarrow\ \dot{\bar{z}}=T^{-1}AT\bar{z}=\begin{bmatrix}1 & 0\\
0 & 3\end{bmatrix}\bar{z}\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
10/6/2010
\end_layout

\begin_layout Itemize
Modal analysis
\end_layout

\begin_layout Itemize
Zero state response
\end_layout

\begin_layout Itemize
Motivating controllability and observability
\end_layout

\begin_layout Itemize
Controllability
\end_layout

\begin_deeper
\begin_layout Itemize
Definition
\end_layout

\begin_layout Itemize
Proofs and constructs
\end_layout

\end_deeper
\begin_layout Subsection
Modal Analysis
\end_layout

\begin_layout Paragraph

\series bold
Goal:
\end_layout

\begin_layout Standard
Get an expression for 
\begin_inset Formula $x(t)$
\end_inset

 in terms of our eigenvalues and eigenvectors.
 Zero-input solution examines
\begin_inset Formula \[
\dot{\bar{x}}=A\bar{x}\]

\end_inset


\end_layout

\begin_layout Standard
If 
\begin_inset Formula $A$
\end_inset

 is diagonalizable, the transformation matrix 
\begin_inset Formula $T=\left[\begin{array}{ccc}
\bar{v}_{1} & \dots & \bar{v}_{n}\end{array}\right]$
\end_inset

 yields 
\begin_inset Formula \[
T^{-1}AT=\Lambda=\left[\begin{array}{ccc}
\lambda_{1} & 0 & 0\\
0 & \ddots & 0\\
0 & 0 & \lambda_{n}\end{array}\right]\]

\end_inset


\begin_inset Formula \[
\rightarrow\ A=T\Lambda T^{-1}\]

\end_inset


\end_layout

\begin_layout Standard
Zero-input solution
\begin_inset Formula \begin{eqnarray*}
\bar{x}(t) & = & e^{At}\bar{x}(0)\\
\\e^{At} & = & I+At+\frac{A^{2}}{2!}t^{2}+\dots\\
 & = & I+T\Lambda T^{-1}t+\frac{\left(T\Lambda T^{-1}\right)\left(T\Lambda T^{-1}\right)t^{2}}{2!}+\dots\\
 & = & I+T\Lambda T^{-1}t+\frac{T\Lambda^{2}T^{-1}}{2!}t^{2}+\dots\\
\\e^{At} & = & Te^{\Lambda t}T^{-1}\\
\\e^{\Lambda t} & = & \left[\begin{array}{ccc}
e^{\lambda_{1}t} & 0 & 0\\
0 & \ddots & 0\\
0 & 0 & e^{\lambda_{n}t}\end{array}\right]\\
\\e^{At} & = & \left[\begin{array}{ccc}
\bar{v}_{1} & \dots & \bar{v}_{n}\end{array}\right]\left[\begin{array}{ccc}
e^{\lambda_{1}t} & 0 & 0\\
0 & \ddots & 0\\
0 & 0 & e^{\lambda_{n}t}\end{array}\right]\left[\begin{array}{c}
w_{1}^{T}\\
\vdots\\
w_{N}^{T}\end{array}\right]\\
\\T^{-1} & \hat{=} & \left[\begin{array}{c}
w_{1}^{T}\\
\vdots\\
w_{N}^{T}\end{array}\right]\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard

\series bold
Note:
\series default
 From 
\begin_inset Formula $T^{-1}T=I$
\end_inset

 
\begin_inset Formula $\rightarrow$
\end_inset

 
\begin_inset Formula $w_{i}^{T}v_{j}=\delta_{i,j}=\begin{cases}
1 & if\ i=j\\
0 & if\ i\neq j\end{cases}$
\end_inset


\end_layout

\begin_layout Standard
Multiply out expression for 
\begin_inset Formula $e^{At}$
\end_inset

:
\begin_inset Formula \begin{eqnarray*}
e^{At} & = & \sum_{i=1}^{N}e^{\lambda_{i}t}\bar{v}_{i}\bar{w}_{i}^{T}\\
\\\bar{x}(t) & = & e^{At}\bar{x}(0)=Te^{\Lambda t}T^{-1}\bar{x}(0)\\
 & = & \sum_{i=1}^{N}e^{\lambda_{i}t}\bar{v}_{i}\left\{ \bar{w}_{i}^{T}\bar{x}(0)\right\} \\
\\\\\\\\\bar{x}(t) & = & \sum_{i=1}^{N}e^{\lambda_{i}t}\bar{v}_{i}B_{i}\\
\text{where}\\
B_{i} & = & \bar{w}_{i}^{T}\bar{x}(0)\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
The solution for 
\begin_inset Formula $\bar{x}(t)$
\end_inset

 is a linear combination of our modes 
\begin_inset Formula $e^{\lambda_{i}t}\bar{v}_{i}$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $e^{\lambda_{i}t}\ \rightarrow$
\end_inset

 Determine the nature of the time response.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\bar{v}_{i}\ \rightarrow$
\end_inset

 Determines the extent to which each state contributes to the mode.
\end_layout

\begin_layout Itemize
\begin_inset Formula $B_{i}\ \rightarrow$
\end_inset

 Determine the extent to which the initial conditions excite the mode.
\end_layout

\begin_layout Subsubsection
Example
\end_layout

\begin_layout Paragraph
Previously:
\begin_inset Formula \[
\dot{\bar{x}}=\left[\begin{array}{cc}
-1 & 1\\
8 & 5\end{array}\right]\]

\end_inset


\end_layout

\begin_layout Itemize
Initial conditions: 
\begin_inset Formula $\bar{x}(0)=\left[\begin{array}{c}
1\\
6\end{array}\right]$
\end_inset


\end_layout

\begin_layout Itemize
Calculated: 
\begin_inset Formula $\Lambda=\left[\begin{array}{cc}
1 & 0\\
0 & 3\end{array}\right]$
\end_inset

, 
\begin_inset Formula $T=\left[\begin{array}{cc}
1 & 1\\
2 & 4\end{array}\right]$
\end_inset


\end_layout

\begin_layout Paragraph

\series bold
Solution:
\end_layout

\begin_layout Standard
\begin_inset Formula \[
\bar{x}(t)=e^{At}\bar{x}(0)=\sum_{i=1}^{N}e^{\lambda_{i}t}\bar{v}_{i}\left\{ \bar{w}_{i}^{T}\bar{x}(0)\right\} \]

\end_inset


\begin_inset Formula \begin{eqnarray*}
T^{-1} & = & \left[\begin{array}{c}
w_{1}^{T}\\
\vdots\\
w_{N}^{T}\end{array}\right]\\
\\T^{-1} & = & \frac{\left[\begin{array}{cc}
4 & 1\\
-2 & 1\end{array}\right]}{4-2}=\left[\begin{array}{cc}
2 & -\frac{1}{2}\\
-1 & \frac{1}{2}\end{array}\right]\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\left[\begin{array}{c}
x_{1}(t)\\
x_{2}(t)\end{array}\right] & = & e^{t}\left[\begin{array}{c}
1\\
2\end{array}\right]\left[\begin{array}{cc}
2 & -\frac{1}{2}\end{array}\right]\left[\begin{array}{c}
1\\
6\end{array}\right]+e^{3t}\left[\begin{array}{c}
1\\
4\end{array}\right]\left[\begin{array}{cc}
-1 & \frac{1}{2}\end{array}\right]\left[\begin{array}{c}
1\\
6\end{array}\right]\end{eqnarray*}

\end_inset


\begin_inset Formula \[
\boxed{\bar{x}=-e^{t}\left[\begin{array}{c}
1\\
2\end{array}\right]+2e^{3t}\left[\begin{array}{c}
1\\
4\end{array}\right]}\]

\end_inset


\end_layout

\begin_layout Subsection
Zero-state response (forced response)
\end_layout

\begin_layout Standard
Find the response of our LTI system
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}+B\bar{u}\\
\bar{y} & = & C\bar{x}+D\bar{u}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
With 
\begin_inset Formula $\bar{x}(0)=0$
\end_inset

 and 
\begin_inset Formula $\bar{u}$
\end_inset

 is a known continuous vector function over the interval 
\begin_inset Formula $\left[t_{0},t_{f}\right]$
\end_inset

.
\end_layout

\begin_layout Paragraph

\series bold
Rearrange:
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}}-A\bar{x} & = & B\bar{u}\\
e^{-At}\left(\dot{\bar{x}}-A\bar{x}\right) & = & e^{-At}B\bar{u}\\
\frac{d}{dt}\left(e^{-At}\bar{x}\right) & = & e^{-At}B\bar{u}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Paragraph

\series bold
Integrate:
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\int_{t_{0}}^{t_{f}}\,\frac{d}{d\tau}\left(e^{-A\tau}\bar{x}\right)\, d\tau & = & \int_{t_{0}}^{t_{f}}\, e^{-A\tau}B\bar{u}\, d\tau\\
\\e^{-At}\bar{x}(t_{f})-e^{-At}\bar{x}(t_{0}) & = & \int_{t_{0}}^{t_{f}}\, e^{-A\tau}B\bar{u}\, d\tau\\
e^{-At}\bar{x}(t_{f}) & = & e^{-At}\bar{x}(t_{0})+\int_{t_{0}}^{t_{f}}\, e^{-A\tau}B\bar{u}\, d\tau\\
\\\bar{x}(t_{f}) & = & \underbrace{e^{At}\bar{x}(t_{0})}_{\text{Initial condition response}}+\underbrace{e^{At}\int_{t_{0}}^{t_{f}}\, e^{-A\tau}B\bar{u}\, d\tau}_{\text{Forced response}}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsection
Motivation of controllability and observability
\end_layout

\begin_layout Standard
Consider 2 state space models
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\begin{array}{ccc}
\dot{x} & = & -2x+2u\\
y & = & 3x\end{array}$
\end_inset


\end_layout

\begin_layout Enumerate

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
\begin_inset Formula $\begin{array}{ccc}
\dot{\bar{x}} & = & \left[\begin{array}{cc}
-2 & 0\\
0 & -1\end{array}\right]\bar{x}+\left[\begin{array}{c}
2\\
1\end{array}\right]\\
y & = & \left[\begin{array}{cc}
3 & 0\end{array}\right]\bar{x}\end{array}$
\end_inset


\end_layout

\begin_layout Standard
Calculate the transfer function of each:
\end_layout

\begin_layout Standard
\begin_inset Formula \[
G(s)=C\left(sI-A\right)^{-1}B+D\]

\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula \begin{eqnarray*}
G(s) & = & 3\left(s+2\right)^{-1}2+0=\frac{6}{s+2}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula \begin{eqnarray*}
G(S) & = & \left[\begin{array}{cc}
3 & 0\end{array}\right]\left[\begin{array}{cc}
s+1 & 0\\
0 & s+2\end{array}\right]\left[\begin{array}{c}
2\\
1\end{array}\right]\frac{1}{(s+1)(s+2)}\\
 & = & \left[\begin{array}{cc}
3 & 0\end{array}\right]\left[\begin{array}{c}
2(s+1)\\
s+2\end{array}\right]\frac{1}{(s+1)(s+2)}\\
 & = & \frac{6(s+1)}{(s+1)(s+2)}\\
 & = & \frac{6}{(s+2)}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
Dynamics of the second state of the system 
\begin_inset Formula $\left(x_{2}\right)$
\end_inset

 where eliminated in 
\begin_inset Formula $\left[\begin{array}{cc}
3 & \mathbf{0}\end{array}\right]\left[\begin{array}{c}
2(s+1)\\
\mathbf{s+2}\end{array}\right]$
\end_inset

.
\end_layout

\begin_layout Standard
This was due to the fact that 
\begin_inset Formula $A$
\end_inset

 was decoupled and a zero was present in the 
\begin_inset Formula $C$
\end_inset

 matrix.
\end_layout

\begin_layout Paragraph

\series bold
What does this mean?
\end_layout

\begin_layout Itemize
The dynamics of the second state are unobservable using our current sensor
 configuration (
\begin_inset Formula $C$
\end_inset

 matrix).
\end_layout

\begin_layout Itemize
Could have a lot of motion in 
\begin_inset Formula $\bar{x}_{2}$
\end_inset

 but wouldn't be able to 
\begin_inset Quotes eld
\end_inset

see
\begin_inset Quotes erd
\end_inset

 it.
\end_layout

\begin_layout Itemize
This requires special conditions on 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $C$
\end_inset

 (more on this later).
\end_layout

\begin_layout Standard
In a similar fashion, we can look at:
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\begin{array}{ccl}
\dot{x} & = & -2x+2u\\
y & = & 3x\end{array}$
\end_inset


\end_layout

\begin_layout Enumerate

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
\begin_inset Formula $\begin{array}{rrl}
\dot{\bar{x}} & = & \left[\begin{array}{cc}
-2 & 0\\
0 & -1\end{array}\right]\bar{x}+\left[\begin{array}{c}
2\\
0\end{array}\right]u\\
y & = & \left[\begin{array}{cc}
3 & 2\end{array}\right]\bar{x}\end{array}$
\end_inset


\end_layout

\begin_layout Standard
G(s) for (2):
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
G(s) & = & \left[\begin{array}{cc}
3 & 2\end{array}\right]\left[\begin{array}{cc}
s+2 & 0\\
0 & s+1\end{array}\right]^{-1}\left[\begin{array}{c}
2\\
0\end{array}\right]\\
 & = & \frac{1}{\left(s+1\right)\left(s+2\right)}\left[\begin{array}{cc}
3 & 2\end{array}\right]\left[\begin{array}{cc}
s+1 & 0\\
0 & s+2\end{array}\right]\left[\begin{array}{c}
2\\
0\end{array}\right]\\
 & = & \frac{1}{\left(s+1\right)\left(s+2\right)}\left[\begin{array}{cc}
3 & 2\end{array}\right]\left[\begin{array}{c}
2\left(s+1\right)\\
0\end{array}\right]\\
 & = & \frac{6\left(s+1\right)}{\left(s+1\right)\left(s+2\right)}\\
 & = & \frac{6}{\left(s+2\right)}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
But in this case this was due to the presence of a zero in the B matrix.
\end_layout

\begin_layout Itemize
While we can observe 
\begin_inset Formula $x_{2}$
\end_inset

 for this system, we have no means of affecting the evolution of this state
 with our control input since 
\begin_inset Formula $B=\left[\begin{array}{c}
2\\
0\end{array}\right]$
\end_inset

.
\end_layout

\begin_layout Standard
In this instance we say that the dynamics associated with 
\begin_inset Formula $x_{s}$
\end_inset

 are uncontrollable with our actuator configuration.
\end_layout

\begin_layout Paragraph

\series bold
Finally:
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \left[\begin{array}{cc}
-2 & 0\\
0 & -1\end{array}\right]\bar{x}+\left[\begin{array}{c}
2\\
0\end{array}\right]u\\
y & = & \left[\begin{array}{cc}
3 & 0\end{array}\right]\bar{x}\\
\\G(s) & = & \frac{6}{\left(s+2\right)}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $x_{s}$
\end_inset

 is both uncontrollable and unobservable.
\end_layout

\begin_layout Paragraph

\series bold
Summary:
\end_layout

\begin_layout Itemize
Dynamics in a state space model that are uncontrollable, unobservable or
 both do not show up in the transfer function.
\end_layout

\begin_layout Itemize
A minimal realization is a model that is both controllable and observable
 and provides the lowest possible order for the associated transfer function.
\end_layout

\begin_layout Subsection
Controllability
\end_layout

\begin_layout Standard
Two fundamental questions, which will directly relate to developing stabilizing
 control laws for the LTI system
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}+B\bar{u}\\
\bar{y} & = & C\bar{x}+D\bar{u}\\
\\\bar{x}(t_{0}) & = & \bar{x}_{0}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Enumerate
Can this system be driven, by an appropriate control signal 
\begin_inset Formula $\bar{u}(t)$
\end_inset

, from any initial state 
\begin_inset Formula $\bar{x}_{0}$
\end_inset

 to any final state 
\begin_inset Formula $\bar{x}_{f}$
\end_inset

 in a given time interval 
\begin_inset Formula $\left[t_{o},t_{f}\right]$
\end_inset

?
\end_layout

\begin_layout Enumerate
Can on construct a precise estimate of the system state 
\begin_inset Formula $\bar{x}$
\end_inset

 at time 
\begin_inset Formula $t_{f}$
\end_inset

 given only the input signal and the output signal 
\begin_inset Formula $\bar{y}(t)$
\end_inset

 over 
\begin_inset Formula $\left[t_{o},t_{f}\right]$
\end_inset

?
\end_layout

\begin_layout Standard
Question (1) assesses the system's controllability and only concerns state
 the state equations.
 Question (2) assess the system's observability and concerns both the state
 and output equations.
\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
10/11/2010
\end_layout

\begin_layout Itemize
Controllability
\end_layout

\begin_deeper
\begin_layout Itemize
Definition and proffs continued
\end_layout

\end_deeper
\begin_layout Itemize
Controllability tests (and proofs)
\end_layout

\begin_deeper
\begin_layout Itemize
Grammian
\end_layout

\begin_layout Itemize
Matrix
\end_layout

\begin_layout Itemize
Modal
\end_layout

\end_deeper
\begin_layout Standard

\series bold
Diagonalize review:
\end_layout

\begin_layout Standard
\begin_inset Formula \[
\dot{\bar{x}}=Ax+Bu\]

\end_inset


\end_layout

\begin_layout Enumerate
Eigs and Eigenvectors of 
\begin_inset Formula $A$
\end_inset

:
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $\det\left[\lambda I-A\right]=0\,\rightarrow$
\end_inset

poly in 
\begin_inset Formula $\lambda\rightarrow$
\end_inset

solve to get eigenvalues
\end_layout

\begin_layout Enumerate
\begin_inset Formula $[\lambda I-A]\bar{\lambda}=\bar{0}\ \rightarrow$
\end_inset

 sub in 
\begin_inset Formula $\lambda_{i}\ \rightarrow$
\end_inset

calculate associated 
\begin_inset Formula $\bar{v}_{i}$
\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
Form 
\begin_inset Formula $T=\left[v_{1}\dots v_{N}\right]$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $\bar{x}=T\bar{z}\ \rightarrow\dot{\bar{z}}=T^{-1}AT\bar{z}+T^{-1}B\bar{u}$
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $T^{-1}AT\ \rightarrow$
\end_inset

Diagonal matrix 
\begin_inset Formula $\Lambda=\left[\begin{array}{ccc}
\lambda_{1} & 0 & 0\\
0 & \ddots & 0\\
0 & 0 & \lambda_{N}\end{array}\right]$
\end_inset

tion:
\end_layout

\end_deeper
\begin_layout Subsection
Controllability
\end_layout

\begin_layout Subsubsection
Definition
\end_layout

\begin_layout Standard
A LTI system is controllable if for every 
\begin_inset Formula $\bar{x}_{1}$
\end_inset

 and every time 
\begin_inset Formula $T>0$
\end_inset

 there exists an input history 
\begin_inset Formula $\bar{u}(t)$
\end_inset

 defined on 
\begin_inset Formula $\left[0,T\right]$
\end_inset

 which drives the system from 
\begin_inset Formula $\bar{x}(0)=0$
\end_inset

 to 
\begin_inset Formula $\bar{x}(T)=\bar{x}_{1}$
\end_inset

.
\end_layout

\begin_layout Itemize
Controllability deals with the system's zero state response.
\end_layout

\begin_layout Subsubsection
Definition
\end_layout

\begin_layout Standard
A state 
\begin_inset Formula $\bar{x}^{*}\neq\bar{0}$
\end_inset

 is said to be uncontrollable if the zero state response 
\begin_inset Formula $\bar{x}(t)$
\end_inset

 is orthogonal to 
\begin_inset Formula $\bar{x}^{*}$
\end_inset

 for all 
\begin_inset Formula $t>0$
\end_inset

 and all input functions.
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\text{Zero state solution:}\\
\bar{x}(t) & = & \int_{t_{0}}^{t}\, e^{A(t-\tau)}Bu\left(\tau\right)\, d\tau\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
0 & = & \bar{x}^{*}\cdot\bar{x}(t)\\
0 & = & \bar{x}^{*T}\int_{0}^{T}\, e^{A\tau}Bu\left(t-\tau\right)\, d\tau\\
0 & = & \int_{0}^{T}\,\bar{x}^{*T}e^{A\tau}Bu\left(t-\tau\right)\, d\tau\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
To be true for all input histories and time 
\begin_inset Formula $\bar{x}^{*T}e^{A\tau}B=\bar{0}$
\end_inset

 for all 
\begin_inset Formula $\tau$
\end_inset

 in 
\begin_inset Formula $\left[0,T\right]$
\end_inset

.
 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\bar{x}^{*}$
\end_inset

is an uncontrollable state if the above holds true.
\end_layout

\begin_layout Subsubsection
Example
\end_layout

\begin_layout Standard
Given:
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \left[\begin{array}{cc}
-2 & 0\\
0 & -1\end{array}\right]\bar{x}+\left[\begin{array}{c}
2\\
0\end{array}\right]u\\
y & = & \left[\begin{array}{cc}
3 & 0\end{array}\right]\bar{x}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
is 
\begin_inset Formula $\bar{x}^{*}=\left[\begin{array}{c}
0\\
1\end{array}\right]$
\end_inset

 uncontrollable?
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\bar{x}^{*T}e^{A\tau}B & = & \left[\begin{array}{cc}
0 & 1\end{array}\right]\left[\begin{array}{cc}
e^{-2t} & 0\\
0 & e^{-t}\end{array}\right]\left[\begin{array}{c}
2\\
0\end{array}\right]\\
 & = & \left[\begin{array}{cc}
0 & 1\end{array}\right]\left[\begin{array}{c}
2e^{-2t}\\
0\end{array}\right]=0\text{ for all }t\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $\therefore\bar{x}^{*}=\left[\begin{array}{c}
0\\
1\end{array}\right]$
\end_inset

 is an uncontrollable state.
\end_layout

\begin_layout Subsubsection
Theorem:
\end_layout

\begin_layout Standard
A LTI system is controllable if and only if it has no uncontrollable states.
\end_layout

\begin_layout Standard

\series bold
Proof:
\end_layout

\begin_layout Standard
Sufficiency: (if) Show that controllability follows if there are no uncontrollab
le states.
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Itemize
Use the test input:
\begin_inset Formula \[
u(\tau-t)=B^{T}e^{A^{T}\tau}\bar{v}\]

\end_inset

where 
\begin_inset Formula $\bar{v}$
\end_inset

 is a vector to be chosen 
\begin_inset Formula $\left(\bar{v}\neq0\right)$
\end_inset

.
\end_layout

\begin_layout Itemize
Put into our zero state response:
\begin_inset Formula \[
x(t)=\int_{0}^{T}e^{A\tau}Bu\left(\tau-t\right)\, d\tau=\int_{0}^{T}e^{A\tau}BB^{T}e^{A^{T}\tau}\bar{v}\, d\tau\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
x(t) & \hat{=} & N(T)\bar{v}\\
\\N(T) & = & \int_{0}^{T}e^{A\tau}BB^{T}e^{A^{T}\tau}\, d\tau\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
Multiplying by 
\begin_inset Formula $\bar{v}^{T}$
\end_inset

:
\begin_inset Formula \[
\bar{v}^{T}x(t)=\int_{0}^{T}\,\bar{v}^{T}e^{A\tau}BB^{T}e^{A^{T}\tau}\bar{v}\, d\tau\]

\end_inset


\end_layout

\begin_layout Itemize
Define
\begin_inset Formula \[
\bar{w}(\tau)=B^{T}e^{A^{T}\tau}\bar{v}\bar{w}^{T}(\tau)=\bar{v}^{T}Be^{A\tau}=\int_{0}^{T}\,\left\Vert \bar{w}(T)\right\Vert ^{2}d\tau\]

\end_inset


\end_layout

\begin_layout Itemize
Suppose there are no uncontrollable states (uncontrollable state 
\begin_inset Formula $\rightarrow\bar{v}^{T}e^{A\tau}B=\bar{0}$
\end_inset

).
 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none

\begin_inset Formula $\int_{0}^{T}\,\bar{v}^{T}e^{A\tau}BB^{T}e^{A^{T}\tau}\bar{v}\, d\tau$
\end_inset

 is positive for all 
\begin_inset Formula $\bar{v}\neq\bar{0}.$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\therefore$
\end_inset

 
\begin_inset Formula $\bar{v}^{T}N(T)\bar{v}>0$
\end_inset

 for all 
\begin_inset Formula $\bar{v}\ne0$
\end_inset


\end_layout

\begin_layout Itemize
Matrix 
\begin_inset Formula $N(T)=\int_{0}^{T}\, e^{A\tau}BB^{T}e^{A^{T}\tau}\, d\tau$
\end_inset

 is positive definite 
\begin_inset Formula $\rightarrow$
\end_inset

thus 
\begin_inset Formula $N(T)$
\end_inset

 is invertible.
\end_layout

\begin_layout Itemize
To find 
\begin_inset Formula $u(t)$
\end_inset

 that drives our system from 
\begin_inset Formula $\bar{x}(0)=\bar{0}$
\end_inset

 to 
\begin_inset Formula $\bar{x}(T)=\bar{x}^{*}$
\end_inset


\begin_inset Formula \[
\bar{u}(T-t)=B^{T}e^{A^{T}\tau}\bar{v}\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
x(T) & = & N(T)\bar{v}\\
\bar{v} & = & N(T)^{-1}\bar{x}(T)\\
\bar{u}(T-t) & = & B^{T}e^{A^{T}\tau}N(T)^{-1}\bar{x}^{*}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
Since this holds for any 
\begin_inset Formula $\bar{x}^{*}\ne0$
\end_inset

 and any time 
\begin_inset Formula $>0$
\end_inset

 
\begin_inset Formula $\rightarrow$
\end_inset

system is controllable.
\end_layout

\begin_layout Subsection
Controllability test
\end_layout

\begin_layout Itemize
Controllability Grammian
\end_layout

\begin_layout Itemize
Rank of controllability matrix
\end_layout

\begin_layout Itemize
Modal test
\end_layout

\begin_layout Subsubsection
Controllabilty Grammian
\end_layout

\begin_layout Standard

\series bold
Defined:
\end_layout

\begin_layout Standard
\begin_inset Formula \[
w_{c}\left(t_{0},t_{f}\right)=\int_{t_{0}}^{t_{f}}\, e^{A\left(t_{0}-\tau\right)}BB^{T}e^{A^{T}\left(t_{o}-\tau\right)}\, d\tau\]

\end_inset


\end_layout

\begin_layout Standard
The system is controllable on 
\begin_inset Formula $\left[t_{o},t_{f}\right]$
\end_inset

 iff 
\begin_inset Formula $w_{c}$
\end_inset

 is non-singular.
\end_layout

\begin_layout Itemize
\begin_inset Formula $w_{c}$
\end_inset

 can also be obtained as a solution to the Lyapunov EQ:
\begin_inset Formula \[
Aw_{c}+w_{c}A^{T}=-BB^{T}\]

\end_inset


\end_layout

\begin_layout Subsubsection
Controllability matrix
\end_layout

\begin_layout Standard
The 
\begin_inset Formula $N\, x\, NM$
\end_inset

 controllability matrix is defined as
\begin_inset Formula \begin{eqnarray*}
\mathcal{C}\left(A,B\right) & = & \left[\begin{array}{ccccc}
\underbrace{B}_{N\times M} & \underbrace{A}_{N\times N}B & A^{2}B & \dots & A^{N-1}B\end{array}\right]\\
\\N & = & \text{\# nof states}\\
A & = & N\times N\\
B & = & N\times M\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Paragraph

\series bold
Theorem:
\end_layout

\begin_layout Standard
Our LTI system
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}+B\bar{u}\\
\bar{y} & = & C\bar{x}+D\bar{u}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
is controllable on 
\begin_inset Formula $\left[t_{o},t_{f}\right]$
\end_inset

 iff rank 
\begin_inset Formula $\mathcal{C}\left(A,B\right)=N$
\end_inset


\end_layout

\begin_layout Paragraph

\series bold
Proof:
\end_layout

\begin_layout Enumerate
Assume that the rank condition does not hold and show that the controllability
 Grammian is singular.
\end_layout

\begin_layout Enumerate
Assume that the controllability Grammian is singular and show that the rank
 condition doesn't hold
\end_layout

\begin_layout Paragraph
Part 1: Assume rank condition fails
\end_layout

\begin_layout Standard
There existis a vector 
\begin_inset Formula $\bar{x}$
\end_inset

 
\begin_inset Formula $\left(\bar{x}\ne\bar{0}\right)$
\end_inset


\begin_inset Formula \[
\bar{x}^{T}\mathcal{C}\left(A,B\right)=0\]

\end_inset


\end_layout

\begin_layout Standard
Equivalently, there is an 
\begin_inset Formula $\bar{x}$
\end_inset

 that is orthogonal to every column of 
\begin_inset Formula $e\left(A,B\right)$
\end_inset


\begin_inset Formula \[
\bar{x}^{T}A^{k}B=0\]

\end_inset


\end_layout

\begin_layout Standard
For each 
\begin_inset Formula $k=0,1,\dots n-1$
\end_inset

.
 Use the fact:
\begin_inset Formula \begin{eqnarray*}
e^{At} & = & \sum_{k=0}^{N-1}\alpha_{k}(t)A^{k}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\bar{x}^{T}w_{c}\left(t_{0},t_{f}\right) & = & \bar{x}^{T}\int_{t_{0}}^{t_{f}}\, e^{A\left(t_{0}-\tau\right)}BB^{T}e^{A^{T}\left(t_{o}-\tau\right)}\, d\tau\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
10/13/2010
\end_layout

\begin_layout Itemize
Controllability
\end_layout

\begin_deeper
\begin_layout Itemize
Modal test
\end_layout

\end_deeper
\begin_layout Itemize
Stabilizability
\end_layout

\begin_layout Itemize
Observability
\end_layout

\begin_deeper
\begin_layout Itemize
Definitions & proofs
\end_layout

\begin_layout Itemize
Tests
\end_layout

\end_deeper
\begin_layout Subsection
Modal Test (Popov-Belevitch-Havtus)
\end_layout

\begin_layout Standard
Assume for our LTI system (
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none

\begin_inset Formula $\begin{array}{ccc}
\dot{\bar{x}} & = & A\bar{x}+B\bar{u}\\
\bar{y} & = & C\bar{x}+D\bar{u}\end{array}$
\end_inset

)
\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
 that 
\begin_inset Formula $A$
\end_inset

 is diagonalizable such that the system can be expressed in modal form
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{z}} & = & \Lambda\bar{z}+T^{-1}B\bar{u}\\
\bar{y} & = & CT\bar{z}+D\bar{u}\\
\\\dot{\bar{z}} & = & \Lambda\bar{z}+\tilde{B}\bar{u}\\
\bar{y} & = & \tilde{C}\bar{z}+D\bar{u}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
The controllability rank condition becomes
\begin_inset Formula \begin{eqnarray*}
rank\left(\Lambda,T^{-1}B\right) & = & rank\left[T^{-1}B,\Lambda T^{-1}B\dots\Lambda^{N-1}T^{-1}B\right]\\
 & = & N\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $T=\left[\bar{v}_{1},\bar{v}_{2},\dots\bar{v}_{N}\right]\,\rightarrow$
\end_inset

each column is a right eigenvector.
 Inverse of 
\begin_inset Formula $T$
\end_inset

 is the matrix whose rows are left eigenvectors
\begin_inset Formula \[
AT^{-1}=\Lambda T^{-1}\rightarrow\left[\begin{array}{c}
w_{1}^{T}\\
\vdots\\
w_{N}^{T}\end{array}\right]A=\left[\begin{array}{c}
\lambda_{1}w_{1}^{T}\\
\vdots\\
\lambda_{1}w_{N}^{T}\end{array}\right]\]

\end_inset


\end_layout

\begin_layout Standard
Suppose that 
\begin_inset Formula $\bar{w}_{i}^{T}B=0$
\end_inset

 then the 
\begin_inset Formula $i^{th}$
\end_inset

 row of 
\begin_inset Formula $\Lambda^{j}T^{-1}B$
\end_inset

 will be zero for all 
\begin_inset Formula $j\in\left[0,1\dots N-1\right]$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $\rightarrow$
\end_inset


\begin_inset Formula $i^{th}$
\end_inset

 row of 
\begin_inset Formula $\mathcal{C}\left(\Lambda,T^{-1}B\right)$
\end_inset

 will be zero and 
\begin_inset Formula $\mathcal{C}\left(\Lambda,T^{-1}B\right)$
\end_inset

 cannot have full rank.
 In this case 
\begin_inset Formula $i^{th}$
\end_inset

 mode is uncontrollable.
\end_layout

\begin_layout Subsubsection
Theorem
\end_layout

\begin_layout Standard
A LTI system is uncontrollable iff there exists a left eigenvector of our
 matrix 
\begin_inset Formula $A$
\end_inset

 such that 
\begin_inset Formula $\bar{w}_{i}^{T}B=\bar{0}$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Controllability criterion
\end_layout

\begin_layout Standard
The system is controllable if 
\begin_inset Formula $A$
\end_inset

 has distinct eigenvalues and there are no zero rows in 
\begin_inset Formula $T^{-1}B$
\end_inset

.
\end_layout

\begin_layout Subsubsection
For repeated eigenvalues
\end_layout

\begin_layout Standard
The system is controllable if all row(s) of the 
\begin_inset Formula $\tilde{B}$
\end_inset

 corresponding to the last row of each Jordan block are not all zeros and
 the rows of 
\begin_inset Formula $\tilde{B}$
\end_inset

 that correspond to distinct eigenvaluse are not all zero.
\end_layout

\begin_layout Subsubsection
Example
\end_layout

\begin_layout Standard
\begin_inset Formula \[
\dot{\bar{x}}=\left[\begin{array}{ccc}
1 & 1 & -1\\
0 & 0 & 2\\
0 & -1 & 3\end{array}\right]\bar{x}+\left[\begin{array}{c}
1\\
1\\
1\end{array}\right]\bar{u}\]

\end_inset


\end_layout

\begin_layout Standard
Determine controllability via modal test.
\begin_inset Formula \begin{eqnarray*}
\det\left[\lambda I-A\right]=0=\left|\begin{array}{ccc}
\lambda-1 & -1 & 1\\
0 & \lambda & -2\\
0 & 1 & \lambda-3\end{array}\right| & = & \left(\lambda-1\right)\left[\lambda^{2}-3\lambda+2\right]\\
 & = & \left(\lambda-1\right)^{2}\left(\lambda-2\right)\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\lambda_{1} & = & 1\\
\lambda_{2} & = & 1\\
\lambda_{3} & = & 2\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \[
x_{1}=1\,\rightarrow\,\left[\lambda I-A\right]\bar{v}_{1}=\bar{0}\]

\end_inset


\begin_inset Formula \[
\left[\begin{array}{ccc}
0 & -1 & 1\\
0 & 1 & -2\\
0 & 1 & -2\end{array}\right]\left[\begin{array}{c}
v_{11}\\
v_{21}\\
v_{31}\end{array}\right]=\left[\begin{array}{c}
0\\
0\\
0\end{array}\right]\]

\end_inset


\begin_inset Formula \[
\bar{v}_{1}=\left[\begin{array}{c}
1\\
0\\
0\end{array}\right]\]

\end_inset


\begin_inset Formula \[
\left(A-\lambda I\right)\bar{v}_{2}=\bar{v}_{1}\]

\end_inset


\begin_inset Formula \[
\left[\begin{array}{ccc}
0 & -1 & 1\\
0 & 1 & -2\\
0 & 1 & -2\end{array}\right]\left[\begin{array}{c}
v_{12}\\
v_{22}\\
v_{32}\end{array}\right]=\left[\begin{array}{c}
1\\
0\\
0\end{array}\right]\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
\rightarrow\\
v_{12} & = & 0\\
v_{22} & = & 2\\
v_{32} & = & 1\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \[
\bar{v_{2}=}\left[\begin{array}{c}
0\\
2\\
1\end{array}\right]\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \[
\lambda_{3}=2\rightarrow\bar{v}_{3}=\left[\begin{array}{c}
0\\
1\\
1\end{array}\right]\]

\end_inset


\begin_inset Formula \[
T=\left[\begin{array}{ccc}
\bar{v}_{1} & \bar{v}_{2} & \bar{v}_{3}\end{array}\right]=\left[\begin{array}{ccc}
1 & 0 & 0\\
0 & 2 & 1\\
0 & 1 & 1\end{array}\right],\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
T^{-1} & = & \frac{cof(T)^{T}}{\det(T)}\\
 & = & \left[\begin{array}{ccc}
1 & 0 & 0\\
0 & 2 & -1\\
0 & -1 & 1\end{array}\right]\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
T^{-1}AT & = & \left[\begin{array}{ccc}
1 & 0 & 0\\
0 & 2 & -1\\
0 & -1 & 1\end{array}\right]\left[\begin{array}{ccc}
1 & 1 & -1\\
0 & 0 & 2\\
0 & -1 & 3\end{array}\right]\left[\begin{array}{ccc}
1 & 0 & 0\\
0 & 2 & 1\\
0 & 1 & 1\end{array}\right]\\
 & = & \left[\begin{array}{ccc}
1 & 0 & 0\\
0 & 2 & -1\\
0 & -1 & 1\end{array}\right]\left[\begin{array}{ccc}
1 & 1 & 0\\
0 & 2 & 2\\
0 & 1 & 2\end{array}\right]\\
 & = & \left[\begin{array}{ccc}
1 & 1 & 0\\
0 & 1 & 0\\
0 & 0 & 2\end{array}\right]\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
T^{-1}B & = & \left[\begin{array}{ccc}
1 & 0 & 0\\
0 & 1 & -1\\
0 & -1 & 2\end{array}\right]\left[\begin{array}{c}
1\\
1\\
1\end{array}\right]\\
 & = & \left[\begin{array}{c}
1\\
0\\
1\end{array}\right]\end{eqnarray*}

\end_inset


\begin_inset Formula \[
\dot{\bar{z}}=\left[\begin{array}{ccc}
1 & 1 & 0\\
0 & 1 & 0\\
0 & 0 & 2\end{array}\right]\bar{z}+\left[\begin{array}{c}
1\\
0\\
1\end{array}\right]\bar{u}\]

\end_inset


\end_layout

\begin_layout Standard
Not controllable.
\end_layout

\begin_layout Subsubsection
Notes
\end_layout

\begin_layout Itemize
Controllability rank condition is independent of the initial and final times
 if the system is controllable on any nontrivial (not zero) intervals, then
 it is controllable on all intervals.
\end_layout

\begin_layout Itemize
Property of controllability is invariant under nonsingular transformations.
\end_layout

\begin_layout Itemize
Controllablility is not necessary or sufficient for the existance of a solution
 to controlling the output 
\begin_inset Formula $\bar{y}$
\end_inset

.
\end_layout

\begin_layout Standard

\series bold
Output controllablity matrix:
\begin_inset Formula \[
o.c.=\left[\begin{array}{cccccc}
CB & CAB & CA^{2}B & \dots & CA^{N-1}B & D\end{array}\right]\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $rank\left(o.c.\right)=P$
\end_inset

 where 
\begin_inset Formula $\left(\begin{array}{cc}
A=NxN & C=PxN\\
B=NxM & D=PxM\end{array}\right)$
\end_inset


\end_layout

\begin_layout Subsubsection
Example:
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \left[\begin{array}{cc}
-2 & -2\\
0 & -4\end{array}\right]\bar{x}+\left[\begin{array}{c}
1\\
1\end{array}\right]\bar{u}\\
\bar{y} & = & \left[\begin{array}{cc}
1 & 0\end{array}\right]x+0u\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Is the system controllable?
\end_layout

\begin_layout Enumerate

\series bold
Using matrix formulation
\series default

\begin_inset Formula \begin{eqnarray*}
\mathcal{C}(A,B) & = & \left[\begin{array}{cc}
B & AB\end{array}\right]\\
 & = & \left[\begin{array}{cc}
\begin{array}{c}
1\\
1\end{array} & \left[\begin{array}{cc}
-2 & -2\\
0 & -4\end{array}\right]\left[\begin{array}{c}
1\\
1\end{array}\right]\end{array}\right]\\
 & = & \left[\begin{array}{cc}
1 & -4\\
1 & -4\end{array}\right]\end{eqnarray*}

\end_inset

Rank is 1 
\begin_inset Formula $\rightarrow$
\end_inset

system is uncontrollable.
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Enumerate

\series bold
Modal test:
\begin_inset Formula \[
\det\left[\lambda I-A\right]=\left[\begin{array}{cc}
\lambda+2 & 2\\
0 & \lambda+4\end{array}\right]\rightarrow\left(\lambda+2\right)\left(\lambda+4\right)=0\]

\end_inset


\begin_inset Formula \[
\lambda=-2,-4\]

\end_inset


\begin_inset Formula \[
\lambda_{1}=-2,\ \bar{v}_{1}=\left[\begin{array}{c}
0\\
1\end{array}\right],\ \lambda_{2}=-4,\ \bar{v}_{2}=\left[\begin{array}{c}
1\\
1\end{array}\right]\]

\end_inset


\begin_inset Formula \[
T=\left[\begin{array}{cc}
0 & 1\\
1 & 1\end{array}\right],\ T^{-1}=\left[\begin{array}{cc}
-1 & 1\\
1 & 0\end{array}\right]\]

\end_inset


\begin_inset Formula \[
T^{-1}B=\left[\begin{array}{cc}
-1 & 1\\
1 & 0\end{array}\right]\left[\begin{array}{c}
1\\
1\end{array}\right]=\overbrace{\left[\begin{array}{c}
0\\
1\end{array}\right]}^{\text{state }x_{1}\text{ is uncontrollable}}\]

\end_inset


\series default
System is uncontrollable.
\end_layout

\begin_layout Enumerate

\series bold
Output controllable?
\series default

\begin_inset Formula \begin{eqnarray*}
o.c. & = & \left[\begin{array}{cccccc}
CB & CAB & CA^{2}B & \dots & CA^{N-1}B & D\end{array}\right]\\
\\ & = & \left[\begin{array}{ccc}
\left[\begin{array}{cc}
1 & 0\end{array}\right]\left[\begin{array}{c}
1\\
1\end{array}\right] & \left[\begin{array}{cc}
1 & 0\end{array}\right]\left[\begin{array}{cc}
-2 & -2\\
0 & -4\end{array}\right]\left[\begin{array}{c}
1\\
1\end{array}\right] & 0\end{array}\right]\\
 & = & \left[\begin{array}{ccc}
1 & -4 & 0\end{array}\right]\end{eqnarray*}

\end_inset

Rank 
\begin_inset Formula $=1=P=$
\end_inset

# of outputs, system is output controllable.
\end_layout

\begin_layout Subsubsection
Example
\end_layout

\begin_layout Standard
\begin_inset Formula \[
\dot{\bar{x}}=\left[\begin{array}{ccc}
-2 & -2 & 0\\
0 & 0 & 1\\
0 & -3 & -4\end{array}\right]\bar{x}+\left[\begin{array}{cc}
1 & 0\\
0 & 1\\
1 & 1\end{array}\right]\bar{u}\]

\end_inset


\end_layout

\begin_layout Standard
Controllability?
\end_layout

\begin_layout Itemize
Matrix:
\begin_inset Formula \begin{eqnarray*}
\mathcal{C}(A,B) & = & \left[\begin{array}{ccc}
B & AB & A^{2}B\end{array}\right]\\
\\ & = & \left[\begin{array}{cccccc}
1 & 0 & -2 & -2 & 2 & 2\\
0 & 1 & 1 & 1 & -4 & -7\\
1 & 1 & -4 & -7 & 13 & 25\end{array}\right]\end{eqnarray*}

\end_inset

Rank is 3 (can take 3x3 det somewhere), controllable.
\end_layout

\begin_layout Itemize
Modal (with matlab):
\begin_inset Newline newline
\end_inset

[T,D]=eig(A)
\end_layout

\begin_layout Standard
\begin_inset Formula $T^{-1}B$
\end_inset

=inv(T)*B
\end_layout

\begin_layout Standard
ans =
\end_layout

\begin_layout Standard
\begin_inset Formula $\left[\begin{array}{cc}
3 & 6\\
1.22 & 4.89\\
1.87 & 3.74\end{array}\right]$
\end_inset


\begin_inset Newline newline
\end_inset

Controllable.
\end_layout

\begin_layout Subsection
Stabilizability
\end_layout

\begin_layout Itemize
Weaker form of controllability.
\end_layout

\begin_layout Itemize
If all eigenvalues of a sysetm have negative real part, our system is said
 to be stable.
\end_layout

\begin_layout Itemize
If we consider 
\begin_inset Formula $\dot{\bar{x}}=A\bar{x}$
\end_inset

, if any eigenvalue of 
\begin_inset Formula $A$
\end_inset

 has a positive real part then at least one state of 
\begin_inset Formula $\bar{x}$
\end_inset

 will diverge to 
\begin_inset Formula $\infty$
\end_inset

 as 
\begin_inset Formula $t\rightarrow\infty$
\end_inset

.
\end_layout

\begin_layout Itemize
One way to avoide this is to specify the input via state feedback.
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}+B\bar{u},\ \bar{u}=-k\bar{x}\\
 & = & A\bar{x}-Bk\bar{x}\\
 & = & \underbrace{\left(A-Bk\right)}_{\tilde{A}}\bar{x}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsubsection
Definition
\end_layout

\begin_layout Standard
The LTI system is stabilizable if there exists a real 
\begin_inset Formula $MxN$
\end_inset

 gain matrix 
\begin_inset Formula $k$
\end_inset

 such that 
\begin_inset Formula $\left(A-Bk\right)$
\end_inset

 is stable.
\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
10/18/2010
\end_layout

\begin_layout Itemize
Stabilizability calculation
\end_layout

\begin_layout Itemize
Observability
\end_layout

\begin_deeper
\begin_layout Itemize
Definition & proofs
\end_layout

\begin_layout Itemize
Means of calculating
\end_layout

\end_deeper
\begin_layout Itemize
Detectability
\end_layout

\begin_layout Subsection
Stabilizability
\end_layout

\begin_layout Subsubsection
Theorem
\end_layout

\begin_layout Standard
The LTI system is stabilizable iff for every left eigenvector 
\begin_inset Formula $\bar{w}_{i}^{T}$
\end_inset

 of 
\begin_inset Formula $A$
\end_inset

 for which 
\begin_inset Formula $\bar{w}_{i}^{T}B=\bar{0}$
\end_inset

, the corresponding eigenvalue 
\begin_inset Formula $\lambda_{i}$
\end_inset

 is stable (real part is negative).
 A system is stabilizable if all uncontrollable modes are stable.
\end_layout

\begin_layout Standard
Stabilizability can be checked using the eigenvector test for each unstable
 mode.
\end_layout

\begin_layout Itemize
For each unstable mode 
\begin_inset Formula $\lambda_{i}$
\end_inset

 of 
\begin_inset Formula $A$
\end_inset

, we need to compute 
\begin_inset Formula $\bar{w}_{i}^{T}$
\end_inset

.
\end_layout

\begin_layout Itemize
Check 
\begin_inset Formula $\bar{w}_{i}^{T}B\ \rightarrow$
\end_inset

iff all are 
\begin_inset Formula $=\bar{0}$
\end_inset

 then the system is 
\series bold
unstabilizable
\series default
.
\end_layout

\begin_layout Subsection
Observability
\end_layout

\begin_layout Subsubsection
Definition
\end_layout

\begin_layout Standard
A LTI system is observable if the initial state 
\begin_inset Formula $\bar{x}\left(0\right)$
\end_inset

 can be uniquely determined from the knowledge of the input 
\begin_inset Formula $\bar{u}\left(t\right)$
\end_inset

 and output 
\begin_inset Formula $\bar{y}\left(t\right)$
\end_inset

 for all 
\begin_inset Formula $t\in\left[0,T\right]\ T>0$
\end_inset

.
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $\bar{x}\left(0\right)$
\end_inset

 can be deduced
\begin_inset Formula \[
\bar{x}\left(t\right)=e^{At}\bar{x}\left(0\right)+\int_{0}^{t}\, B\bar{u}\left(\tau\right)\, d\tau\]

\end_inset


\end_layout

\begin_layout Standard
we can also determine 
\begin_inset Formula $\bar{x}\left(t\right)$
\end_inset

 for all time 
\begin_inset Formula $t\in\left[0,T\right]$
\end_inset

.
\end_layout

\begin_layout Itemize
Examine the zero input part of our solution for observability
\begin_inset Formula \[
\bar{y}=Ce^{At}\bar{x}\left(0\right)\]

\end_inset


\end_layout

\begin_layout Subsubsection
Definition
\end_layout

\begin_layout Standard
A state 
\begin_inset Formula $\bar{x}^{*}\neq\bar{0}$
\end_inset

 is unobservable if the zero-input solution 
\begin_inset Formula $\bar{y}\left(t\right)$
\end_inset

 with 
\begin_inset Formula $\bar{x}\left(0\right)=\bar{x}^{*}$
\end_inset

 is zero for all 
\begin_inset Formula $t\geq0$
\end_inset


\begin_inset Formula \[
Ce^{At}\bar{x}^{*}=\bar{0}\text{ for all }t\geq0\]

\end_inset


\end_layout

\begin_layout Subsubsection
Example
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \left[\begin{array}{cc}
-2 & 0\\
0 & -1\end{array}\right]\bar{x}+\left[\begin{array}{c}
2\\
1\end{array}\right]\bar{u}\\
\bar{y} & = & \left[\begin{array}{cc}
3 & 0\end{array}\right]\bar{x}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
is 
\begin_inset Formula $\bar{x}^{*}=\left[\begin{array}{c}
0\\
1\end{array}\right]$
\end_inset

 unobservable
\begin_inset Formula \begin{eqnarray*}
Ce^{At}\bar{x}^{*} & = & \left[\begin{array}{cc}
3 & 0\end{array}\right]\left[\begin{array}{cc}
e^{-2t} & 0\\
0 & e^{-t}\end{array}\right]\left[\begin{array}{c}
0\\
1\end{array}\right]\\
 & = & \left[\begin{array}{cc}
3 & 0\end{array}\right]\left[\begin{array}{c}
0\\
e^{-t}\end{array}\right]=0\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $\bar{x}^{*}$
\end_inset

 is unobservable.
\end_layout

\begin_layout Subsubsection
Theorem
\end_layout

\begin_layout Standard
A LTI system is observable iff there are no unobservable states.
 
\begin_inset Newline newline
\end_inset


\series bold
Proof:
\series default
 
\series medium
For necessity, assume there exists an unobservable state and show that this
 destroys observability.
\end_layout

\begin_layout Standard
Unobservable state 
\begin_inset Formula $\bar{x}^{*}\neq\bar{0}$
\end_inset

.
\end_layout

\begin_layout Standard
For any initial state 
\begin_inset Formula $\bar{x}\left(0\right)$
\end_inset

 our zero input history 
\begin_inset Formula $\bar{y}=Ce^{At}\bar{x}\mbox{\left(0\right)}$
\end_inset

 is indistinguishable from 
\begin_inset Formula $\bar{y}=Ce^{At}\left(\bar{x}\left(0\right)+\alpha\bar{x}^{*}\right)$
\end_inset

.
 This means 
\begin_inset Formula $\bar{y}(t)$
\end_inset

 cannot be used to uniquely determine 
\begin_inset Formula $\bar{x}\left(0\right)\ \rightarrow$
\end_inset

 system is unobservable.
\end_layout

\begin_layout Standard
For sufficiency 
\begin_inset Formula $\rightarrow$
\end_inset

 assume there are no unobservable state and show that this implies that
 the system is observable.
 Start with 
\begin_inset Formula $\bar{y}=Ce^{At}\bar{x}\left(0\right)$
\end_inset

 
\begin_inset Formula $\bar{x}\left(0\right)\neq\bar{0}$
\end_inset

.
 Premultiply both sides by 
\begin_inset Formula $\left(Ce^{At}\right)^{T}$
\end_inset


\begin_inset Formula \begin{eqnarray*}
\left(Ce^{At}\right)^{T}\bar{y} & = & \left(Ce^{At}\right)^{T}Ce^{At}\bar{x}\left(0\right)\\
\int_{0}^{T}\,\left(Ce^{At}\right)^{T}\bar{y}\, dt & = & m\left(T\right)\bar{x}\left(0\right)\\
m\left(T\right) & = & \int_{0}^{T}\,\left(Ce^{At}\right)^{T}Ce^{At}\, dt\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $m\left(T\right)$
\end_inset

 is symmetric since it is a product of a matrix and its transpose.
 We can show that 
\begin_inset Formula $m\left(T\right)$
\end_inset

 is positve definite
\end_layout

\begin_layout Itemize
The integrand is a non-negative quantity 
\begin_inset Formula $\int_{0}^{T}\,\left\Vert Ce^{At}\bar{x}\left(0\right)\right\Vert ^{2}dt$
\end_inset


\end_layout

\begin_layout Itemize
The quantity is only zero if the integrand is zero over the entire interval
 
\begin_inset Formula $[0,T)\ \rightarrow\ Ce^{At}\bar{x}\left(0\right)=\bar{0}$
\end_inset

 
\begin_inset Formula $\forall t\in\left[0,T\right]$
\end_inset

.
\end_layout

\begin_layout Standard
We assumed no onobservable states
\begin_inset Formula \[
\bar{x}^{T}\left(0\right)m\left(T\right)\bar{x}\left(0\right)>0\]

\end_inset

 
\begin_inset Formula $m\left(T\right)$
\end_inset

 is thus positive definite.
\end_layout

\begin_layout Standard
\begin_inset Formula $m\left(T\right)$
\end_inset

 is invertible
\begin_inset Formula \begin{eqnarray*}
\int_{0}^{T}\,\left(Ce^{At}\right)^{T}\bar{y}\, dt & = & m\left(T\right)\bar{x}\left(0\right)\\
\bar{x}\left(0\right) & = & m^{-1}\left(T\right)\int_{0}^{T}\,\left(Ce^{At}\right)^{T}\bar{y}\, dt\end{eqnarray*}

\end_inset

we can determine 
\begin_inset Formula $\bar{x}\left(0\right)$
\end_inset

 uniquely and our system is observable.
\end_layout

\begin_layout Subsubsection
Cayley-Hamilton Theorem
\end_layout

\begin_layout Standard
Every matrix 
\begin_inset Formula $A$
\end_inset

 statisfies its own characteristic equation
\begin_inset Formula \begin{eqnarray*}
\det\left[\lambda I-A\right] & = & 0\ \rightarrow\ \underbrace{\lambda^{N}+a_{1}\lambda^{N-1}+\dots a_{N}=0}_{\text{characteristic equation}}\\
A^{N}+a_{N-1}A^{N-1}+\dots a_{1}A+c_{0}I & = & \left[0\right]\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Diagonalizable matrix 
\begin_inset Formula $A\ \rightarrow\ T^{-1}AT=\Lambda$
\end_inset

, 
\begin_inset Formula $A=T\Lambda T^{-1}$
\end_inset


\begin_inset Formula \begin{eqnarray*}
 & = & T\underbrace{\left(\Lambda^{N}+a_{N-1}\Lambda^{N-1}+\dots a_{1}\Lambda+a_{0}I\right)}_{\left[0\right]}T^{-1}\\
 & = & T\left[0\right]T^{-1}=\left[0\right]\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Consequence: Any power of 
\begin_inset Formula $A^{k}$
\end_inset

 for 
\begin_inset Formula $k>N-1$
\end_inset

 can be written as a linear combination of terms 
\begin_inset Formula $A^{i}$
\end_inset

, 
\begin_inset Formula $i\leq N-1$
\end_inset


\end_layout

\begin_layout Subsection
Observability Tests
\end_layout

\begin_layout Itemize
Observability grammian
\end_layout

\begin_layout Itemize
Observability matrix rank condition
\end_layout

\begin_layout Subsubsection
Observability Grammian
\end_layout

\begin_layout Standard
\begin_inset Formula \[
w_{0}=\int_{0}^{T}\, e^{A^{T}t}C^{T}Ce^{At}\, dt\text{ is the obs grammian}\]

\end_inset


\end_layout

\begin_layout Standard
A system is observable if 
\begin_inset Formula $w_{0}$
\end_inset

 is invertible (not singular)
\end_layout

\begin_layout Subsubsection
Observability Rank Condition
\end_layout

\begin_layout Standard
Theorem: 
\series medium
A vector 
\begin_inset Formula $\bar{x}^{*}$
\end_inset

 is unobservable iff 
\begin_inset Formula $O\left(C,A\right)\bar{x}^{*}=\bar{0}$
\end_inset

 where
\begin_inset Formula \begin{eqnarray*}
O\left(C,A\right) & = & \left.\left[\begin{array}{c}
C\\
CA\\
CA^{2}\\
\vdots\\
CA^{N-1}\end{array}\right]\right\} NPxN\\
\\C: &  & PxN\\
A: &  & NxN\\
CA^{i}: &  & PxN\end{eqnarray*}

\end_inset


\series bold
Proof:
\series medium
 
\begin_inset Quotes eld
\end_inset

only if
\begin_inset Quotes erd
\end_inset

 
\begin_inset Formula $\rightarrow$
\end_inset

 show that 
\begin_inset Formula $O\left(C,A\right)\bar{x}^{*}=\bar{0}$
\end_inset

 is necessary for 
\begin_inset Formula $\bar{x}^{*}$
\end_inset

 to be unobservable.
 Assume 
\begin_inset Formula $\bar{x}^{*}$
\end_inset

 is unobservable
\begin_inset Formula \[
Ce^{At}\bar{x}^{*}=\bar{0}\ t\geq0\]

\end_inset


\end_layout

\begin_layout Standard
Because 
\begin_inset Formula $Ce^{At}\bar{x}^{*}$
\end_inset

 is analytic then all derivatives of 
\begin_inset Formula $Ce^{At}\bar{x}^{*}$
\end_inset

 must also equal zero.
\begin_inset Formula \[
Ce^{At}\bar{x}^{*}=\bar{0}\ \rightarrow Ce^{A0}\bar{x}^{*}=0=C\bar{x}^{*}\]

\end_inset


\begin_inset Formula \[
\left.\frac{d}{dt}\left(Ce^{At}\bar{x}^{*}\right)\right|_{t=0}=\bar{0}=Ce^{A0}\bar{x}^{*}=CA\bar{x}^{*}\]

\end_inset


\begin_inset Formula \[
\frac{d^{k}}{dt^{k}}\left(Ce^{At}\bar{x}^{*}\right)=\bar{0}=CA^{k}\bar{x}^{*}\]

\end_inset

which is exactly 
\begin_inset Formula $O\left(C,A\right)\bar{x}^{*}=\bar{0}$
\end_inset

.
\end_layout

\begin_layout Standard
For sufficincy, assume that there is an 
\begin_inset Formula $\bar{x}^{*}\neq0$
\end_inset

 that satisfies 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none

\begin_inset Formula $O\left(C,A\right)\bar{x}^{*}=\bar{0}$
\end_inset


\begin_inset Formula \[
C\bar{x}^{*}=CA\bar{x}^{*}=\dots=CA^{N-1}\bar{x}^{*}=\bar{0}\]

\end_inset


\end_layout

\begin_layout Standard
Recall (Cayley-Hamilton)
\begin_inset Formula \[
A^{n}=-a_{n-1}A^{n-1}+\dots-a_{1}A-a_{0}I\]

\end_inset


\begin_inset Formula \[
CA^{n}\bar{x}^{*}=\bar{0}\]

\end_inset


\begin_inset Formula \[
CA^{k}\bar{x}^{*}\ \text{for }k\geq n\]

\end_inset


\end_layout

\begin_layout Standard
For our matrix exponential
\begin_inset Formula \begin{eqnarray*}
Ce^{At} & = & C+CAt+\frac{CA^{2}}{2!}t^{2}+\dots\\
Ce^{At}\bar{x}^{*} & = & C\bar{x}^{*}+CA\bar{x}^{*}t+\frac{CA^{2}}{2!}\bar{x}^{*}t^{2}+\dots\\
\\Ce^{At}\bar{x}^{*} & = & \bar{0}\ \rightarrow\ \text{definition of an unobservable state}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
A LTI system is unobservable iff the observabilty matrix is full rank
\begin_inset Formula \begin{eqnarray*}
 &  & \left[\begin{array}{c}
C\\
CA\\
CA^{2}\\
\vdots\\
CA^{N-1}\end{array}\right]\\
C: &  & PxN\\
A: &  & NxN\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Rank 
\begin_inset Formula $O\left(C,A\right)=N$
\end_inset


\end_layout

\begin_layout Subsubsection
Example
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \left[\begin{array}{cc}
-2 & 0\\
0 & -1\end{array}\right]\bar{x}+\left[\begin{array}{c}
2\\
1\end{array}\right]\bar{u}\\
\bar{y} & = & \left[\begin{array}{cc}
3 & 0\end{array}\right]\bar{x}\end{eqnarray*}

\end_inset


\begin_inset Formula \[
O=\left[\begin{array}{c}
C\\
CA\end{array}\right]=\left[\begin{array}{c}
\begin{array}{cc}
3 & 0\end{array}\\
\left[\begin{array}{cc}
3 & 0\end{array}\right]\left[\begin{array}{cc}
-2 & 0\\
0 & -1\end{array}\right]\end{array}\right]=\left[\begin{array}{cc}
3 & 0\\
-6 & 0\end{array}\right]\]

\end_inset


\end_layout

\begin_layout Standard
Rank 
\begin_inset Formula $O\left(C,A\right)=1$
\end_inset

.
 
\begin_inset Formula $O\left(C,A\right)\bar{x}^{*}=\bar{0}$
\end_inset

, 
\begin_inset Formula $\bar{x}^{*}=\left[\begin{array}{c}
0\\
1\end{array}\right]$
\end_inset


\begin_inset Formula \[
\left[\begin{array}{cc}
3 & 0\\
-6 & 0\end{array}\right]\left[\begin{array}{c}
0\\
1\end{array}\right]=\left[\begin{array}{c}
0\\
0\end{array}\right]\checkmark\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $\bar{x}^{*}=\left[\begin{array}{c}
0\\
1\end{array}\right]$
\end_inset

 is an unobservable vector.
\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
10/20/2010 (exam ends at observability/dectability - before realizations)
\end_layout

\begin_layout Itemize
Modal test for observabilty 
\end_layout

\begin_deeper
\begin_layout Itemize
Distinct eigenvalues
\end_layout

\begin_layout Itemize
Repeated eigenvalues
\end_layout

\end_deeper
\begin_layout Itemize
Detectability
\end_layout

\begin_layout Itemize
Realizations
\end_layout

\begin_deeper
\begin_layout Itemize
Canonical state forms
\end_layout

\end_deeper
\begin_layout Subsection
Modal Test for Observabilty
\end_layout

\begin_layout Standard
Assume that 
\begin_inset Formula $A$
\end_inset

 has 
\begin_inset Formula $N$
\end_inset

 distinct eigenvalues 
\begin_inset Formula $\lambda_{i}$
\end_inset

 with associated eigenvectors 
\begin_inset Formula $\bar{v}_{i}$
\end_inset

 we can form 
\begin_inset Formula $T=\left[\bar{v}_{1},\dots\bar{v}_{N}\right]$
\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Formula \[
T^{-1}AT=\Lambda=\left[\begin{array}{ccc}
\lambda_{1} & 0 & 0\\
0 & \ddots & 0\\
0 & 0 & \lambda_{N}\end{array}\right]\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
x & = & Tz\\
\\\dot{\bar{z}} & = & \Lambda\bar{z}+T^{-1}B\bar{u}\\
\bar{y} & = & CT\bar{z}+D\bar{u}\end{eqnarray*}

\end_inset

Our rank condition becomes:
\begin_inset Formula \[
\text{Rank }O(\Lambda,CT)=\left[\begin{array}{c}
CT\\
CT\Lambda\\
\vdots\\
CT\Lambda^{N-1}\end{array}\right]=N\]

\end_inset


\end_layout

\begin_layout Standard
Suppose there exists an eigenvector 
\begin_inset Formula $\bar{v}_{i}$
\end_inset

 which is orthogonal to every row of 
\begin_inset Formula $C$
\end_inset

.
 In this case, the 
\begin_inset Formula $i^{th}$
\end_inset

 column of 
\begin_inset Formula $CT$
\end_inset

 will contain only zeros.
 Since 
\begin_inset Formula $\Lambda^{i}$
\end_inset

 is diagonal, then the 
\begin_inset Formula $i^{th}$
\end_inset

 column of 
\begin_inset Formula $O\left(\Lambda,CT\right)$
\end_inset

 will only contain zeros.
 The observability matrix coannot have full rank, system is unobservable.
\end_layout

\begin_layout Subsubsection
Theorem:
\end_layout

\begin_layout Standard
A LTI system is unobservable, iff there exists an eigenvector 
\begin_inset Formula $\bar{v}_{i}$
\end_inset

 of 
\begin_inset Formula $A$
\end_inset

 such that 
\begin_inset Formula $C\bar{v}_{i}=\bar{0}$
\end_inset

.
 In our transformed system, columns of 
\begin_inset Formula $\tilde{C}=CT$
\end_inset

 that contain all zeros are associated with unobservable modes
\end_layout

\begin_layout Subsubsection
Repeated Eigenvalues
\end_layout

\begin_layout Standard
The LTI system is observable if the elements of any column of 
\begin_inset Formula $\tilde{C}$
\end_inset

 that correspond to the first row of each Jordan block are not all zeros
 and the elements of 
\begin_inset Formula $\tilde{C}$
\end_inset

 that correspond to distinct eigenvalues are not all zeros.
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \left[\begin{array}{ccc}
\textbf{2} & \textbf{1} & \textbf{0}\\
0 & 2 & 1\\
0 & 0 & 2\end{array}\right]\bar{x}\\
\\\bar{y} & = & \left[\begin{array}{ccc}
\textbf{3} & 0 & 0\\
\textbf{4} & 0 & 0\end{array}\right]\bar{x}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsubsection
Example:
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \left[\begin{array}{cc}
-\frac{3}{2} & \frac{1}{2}\\
\frac{1}{2} & -\frac{3}{2}\end{array}\right]\bar{x}+\left[\begin{array}{c}
\frac{1}{2}\\
\frac{1}{2}\end{array}\right]\bar{u}\\
\bar{y} & = & \left[\begin{array}{cc}
1 & -1\end{array}\right]\bar{x}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Eigenvalues:
\begin_inset Formula \[
\det\left[\lambda\left[I\right]-\left[A\right]\right]=0\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
\det\left[\begin{array}{cc}
\lambda+\frac{3}{2} & -\frac{1}{2}\\
-\frac{1}{2} & \lambda+\frac{3}{2}\end{array}\right] & = & 0\\
\lambda^{2}+3\lambda++2 & = & 0\\
\\\lambda & = & -1,-2\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\lambda_{1}=-1:\\
\\\left[\begin{array}{cc}
\frac{1}{2} & -\frac{1}{2}\\
-\frac{1}{2} & \frac{1}{2}\end{array}\right]\bar{v}_{1} & = & \bar{0}\\
\\\bar{v}_{1} & = & \left[\begin{array}{c}
1\\
1\end{array}\right]\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\lambda_{2}=-2:\\
\\\left[\begin{array}{cc}
-\frac{1}{2} & -\frac{1}{2}\\
-\frac{1}{2} & -\frac{1}{2}\end{array}\right]\bar{v}_{2} & = & \bar{0}\\
\\\bar{v}_{2} & = & \left[\begin{array}{c}
1\\
-1\end{array}\right]\end{eqnarray*}

\end_inset


\begin_inset Formula \[
T=\left[\begin{array}{cc}
1 & 1\\
1 & -1\end{array}\right]\]

\end_inset


\begin_inset Formula \[
\tilde{C}=CT=\left[\begin{array}{cc}
1 & -1\end{array}\right]\left[\begin{array}{cc}
1 & 1\\
1 & -1\end{array}\right]=\underbrace{\left[\begin{array}{cc}
0 & 2\end{array}\right]}_{1^{st}\text{ mode is unobservable}}\]

\end_inset


\end_layout

\begin_layout Subsection
Detectability:
\end_layout

\begin_layout Itemize
Is a weaker form of observability
\end_layout

\begin_layout Subsubsection
Definition:
\end_layout

\begin_layout Standard
The LTI system 
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}+B\bar{u}\\
\bar{y} & = & C\bar{x}+D\bar{u}\end{eqnarray*}

\end_inset

is detectable if there exists a gain matrix 
\begin_inset Formula $G$
\end_inset

 such that 
\begin_inset Formula $A-GC$
\end_inset

 is stable.
\end_layout

\begin_layout Subsubsection
Theorem
\end_layout

\begin_layout Standard
The LTI system is detectable if for every right eigenvector 
\begin_inset Formula $\bar{v_{i}}$
\end_inset

 for which 
\begin_inset Formula $C\bar{v}_{i}=\bar{0}$
\end_inset

 the corresponding eigenvalue is stable.
 All unobservable modes are stable.
\end_layout

\begin_layout Subsection
Realizations
\end_layout

\begin_layout Standard
A realization is a state space model that is derived (realized) from some
 input-output model.
\end_layout

\begin_layout Subsubsection
Definition 1
\end_layout

\begin_layout Standard
A state space model is a realization of 
\begin_inset Formula $H(s)$
\end_inset

 if 
\begin_inset Formula $C\left(sI-A\right)^{-1}B+D=H(s)$
\end_inset

.
\end_layout

\begin_layout Itemize
Realizations are not unique.
\end_layout

\begin_layout Subsubsection
Definition 2
\end_layout

\begin_layout Standard
A realizaion of a matrix transformation is minimal if there exists no realizatio
n of lesser order whose transfer function matrix is 
\begin_inset Formula $H(s)$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Example
\end_layout

\begin_layout Standard
SISO system
\begin_inset Formula \[
\frac{Y(s)}{U(s)}=H(s)=\frac{b_{n}s^{n}+b_{n-1}s^{n-1}+\dots b_{1}s+b_{0}}{s^{n}+a_{n-1}s^{n-1}+\dots a_{1}s+a_{0}}\]

\end_inset


\begin_inset Formula \[
\frac{d^{n}y}{dt^{n}}+a_{n-1}\frac{d^{n-1}y}{dt^{n-1}}+\dots a_{1}\frac{dy}{dt}+a_{0}y=b_{n}\frac{d^{n}u}{dt^{n}}+\dots b_{1}\frac{du}{dt}+b_{0}u\]

\end_inset

No fewer than 
\begin_inset Formula $n$
\end_inset

 states.
\end_layout

\begin_layout Standard
Systems with 
\begin_inset Formula $n$
\end_inset

 states minimal realization
\end_layout

\begin_layout Itemize
Minimal realizations are not unique due to similarity transformations
\end_layout

\begin_layout Subsubsection
Properties of Similarity Transformations
\end_layout

\begin_layout Itemize
Preserve the system transfer function.
\end_layout

\begin_layout Itemize
Preserve the characteristic equation and values.
\end_layout

\begin_layout Itemize
Preserve unobservable and uncontrollable modes.
\end_layout

\begin_layout Subsubsection
Theorem
\end_layout

\begin_layout Standard
A relization is minimal iff it is controllable and observable.
\end_layout

\begin_layout Subsubsection
Canonical State Space Forms
\end_layout

\begin_layout Enumerate
Controllable cononical form consider 
\begin_inset Formula $A$
\end_inset

 siso system represented by a strictly proper transfer function
\begin_inset Formula \begin{eqnarray*}
\frac{Y(s)}{U(s)} & = & H(s)=C\left(sI-A\right)^{-1}B\\
 & = & \frac{b_{n}s^{n}+b_{n-1}s^{n-1}+\dots b_{1}s+b_{0}}{s^{n}+a_{n-1}s^{n-1}+\dots a_{1}s+a_{0}}\end{eqnarray*}

\end_inset

One realization of this transfer function is
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{z}} & = & A_{c}\bar{z}+B_{c}\bar{u}\\
\bar{y} & = & C_{c}\bar{z}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
A_{c} & = & \left[\begin{array}{ccccc}
0 & 1 & 0 & \dots & 0\\
0 & 0 & 1 & \dots & 0\\
\vdots\\
-a_{0} & -a_{1} & -a_{2} & \dots & -a_{n-1}\end{array}\right]\\
\\B_{c} & = & \left[\begin{array}{c}
0\\
0\\
\vdots\\
1\end{array}\right]\\
\\C_{c} & = & \left[\begin{array}{cccc}
b_{0} & b_{1} & \dots & b_{n-1}\end{array}\right]\end{eqnarray*}

\end_inset

In this form, the controllability matrix 
\begin_inset Formula $\mathcal{C}\left(A_{c},B_{c}\right)$
\end_inset

 takes a special, lower-right triangular form which ensures that 
\begin_inset Formula $\mathcal{C}$
\end_inset

 is full rank.
\end_layout

\begin_deeper
\begin_layout Itemize
System must be completely controllable to be put in this form.
\end_layout

\begin_layout Itemize
Extensions exist for mimo systems
\end_layout

\begin_deeper
\begin_layout Itemize
Check linear system theory textbooks for details.
\end_layout

\end_deeper
\begin_layout Standard
The transformation 
\begin_inset Formula $\bar{z}=T\bar{x}$
\end_inset

 that achieves this form is:
\begin_inset Formula \begin{eqnarray*}
T^{-1}\dot{\bar{z}} & = & AT^{-1}\bar{z}+B\bar{u}\\
\bar{y} & = & CT^{-1}\bar{z}+D\bar{u}\\
\\\dot{\bar{z}} & = & TAT^{-1}\bar{z}+TB\bar{u}\end{eqnarray*}

\end_inset


\begin_inset Formula \[
\boxed{T=\mathcal{C}\left(\underbrace{TAT^{-1}}_{A_{C}},\underbrace{TB}_{B_{c}}\right)\mathcal{C}\left(A,B\right)}\]

\end_inset


\end_layout

\end_deeper
\begin_layout Subsubsection
Example
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
A & = & \left[\begin{array}{ccc}
1 & 2 & 4\\
0 & 1 & 0\\
3 & 4 & 5\end{array}\right]\\
\\B & = & \left[\begin{array}{c}
1\\
1\\
1\end{array}\right]\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Get 
\begin_inset Formula $A_{c}$
\end_inset

 from characteristic eq.
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
A & = & \left[\begin{array}{ccc}
0 & 1 & 0\\
0 & 0 & 1\\
-1 & 1 & 7\end{array}\right]\\
\\B & = & \left[\begin{array}{c}
0\\
0\\
1\end{array}\right]\end{eqnarray*}

\end_inset


\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
10/15/2010
\end_layout

\begin_layout Itemize
Observable Canonical form
\end_layout

\begin_layout Itemize
Canonical decompositions
\end_layout

\begin_deeper
\begin_layout Itemize
Controllability
\end_layout

\begin_layout Itemize
Observability
\end_layout

\begin_layout Itemize
Combined
\end_layout

\end_deeper
\begin_layout Itemize
Full state feedback control
\end_layout

\begin_deeper
\begin_layout Itemize
Pole placement
\end_layout

\end_deeper
\begin_layout Subsection
Observable Canonical Form
\end_layout

\begin_layout Standard
Consider SISO system represented by 
\begin_inset Formula \[
H(s)=\frac{Y(s)}{U(s)}=\frac{b_{n-1}s^{n-1}+\dots b_{1}s+b_{0}}{s^{n}+a_{n-1}s^{n-1}+\dots a_{1}s+a_{0}}\]

\end_inset

and there realization of this transfer function:
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{z}} & = & A_{o}\bar{z}+B_{o}\bar{u}\\
\bar{y} & = & C_{o}\bar{z}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
A_{o} & = & \left[\begin{array}{ccccc}
-a_{n-1} & 1 & 0 & \dots & 0\\
-a_{n-2} & 0 & 1 & \dots & 0\\
\vdots\\
-a_{0} & 0 & -0 & \dots & -0\end{array}\right]\\
\\B_{o} & = & \left[\begin{array}{c}
b_{n-1}\\
b_{n-2}\\
\vdots\\
b_{0}\end{array}\right]\\
\\C_{o} & = & \left[\begin{array}{cccc}
1 & 0 & \dots & 0\end{array}\right]\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
System must be completely observable to be put in this form.
\end_layout

\begin_layout Itemize
Resulting observability matrix in this form must have full rank.
\end_layout

\begin_layout Standard
The transformation 
\begin_inset Formula $\bar{z}=T\bar{x}$
\end_inset

 that achieves this form
\begin_inset Formula \[
T=\mathcal{O}\left(A_{o},C_{o}\right)^{-1}\mathcal{O}\left(A,C\right)\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}+B\bar{u}\\
\bar{y} & = & C\bar{x}+D\bar{u}\\
\\\det\left[\lambda I-A\right] & = & 0\\
\lambda^{n}+a_{n-1}\lambda^{n-1}+\dots a_{1}\lambda+a_{0} & = & 0\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsection
Canonical Decompositions
\end_layout

\begin_layout Standard
Enable easy identification of controllable and/or observable modes.
\end_layout

\begin_layout Subsubsection
Controllability canonical decompositions
\end_layout

\begin_layout Standard
Given N-dimensional system
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}+B\bar{u}\\
\bar{y} & = & C\bar{x}+D\bar{u}\\
\\\text{Rank }\mathcal{C} & = & n_{1}<n\end{eqnarray*}

\end_inset

There exists a transformation 
\begin_inset Formula $\bar{z}=T\bar{x}$
\end_inset

 such that transformed system
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{z}} & = & \hat{A}\bar{z}+\hat{B}\bar{u}\\
\bar{y} & = & \hat{C}\bar{z}+\hat{D}\bar{u}\end{eqnarray*}

\end_inset


\begin_inset Formula \[
\hat{A}=\left[\begin{array}{ccc}
\hat{A}_{c} & \vdots & \hat{A}_{12}\\
\dots &  & \dots\\
0 & \vdots & \hat{A}_{nc}\end{array}\right]\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
\hat{B} & = & \left[\begin{array}{c}
\hat{B}_{c}\\
\dots\\
0\end{array}\right]\\
\hat{C} & = & \left[\begin{array}{ccc}
\hat{C}_{c} & \vdots & \hat{C}_{nc}\end{array}\right]\\
\hat{D} & = & D\end{eqnarray*}

\end_inset

In this form, the subsystem defined by 
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{z}}_{c} & = & \hat{A}_{c}\bar{z}+\hat{B}_{c}\bar{u}\\
\bar{y} & = & \hat{C}_{c}\bar{z}+\hat{D}_{c}\bar{u}\end{eqnarray*}

\end_inset

is controllable and has the same transferfunctionas the origianl system.
 The required transformation:
\begin_inset Formula \[
T=\left[\underbrace{\begin{array}{ccc}
T_{!} & \dots & T_{n_{1}}\end{array}}_{\text{Linearly independent colums from }\mathcal{C}}\begin{array}{c}
\vdots\end{array}\underbrace{\begin{array}{ccc}
T_{n_{1}+1} & \dots & T_{n}\end{array}}_{\text{Any }\begin{array}{ccc}
T_{n_{1}+1} & \dots & T_{n}\end{array}\text{ such that }T\text{ is full rank}}\right]^{-1}\]

\end_inset


\end_layout

\begin_layout Subsubsection
Observability canonical decomposition
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}+B\bar{u}\\
\bar{y} & = & C\bar{x}+D\bar{u}\\
\\\text{Rank }\mathcal{C} & = & n_{2}<n\end{eqnarray*}

\end_inset

We can find a transformation 
\begin_inset Formula $\bar{z}=T\bar{x}$
\end_inset

 such that our transformed system 
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{z}} & = & \hat{A}\bar{z}+\hat{B}\bar{u}\\
\bar{y} & = & \hat{C}\bar{z}+\hat{D}\bar{u}\end{eqnarray*}

\end_inset

where
\begin_inset Formula \[
\hat{A}=\left[\begin{array}{ccc}
\hat{A}_{o} & \vdots & 0\\
\dots &  & \dots\\
\hat{A}_{21} & \vdots & \hat{A}_{no}\end{array}\right]\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
\hat{B} & = & \left[\begin{array}{c}
\hat{B}_{0}\\
\dots\\
\hat{B}_{no}\end{array}\right]\\
\hat{C} & = & \left[\begin{array}{ccc}
\hat{C}_{o} & \vdots & 0\end{array}\right]\\
\hat{D} & = & D\end{eqnarray*}

\end_inset

The subsystem defined by 
\begin_inset Formula $\hat{A}_{o}$
\end_inset

, 
\begin_inset Formula $\hat{B}_{o}$
\end_inset

, 
\begin_inset Formula $\hat{C}_{o}$
\end_inset

 and 
\begin_inset Formula $\hat{D}$
\end_inset

 is observable and has the same transfer function as our origianl system.
 The transformation that achieves this form
\begin_inset Formula \[
T=\left[\begin{array}{cc}
\left.\begin{array}{c}
T_{!}\\
T_{2}\\
\vdots\\
T_{n_{2}}\end{array}\right\}  & n_{2}\text{ Linearly independent rows from }\mathcal{O}\\
\dots\\
\left.\begin{array}{c}
T_{n_{2}+!}\\
\vdots\\
T_{n}\end{array}\right\}  & \text{Extra rows so that }T\text{ is full rank}\end{array}\right]\]

\end_inset


\end_layout

\begin_layout Subsubsection
Extraction of controllable and observable subsystem
\end_layout

\begin_layout Enumerate
Transform the origianl system 
\begin_inset Formula $\left(A,B,C,D\right)$
\end_inset

 by 
\begin_inset Formula $T_{c}$
\end_inset

 to obtain control canonical decomposition
\begin_inset Formula \[
\left(T_{c}AT_{c}^{-1},T_{c}B,CT_{c}^{-1},D\right)=\left(\hat{A},\hat{B},\hat{C},\hat{D}\right)\]

\end_inset


\end_layout

\begin_layout Enumerate
Make another transformation
\begin_inset Formula \[
T^{*}=\left[\begin{array}{ccc}
T_{o} & \vdots & 0\\
\dots &  & \dots\\
0 & \vdots & I\end{array}\right]\]

\end_inset

where 
\begin_inset Formula $T_{o}$
\end_inset

 is computed from the observability matrix formed from 
\begin_inset Formula $\hat{A}_{c}$
\end_inset

, 
\begin_inset Formula $\hat{C}_{c}$
\end_inset

.
 This results in a system
\begin_inset Formula \[
A_{f}=\left[\begin{array}{ccccc}
\hat{A}_{co} & \vdots & 0 & \vdots\\
\dots &  & \dots & \vdots & T_{o}\hat{A}_{12}\\
A_{f_{1}} & \vdots & A_{cno} & \vdots\\
\dots & \dots & \dots & \vdots & \dots\\
 & 0 &  & \vdots & \hat{A}_{no}\end{array}\right]\]

\end_inset


\begin_inset Formula \[
B_{f}=\left[\begin{array}{c}
B_{co}\\
\dots\\
B_{cno}\\
\dots\\
0\end{array}\right]\]

\end_inset


\begin_inset Formula \[
C_{f}=\left[\begin{array}{ccccc}
C_{co} & \vdots & 0 & \vdots & C_{nc}\end{array}\right]\]

\end_inset

The observable and controllable subsystem is defined by 
\begin_inset Formula $\left(A_{co},B_{co},C_{co},D_{co}\right)$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Example
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \left[\begin{array}{cc}
1 & 2\\
2 & 1\end{array}\right]\bar{x}+\left[\begin{array}{c}
1\\
1\end{array}\right]\bar{u}\\
\bar{y} & = & \left[\begin{array}{cc}
1 & 1\end{array}\right]\bar{x}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard

\series bold
Find:
\series default
 Controllable canonical decomposition and observable canonical decomposition.
\end_layout

\begin_layout Paragraph
Controllable form
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\mathcal{C}=\left[\begin{array}{cc}
B & AB\end{array}\right] & = & \left[\begin{array}{c}
1\\
1\end{array}\left[\begin{array}{cc}
1 & 2\\
2 & 1\end{array}\right]\left[\begin{array}{c}
1\\
1\end{array}\right]\right]\\
 & = & \left[\begin{array}{cc}
1 & 3\\
1 & 3\end{array}\right]\end{eqnarray*}

\end_inset


\begin_inset Formula \[
T=\left[\begin{array}{cc}
1 & 1\\
1 & 0\end{array}\right]^{-1}=\left[\begin{array}{cc}
0 & 1\\
1 & -1\end{array}\right]\]

\end_inset

Transformed system:
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{z}} & = & TAT^{-1}\bar{z}+TB\bar{u}\\
\bar{y} & = & CT^{-1}\bar{z}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{\bar{z}} & = & \left[\begin{array}{ccc}
3 & \vdots & 2\\
\dots &  & \dots\\
0 & \vdots & \underbrace{-1}_{uncontrollable}\end{array}\right]\bar{z}+\left[\begin{array}{c}
1\\
0\end{array}\right]\bar{u}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Paragraph
Observable Form
\end_layout

\begin_layout Standard
(missing stuff get it from others)
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{z}} & = & T_{o}AT_{o}^{-1}\bar{z}+T_{o}B\bar{u}\\
\bar{y} & = & CT_{o}^{-1}\bar{z}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{\bar{z}} & = & \left[\begin{array}{ccc}
3 & \vdots & 2\\
\dots &  & \dots\\
0 & \vdots & \underbrace{-1}_{unobservable}\end{array}\right]\bar{z}+\left[\begin{array}{c}
2\\
1\end{array}\right]\bar{u}\\
y & = & \left[\begin{array}{cc}
1 & 0\end{array}\right]\bar{z}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsection
Quick Review of Modal Form
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}+B\bar{u}\\
\bar{y} & = & C\bar{x}+D\bar{u}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Enumerate
Find eigenvalues and eigenvectors of 
\begin_inset Formula $A$
\end_inset


\begin_inset Formula \begin{eqnarray*}
\det\left[\lambda I-A\right] & = & 0\\
\left[\lambda_{i}I-A\right]\bar{v}_{i} & = & 0\end{eqnarray*}

\end_inset

if all distinct 
\begin_inset Formula $\lambda_{i}$
\end_inset

 form 
\begin_inset Formula $T=\left[\begin{array}{ccc}
\bar{v}_{1} & \dots & \bar{v}_{n}\end{array}\right]$
\end_inset

.
 Transform the system 
\begin_inset Formula $\bar{x}=T\bar{z}$
\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{\bar{z}} & = & TAT^{-1}\bar{z}+T^{-1}B\bar{u}\\
\bar{y} & = & CT\bar{z}+D\bar{u}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{\bar{z}} & = & \left[\begin{array}{ccc}
\lambda_{1} &  & 0\\
 & \ddots\\
0 &  & \lambda_{n}\end{array}\right]\bar{z}+\left[\begin{array}{c}
\tilde{b}_{1}\\
\vdots\\
\tilde{b}_{n}\end{array}\right]\bar{u}\\
\bar{y} & = & \left[\begin{array}{ccc}
\tilde{c}_{1} & \dots & \tilde{c}_{n}\end{array}\right]\bar{z}+D\bar{u}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Enumerate
If any row of 
\begin_inset Formula $\tilde{B}$
\end_inset

 is zero, that mode is uncontrollable 
\begin_inset Formula $\left(T^{-1}B\ \rightarrow\ \underbrace{\bar{w}_{i}^{T}B=\bar{0}}_{\text{def of uncontrollable mode}}\right)$
\end_inset


\end_layout

\begin_layout Enumerate
If any column of 
\begin_inset Formula $\tilde{C}$
\end_inset

 is zero, that mode is unobservable 
\begin_inset Formula $\left(CT\ \rightarrow\ \underbrace{C\bar{v}_{i}=0}_{\text{def of unobs. mode}}\right)$
\end_inset


\end_layout

\begin_layout Subsection
Full state feedback control
\end_layout

\begin_layout Standard
Assume (SISO)
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}+B\bar{u}\\
\bar{y} & = & C\bar{x}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
Methodology can be extended to MIMO systems.
\end_layout

\begin_layout Subsubsection

\series bold
Goal
\end_layout

\begin_layout Standard
Use input 
\begin_inset Formula $u(t)$
\end_inset

 to modify the eigenvaluse of 
\begin_inset Formula $A$
\end_inset

 (and therefore the system dynamics).
\end_layout

\begin_layout Standard
Assueme 
\begin_inset Formula $u=r-k\bar{x}$
\end_inset


\begin_inset Formula \begin{eqnarray*}
r & = & \text{refrence input}\\
k & = & \text{gain matrix }\mathbb{R}^{1xN}\left(mimo\ k\in\mathbb{R}^{MxN}\right)\end{eqnarray*}

\end_inset

If 
\begin_inset Formula $r=0\ \rightarrow$
\end_inset

regulator controller.
\end_layout

\begin_layout Standard
With this control
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}+B\left(r-k\bar{x}\right)=A\bar{x}+Br-Bk\bar{x}\\
 & = & \underbrace{\left(A-Bk\right)}_{A_{cl}}\bar{x}+Br\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsubsection
Objective
\end_layout

\begin_layout Standard
Pick 
\begin_inset Formula $k$
\end_inset

 so that our new 
\begin_inset Formula $A$
\end_inset

 matrix (
\begin_inset Formula $A_{cl}$
\end_inset

) has desired properties.
\end_layout

\begin_layout Itemize
All poles/eigenvalues of 
\begin_inset Formula $A_{cl}$
\end_inset

 stable.
\end_layout

\begin_layout Itemize
Put poles at desired locations.
\end_layout

\begin_layout Itemize
\begin_inset Formula $N$
\end_inset

 parameters in 
\begin_inset Formula $k$
\end_inset

 matrix, 
\begin_inset Formula $N$
\end_inset

 eigenvalues.
\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
11/1/2010
\end_layout

\begin_layout Itemize
Pole placement/Ackerman's formula
\end_layout

\begin_layout Itemize
Relationship to controlability
\end_layout

\begin_layout Itemize
Tracking performance/reference inputs
\end_layout

\begin_layout Subsection
Full state feedback control continued
\end_layout

\begin_layout Subsubsection
Example - pole placement
\end_layout

\begin_layout Standard
\begin_inset Formula \[
\dot{\bar{x}}=\begin{bmatrix}1 & 1\\
1 & 2\end{bmatrix}\bar{x}+\begin{bmatrix}1\\
0\end{bmatrix}u\]

\end_inset


\end_layout

\begin_layout Standard
For stability
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\det\left[\lambda I-A\right]=0 & = & \begin{bmatrix}\lambda-1 & -1\\
-1 & \lambda-2\end{bmatrix}=\lambda^{2}-3\lambda+2-1\\
0 & = & \lambda^{2}-3\lambda+1\end{eqnarray*}

\end_inset


\begin_inset Formula \[
Roots\left(\begin{bmatrix}1 & -3 & 1\end{bmatrix}\right)\rightarrow2.618,\,0.3826\]

\end_inset


\end_layout

\begin_layout Standard
Add 
\begin_inset Formula $u=-k\bar{x}$
\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \begin{bmatrix}1 & 1\\
1 & 2\end{bmatrix}\bar{x}-\begin{bmatrix}1\\
0\end{bmatrix}\begin{bmatrix}k_{1} & k_{2}\end{bmatrix}\bar{x}\\
 & = & \begin{bmatrix}1 & 1\\
1 & 2\end{bmatrix}\bar{x}-\begin{bmatrix}k_{1} & k_{2}\\
0 & 0\end{bmatrix}\bar{x}\\
 & = & \underbrace{\begin{bmatrix}1-k_{1} & 1-k_{2}\\
1 & 2\end{bmatrix}}_{A_{cl}}\bar{x}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Stability:
\begin_inset Formula \begin{eqnarray*}
\det\left[\lambda I-A_{cl}\right] & = & 0\\
\begin{bmatrix}\lambda-1+k_{1} & -1+k_{2}\\
-1 & \lambda-2\end{bmatrix} & = & 0\\
\left(\lambda-1+k_{1}\right)\left(\lambda-2\right)+\left(-1+k_{2}\right) & = & 0\\
\lambda^{2}+\underbrace{\left(-3+k_{1}\right)}\lambda+\underbrace{1-2k_{1}+k_{2}} & = & 0\end{eqnarray*}

\end_inset

By introducing 
\begin_inset Formula $u=-kx$
\end_inset

 we now have the freedom to modify the coefficients fo our characteristic
 equation such that the roots are any values we specify (NOTE: complex roots
 still have to appear as complex conjugates).
\end_layout

\begin_layout Standard
If we want 
\begin_inset Formula $\lambda_{1}=-5$
\end_inset

, 
\begin_inset Formula $\lambda_{2}=-6$
\end_inset

 set up desired characteristic equations:
\begin_inset Formula \[
\left(\lambda+5\right)\left(\lambda+6\right)=\lambda^{2}+11\lambda+30\]

\end_inset


\end_layout

\begin_layout Standard
Compare coefficients
\begin_inset Formula \begin{eqnarray*}
\lambda^{2}: &  & 1=1\\
\lambda^{1}: &  & 11=-3+k_{1}\rightarrow\underline{k_{1}=14}\\
\lambda^{0}: &  & 1-2k_{1}+k_{2}\end{eqnarray*}

\end_inset


\begin_inset Formula \[
29=-28+k_{2}\ \rightarrow\ \underline{k_{2}=57}\]

\end_inset


\end_layout

\begin_layout Itemize
In genearl, this type of technique is called pole placement.
\end_layout

\begin_layout Itemize
It is not always this easy, since we have to deal with controlablilty.
\end_layout

\begin_layout Subsubsection
Example
\end_layout

\begin_layout Standard
\begin_inset Formula \[
\dot{\bar{x}}=\begin{bmatrix}1 & 1\\
1 & 2\end{bmatrix}\bar{x}+\begin{bmatrix}1\\
0\end{bmatrix}u\]

\end_inset


\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $u=-k\bar{x}$
\end_inset


\begin_inset Formula \begin{eqnarray*}
A_{cl}=A-Bk & = & \begin{bmatrix}1 & 1\\
0 & 2\end{bmatrix}-\begin{bmatrix}1\\
0\end{bmatrix}\begin{bmatrix}k_{1} & k_{2}\end{bmatrix}\\
 & = & \begin{bmatrix}1-k_{1} & 1-k_{2}\\
0 & 2\end{bmatrix}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Look at eigenvalues of 
\begin_inset Formula $A_{cl}$
\end_inset


\begin_inset Formula \[
\det\begin{bmatrix}\lambda-1+k_{1} & -1+k_{2}\\
0 & \lambda-2\end{bmatrix}=\left(\lambda-2\right)\underbrace{\left(\lambda-1+k_{1}\right)}_{\text{sysetm is always unstable}}is=0\]

\end_inset


\end_layout

\begin_layout Standard
Examine with modal test
\begin_inset Formula \[
\text{For }A\rightarrow T=\begin{bmatrix}1 & 1\\
0 & 1\end{bmatrix},\ T^{-1}=\begin{bmatrix}1 & -1\\
0 & 1\end{bmatrix}\]

\end_inset


\end_layout

\begin_layout Standard
Transformed system:
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \begin{bmatrix}1 & 0\\
0 & 2\end{bmatrix}\bar{z}+T^{-1}Bu\\
 & = & \begin{bmatrix}1 & 0\\
\mathbf{0} & \mathbf{2}\end{bmatrix}\bar{z}+\begin{bmatrix}1\\
\mathbf{0}\end{bmatrix}u\end{eqnarray*}

\end_inset

Mode due to 
\begin_inset Formula $\lambda=2$
\end_inset

 is uncontrollable.
\end_layout

\begin_layout Subsection
Theorem: SISO pole placement
\end_layout

\begin_layout Standard
Given any 
\begin_inset Formula $n^{th}$
\end_inset

 order controllable SISO system defined by 
\begin_inset Formula $A$
\end_inset

, 
\begin_inset Formula $B$
\end_inset

 and any 
\begin_inset Formula $n^{th}$
\end_inset

 order real characteristic polynomial, there exists a vector 
\begin_inset Formula $k$
\end_inset

 of real-valued control gains such that the characteristic polynomial of
 
\begin_inset Formula $A-Bk$
\end_inset

 is that of the desired polynomial.
 
\begin_inset Formula $\rightarrow$
\end_inset

 if the system is controllable, all poles can be placed arbitrarily.
\end_layout

\begin_layout Subsubsection
Proof
\end_layout

\begin_layout Standard
\begin_inset Formula $A$
\end_inset

,
\begin_inset Formula $B$
\end_inset

 is controllable 
\begin_inset Formula $\rightarrow$
\end_inset

 there exists a transformation 
\begin_inset Formula $T$
\end_inset

 (
\begin_inset Formula $\bar{z}=T\bar{x}$
\end_inset

) such that the system is in control-canonical form.
\begin_inset Formula \[
A_{c}=\begin{bmatrix}0 & 1 & 0 & \dots & 0\\
0 & 0 & 1 & \dots & 0\\
\vdots &  &  &  & 1\\
-a_{0} & -a_{1} & -a_{2} & \dots & -a_{n-1}\end{bmatrix}\]

\end_inset


\begin_inset Formula \[
B_{c}=\begin{bmatrix}0\\
0\\
\vdots\\
1\end{bmatrix}\]

\end_inset


\begin_inset Formula $a_{0}\dots a_{n-1}$
\end_inset

 are coefficients of the characteristic polynomal associated with 
\begin_inset Formula $A$
\end_inset

.
 Transformed system:
\begin_inset Formula \[
\dot{\bar{z}}=A_{c}\bar{z}+B_{c}u\]

\end_inset

Let 
\begin_inset Formula $u=-\mathcal{K}\bar{z}$
\end_inset


\begin_inset Formula \[
\mathcal{K}=\begin{bmatrix}\mathcal{K}_{0} & \mathcal{K}_{1} & \dots & \mathcal{K}_{n-1}\end{bmatrix}\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{\bar{z}} & = & \left(A_{c}-B_{c}\mathcal{K}\right)\bar{z}\\
 & = & \begin{bmatrix}0 & 1 & 0 & \dots & 0\\
0 & 0 & 1 & \dots & 0\\
\vdots &  &  &  & 1\\
-\left(a_{0}+\mathcal{K}_{0}\right) & -\left(a_{1}+\mathcal{K}_{1}\right) & -\left(a_{2}+\mathcal{K}_{2}\right) & \dots & -\left(a_{n-1}+\mathcal{K}_{n-1}\right)\end{bmatrix}\bar{z}\end{eqnarray*}

\end_inset

Characteristic equation for closed-loop system:
\begin_inset Formula \[
\lambda^{N}+\left(a_{n-1}+\mathcal{K}_{n-1}\right)\lambda^{n-1}+\dots\left(a_{1}+\mathcal{K}_{1}\right)\lambda+\left(a_{0}+\mathcal{K}_{0}\right)=0\]

\end_inset


\end_layout

\begin_layout Standard

\series bold
Net result:
\series default
 All coefficients of characteristic polynomial can be modified via choice
 of 
\begin_inset Formula $\mathcal{K}_{i}$
\end_inset

.
\end_layout

\begin_layout Standard
To determine 
\begin_inset Formula $k$
\end_inset

 in the original coordiantes
\begin_inset Formula \[
\bar{z}=T\bar{x}\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
T\dot{\bar{x}} & = & A_{c}T\bar{x}+B_{c}\left(-\mathcal{K}T\bar{x}\right)\\
\dot{\bar{x}} & = & \underbrace{T^{-1}A_{c}T}_{A}\bar{x}+\underbrace{T^{-1}B_{c}}_{B}\left(-\mathcal{K}T\bar{x}\right)\end{eqnarray*}

\end_inset

Compareing with 
\begin_inset Formula $u=-k\bar{x}$
\end_inset

 
\begin_inset Formula $\rightarrow$
\end_inset

 
\begin_inset Formula $k=\mathcal{K}T$
\end_inset

 closed-loop eigenvalues remain the same, since they are invariant under
 similarity transformations.
\end_layout

\begin_layout Subsection
Ackermann's formula (SISO)
\end_layout

\begin_layout Standard
\begin_inset Formula \[
K=\begin{bmatrix}0 & 0 & \dots & 1\end{bmatrix}\mathcal{C}^{-1}\Phi_{d}\left(A\right)\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $\mathcal{C}=$
\end_inset

controllability matrix 
\begin_inset Formula $A$
\end_inset

, 
\begin_inset Formula $B$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Formula $\Phi_{d}\left(A\right)=$
\end_inset

Desired characteristics equation for closed loop poles evaluated at 
\begin_inset Formula $\lambda=A$
\end_inset


\begin_inset Formula \begin{eqnarray*}
\left(\lambda+1\right)\left(\lambda+2\right) & = & \lambda^{2}+3\lambda+2\\
\Phi_{d}\left(A\right) & = & A^{2}+3A+2I\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsubsection
Example
\begin_inset CommandInset label
LatexCommand label
name "sub:ExAckermann"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \[
\dot{\bar{x}}=\begin{bmatrix}1 & 1\\
1 & 2\end{bmatrix}\bar{x}+\begin{bmatrix}1\\
0\end{bmatrix}u\]

\end_inset

Want poles at -5 and -6.
 Desired characteristic equation:
\begin_inset Formula \[
\lambda^{2}+11\lambda+30=0\]

\end_inset


\end_layout

\begin_layout Standard
Ackermann's formula:
\begin_inset Formula \begin{eqnarray*}
\mathcal{C}\left(A,B\right)=\begin{bmatrix}B & AB\end{bmatrix} & = & \begin{bmatrix}\begin{matrix}1\\
0\end{matrix} & \begin{bmatrix}1 & 1\\
1 & 2\end{bmatrix}\begin{bmatrix}1\\
0\end{bmatrix}\end{bmatrix}\\
 & = & \begin{bmatrix}1 & 1\\
0 & 1\end{bmatrix}\end{eqnarray*}

\end_inset


\begin_inset Formula \[
\mathcal{C}^{-1}=\begin{bmatrix}1 & -1\\
0 & 1\end{bmatrix}\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
K & = & \begin{bmatrix}0 & 1\end{bmatrix}\begin{bmatrix}1 & -1\\
0 & 1\end{bmatrix}\left(\begin{bmatrix}1 & 1\\
1 & 2\end{bmatrix}^{2}+11\begin{bmatrix}1 & 1\\
1 & 2\end{bmatrix}+30I\right)\\
 & = & \begin{bmatrix}0 & 1\end{bmatrix}\begin{bmatrix}1 & -1\\
0 & 1\end{bmatrix}\begin{bmatrix}43 & 14\\
14 & 57\end{bmatrix}\\
 & = & \begin{bmatrix}0 & 1\end{bmatrix}\begin{bmatrix}29 & -43\\
14 & 57\end{bmatrix}\\
K & = & \begin{bmatrix}14 & 57\end{bmatrix}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsection
Tracking performance for constant reference inputs
\end_layout

\begin_layout Itemize
Previously, we have chosen 
\begin_inset Formula $k$
\end_inset

 primarily to affect system stability.
\end_layout

\begin_layout Itemize
How well will this formulation track a reference input?
\end_layout

\begin_layout Standard
For our system:
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}+Bu\\
y & = & C\bar{x}\\
\\u & = & r-k\bar{x}\end{eqnarray*}

\end_inset

For good tracking performance, want 
\begin_inset Formula $y(t)\approx r(t)$
\end_inset

 as 
\begin_inset Formula $t\rightarrow\infty$
\end_inset

.
 In frequency domain we can use final value theorem:
\begin_inset Formula \[
y\left(t\rightarrow\infty\right)=\lim_{s\rightarrow0}sY\left(s\right)\]

\end_inset


\end_layout

\begin_layout Standard
For good performance
\begin_inset Formula \[
sY\left(s\right)\approx sR\left(s\right)\text{ as }s\rightarrow0\]

\end_inset


\begin_inset Formula \[
\left.\frac{Y\left(s\right)}{R\left(s\right)}\right|_{s=0}\approx1\]

\end_inset


\end_layout

\begin_layout Subsubsection
Example
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \begin{bmatrix}1 & 1\\
1 & 2\end{bmatrix}\bar{x}+\begin{bmatrix}1\\
0\end{bmatrix}u\\
y & = & \begin{bmatrix}1 & 0\end{bmatrix}\bar{x}\end{eqnarray*}

\end_inset

Already found 
\begin_inset Formula $k=\begin{bmatrix}14 & 57\end{bmatrix}$
\end_inset

 in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:ExAckermann"

\end_inset

 that gave 
\begin_inset Formula $\lambda=-5,-6$
\end_inset


\begin_inset Formula \[
u=r-k\bar{x}\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \left(A-Bk\right)\bar{x}+B\bar{r}\\
y & = & C\bar{x}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
What happens if 
\begin_inset Formula $r=$
\end_inset

unit step?
\end_layout

\begin_layout Standard
This yields a transfer function:
\begin_inset Formula \begin{eqnarray*}
\frac{Y(s)}{R(s)} & = & C\left(sI-A_{cl}\right)^{-1}B\text{, with }A_{cl}=A-Bk\\
 & = & \begin{bmatrix}1 & 0\end{bmatrix}\begin{bmatrix}s+13 & 56\\
-1 & s-2\end{bmatrix}\begin{bmatrix}1\\
0\end{bmatrix}\\
 & = & \frac{s-2}{s^{2}+11s+30}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
If 
\begin_inset Formula $R(s)$
\end_inset

 is a unit step input 
\begin_inset Formula $R(s)=\frac{1}{s}$
\end_inset


\begin_inset Formula \[
Y(s)=\lim_{s\rightarrow0}\ s\,\frac{1}{s}\,\frac{s-2}{s^{2}+11s+30}=\frac{-2}{30}\ \rightarrow y\left(t\rightarrow\infty\right)\]

\end_inset

Even though our transient response might be good, tracking performance is
 quite poor.
\end_layout

\begin_layout Subsubsection
One solution
\end_layout

\begin_layout Standard
Scale reference input 
\begin_inset Formula $r(t)$
\end_inset

 so that 
\begin_inset Formula \[
u=\tilde{N}r-k\bar{x}\]

\end_inset

Thus:
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \left(A-Bk\right)\bar{x}+B\tilde{N}r\\
y & = & C\bar{x}\end{eqnarray*}

\end_inset


\begin_inset Formula \[
\frac{Y(s)}{R(s)}=C\left(sI-A\right)^{-1}B\tilde{N}\ \rightarrow\ \frac{\tilde{N}\left(s-2\right)}{s^{2}+11s+30}\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
11/3/2010
\end_layout

\begin_layout Itemize
Review exam
\end_layout

\begin_layout Itemize
Computing 
\begin_inset Formula $\tilde{N}$
\end_inset

 and examples
\end_layout

\begin_layout Subsection
Methodology for computing 
\begin_inset Formula $\tilde{N}$
\end_inset


\end_layout

\begin_layout Standard
For a unit step 
\begin_inset Formula $r(t)=r_{ss}1(t)$
\end_inset

 at steady state 
\begin_inset Formula $\dot{\bar{x}}=0$
\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}+B\bar{u}\\
y & = & C\bar{x}\\
\\\rightarrow\\
\bar{0} & = & A\bar{x}_{ss}+B\bar{u}_{ss}\\
y_{ss} & = & C\bar{x}_{ss}\end{eqnarray*}

\end_inset


\begin_inset Formula \[
\begin{bmatrix}A & B\\
C & 0\end{bmatrix}\begin{bmatrix}x_{ss}\\
u_{ss}\end{bmatrix}=\underbrace{\begin{bmatrix}0\\
r_{ss}\end{bmatrix}}_{\text{for good tracking }y_{ss}=r_{ss}}\]

\end_inset

Given 
\begin_inset Formula $A$
\end_inset

, 
\begin_inset Formula $B$
\end_inset

, 
\begin_inset Formula $C$
\end_inset

, and 
\begin_inset Formula $r_{ss}$
\end_inset

 we can solve for 
\begin_inset Formula $x_{ss}$
\end_inset

 and 
\begin_inset Formula $u_{ss}$
\end_inset

\SpecialChar \@.
 For scaling purposes, we define
\begin_inset Formula \[
x_{ss}\hat{=}N_{x}r_{ss}\ ,\ u_{ss}\hat{=}N_{u}r_{ss}\]

\end_inset


\end_layout

\begin_layout Standard
Our controller takes the form
\begin_inset Formula \begin{eqnarray*}
u & = & \tilde{N}r-k\left(x-x_{ss}\right)\\
 & = & \underbrace{\left(N_{u}+kN_{x}\right)}_{\tilde{N}=N_{u}+kN_{x}}r_{ss}-kx\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsubsection
Example
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \begin{bmatrix}1 & 1\\
1 & 2\end{bmatrix}\bar{x}+\begin{bmatrix}1\\
0\end{bmatrix}\bar{u}\\
y & = & \begin{bmatrix}1 & 0\end{bmatrix}\bar{x}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\begin{bmatrix}x_{ss}\\
u_{ss}\end{bmatrix} & = & \begin{bmatrix}A & B\\
C & 0\end{bmatrix}^{-1}\begin{bmatrix}0\\
0\\
1\end{bmatrix}\\
 & = & \begin{bmatrix}11 & 1\\
12 & 0\\
10 & 0\end{bmatrix}^{-1}\begin{bmatrix}0\\
0\\
1\end{bmatrix}\\
 & = & \begin{bmatrix}1\\
-\frac{1}{2}\\
-\frac{1}{2}\end{bmatrix}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
x_{ss} & = & \begin{bmatrix}1\\
-\frac{1}{2}\end{bmatrix}\\
u_{ss} & = & -\frac{1}{2}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Since 
\begin_inset Formula \[
\bar{x}_{ss}=N_{x}\bar{r}_{ss}\text{ with }r_{ss}=1\ \rightarrow\ N_{x}=\begin{bmatrix}1\\
-\frac{1}{2}\end{bmatrix}\]

\end_inset


\begin_inset Formula \[
\bar{u}_{ss}=N_{u}\bar{r}_{ss}\text{ with }r_{ss}=1\ \rightarrow\ N_{u}=-\frac{1}{2}\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
\tilde{N} & = & N_{u}+kN_{x}\\
 & = & -\frac{1}{2}+\begin{bmatrix}14 & 57\end{bmatrix}\begin{bmatrix}1\\
-\frac{1}{2}\end{bmatrix}\\
 & = & -15\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsubsection
Example: Ball & beam
\end_layout

\begin_layout Standard
Equations of motion:
\begin_inset Formula \[
\frac{d}{dt}\begin{bmatrix}r\\
\dot{r}\\
\alpha\\
\dot{\alpha}\end{bmatrix}=\begin{bmatrix}0 & 1 & 0 & 0\\
0 & 0 & -\frac{mg}{\frac{J}{R^{2}}+m} & 0\\
0 & 0 & 0 & 1\\
0 & 0 & 0 & 0\end{bmatrix}\begin{bmatrix}r\\
\dot{r}\\
\alpha\\
\dot{\alpha}\end{bmatrix}+\begin{bmatrix}0\\
0\\
0\\
1\end{bmatrix}u\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
m: &  & \text{mass of ball}\\
R: &  & \text{radius fo ball}\\
J: &  & \text{moment of inertial of ball}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Want settling time 
\begin_inset Formula $T_{s}<3$
\end_inset

 seconds with % overshoot 
\begin_inset Formula $<5\%$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
11/8/2010
\end_layout

\begin_layout Itemize
Placement of closed loop poles
\end_layout

\begin_deeper
\begin_layout Itemize
Bessel
\end_layout

\begin_layout Itemize
ITAE
\end_layout

\end_deeper
\begin_layout Itemize
Output tracking
\end_layout

\begin_deeper
\begin_layout Itemize
SISO
\end_layout

\begin_layout Itemize
Square MIMO
\end_layout

\end_deeper
\begin_layout Subsection
Placement of closed-loop poles
\end_layout

\begin_layout Itemize
We have focused primarily on ensuring stability.
\end_layout

\begin_layout Itemize
Also, we assumed pole locations that yield dominantly 
\begin_inset Formula $2^{nd}$
\end_inset

 order systems.
\begin_inset Formula \[
\frac{Y(s)}{R(s)}=\frac{\omega_{n}^{2}}{s^{2}+2\zeta\omega_{n}s+\omega_{n}^{2}}\]

\end_inset


\end_layout

\begin_layout Itemize
We can also place our poles so that we mimic a system that has performance
 similar to what we want.
\end_layout

\begin_layout Itemize
In this case we simply need to place our poles to those of our prototype
 system.
\end_layout

\begin_layout Itemize
Many options 
\begin_inset Formula $\rightarrow$
\end_inset

 we'll cover 2:
\end_layout

\begin_deeper
\begin_layout Itemize
Bessel polynomials
\end_layout

\begin_layout Itemize
ITAE
\end_layout

\end_deeper
\begin_layout Subsection
Bessel polynomial systems of order 
\begin_inset Formula $k$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \[
\frac{Y(s)}{R(s)}=\frac{1}{B_{k}(s)}\]

\end_inset


\end_layout

\begin_layout Itemize
All poles in this instance are scaled to give settling times of 1 second
 (see handout).
\end_layout

\begin_layout Itemize
This can be changed to 
\begin_inset Formula $T_{s}$
\end_inset

 by dividng the poles given (see handout) by 
\begin_inset Formula $T_{s}$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Procedure for 
\begin_inset Formula $n^{th}$
\end_inset

 order system
\end_layout

\begin_layout Enumerate
Determine desired settling time 
\begin_inset Formula $T_{s}$
\end_inset

.
\end_layout

\begin_layout Enumerate
Find 
\begin_inset Formula $k=n$
\end_inset

 polynomial in table (again see handout).
\end_layout

\begin_layout Enumerate
Divide pole locations by 
\begin_inset Formula $T_{s}$
\end_inset

.
\end_layout

\begin_layout Enumerate
Use 
\series bold
acker/place
\series default
 in matlab to determine feedback gains.
\end_layout

\begin_layout Enumerate
Simulate, check performance and control effort.
\end_layout

\begin_layout Subsubsection
Example
\end_layout

\begin_layout Standard
\begin_inset Formula \[
\dot{\bar{x}}=A\bar{x}+Bu\]

\end_inset


\begin_inset Formula \[
A=\begin{bmatrix}-5 & -4 & 0\\
1 & 0 & 0\\
0 & 1 & 0\end{bmatrix}\]

\end_inset


\begin_inset Formula \[
B=\begin{bmatrix}1\\
0\\
0\end{bmatrix}\]

\end_inset


\end_layout

\begin_layout Standard
Want 
\begin_inset Formula $T_{s}=2\, sec$
\end_inset


\end_layout

\begin_layout Standard

\series bold
See matlab file.
\end_layout

\begin_layout Subsection
ITAE approach
\end_layout

\begin_layout Itemize
Match 
\begin_inset Formula $n^{th}$
\end_inset

 order polynomial that was designed to minimize the integral of the time
 multiplied by the absolute value of the error
\begin_inset Formula \[
J_{ITAE}=\int_{0}^{\infty}\, t\left|e\left(t\right)\right|\, dt\]

\end_inset


\end_layout

\begin_layout Subsubsection
Procedure (see suplemental matlab script)
\end_layout

\begin_layout Enumerate
Determine desired 
\begin_inset Formula $T_{s}$
\end_inset

.
\end_layout

\begin_layout Enumerate
Find 
\begin_inset Formula $k=n$
\end_inset

 polynomial from table.
\end_layout

\begin_layout Enumerate
Find 
\begin_inset Formula $T_{s}$
\end_inset

 from simulation
\begin_inset Formula \[
T_{s_{Simulation}}=\omega_{n}T_{s_{Desired}}\]

\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $\omega_{n}=\frac{T_{s_{Simulation}}}{T_{s_{Desired}}}$
\end_inset


\end_layout

\begin_layout Enumerate
Construct desired polynomial with 
\begin_inset Formula $\omega_{n}$
\end_inset

 and find poles.
\end_layout

\begin_layout Enumerate
Use 
\series bold
place
\series default
 to find gain vector 
\begin_inset Formula $K$
\end_inset


\end_layout

\begin_layout Enumerate
Compute scaling factor 
\begin_inset Formula $\bar{n}$
\end_inset

.
\end_layout

\begin_layout Subsection
Output tracking
\end_layout

\begin_layout Standard
Consider SISO system
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}+Bu\\
y & = & C\bar{x}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Suppose that we want the output to follow a desired path 
\begin_inset Formula $y_{D}(t)$
\end_inset

.
\end_layout

\begin_layout Itemize
Assume that our original sytem is stable is stable or can be stablized by
 state feedback, we define tracking error as 
\begin_inset Formula $e\left(t\right)=y_{D}-y$
\end_inset

.
\end_layout

\begin_layout Standard

\series bold
Goal:
\series default
 Choose an input 
\begin_inset Formula $u$
\end_inset

 such that 
\begin_inset Formula $y(t)$
\end_inset

 converges asymptotically to our 
\begin_inset Formula $y_{D}(t)$
\end_inset

.
\end_layout

\begin_layout Standard
Assume 
\begin_inset Formula $y_{D}(t)$
\end_inset

 is once differentiable such that our error dynamics are governed by:
\begin_inset Formula \begin{eqnarray*}
\dot{e} & = & \dot{y}_{D}-\dot{y}\\
 & = & \dot{y}_{D}-C\dot{\bar{x}}\\
\dot{e} & = & \dot{y}_{D}-CA\bar{x}-CBu\end{eqnarray*}

\end_inset

If 
\begin_inset Formula $CB$
\end_inset

 is non-zero and the system state 
\begin_inset Formula $\bar{x}$
\end_inset

 is available for feedback then we can choose
\begin_inset Formula \begin{eqnarray*}
u & = & \frac{1}{CB}\left(\dot{y}_{D}-CA\bar{x}+\alpha e\right),\ \alpha>0\\
 & = & \frac{1}{CB}\left(\dot{y}_{D}-CA\bar{x}+\alpha\left(y_{D}-y\right)\right)\end{eqnarray*}

\end_inset

This yields
\begin_inset Formula \[
\dot{e}=-\alpha e\]

\end_inset

By choosing 
\begin_inset Formula $\alpha>0$
\end_inset

 we can make our error decay exponentially fast.
\end_layout

\begin_layout Subsubsection
Notes
\end_layout

\begin_layout Itemize
System stability is important since 
\begin_inset Formula $\bar{x}$
\end_inset

 appears in 
\begin_inset Formula $u$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $u$
\end_inset

 also depends on tracking error.
\end_layout

\begin_layout Subsubsection
What if 
\begin_inset Formula $CB=0$
\end_inset

?
\end_layout

\begin_layout Standard
Assume that 
\begin_inset Formula $y_{D}$
\end_inset

 is twice differentiable
\begin_inset Formula \begin{eqnarray*}
\ddot{e} & = & \ddot{y}_{D}-\ddot{y}\\
 & = & \ddot{y}_{D}-CA\dot{\bar{x}}\\
 & = & \ddot{y}_{D}-CA^{2}\bar{x}-CABu\end{eqnarray*}

\end_inset

If 
\begin_inset Formula $CAB$
\end_inset

 is non-zero, then we can choose
\begin_inset Formula \[
u=\frac{1}{CAB}\left(\ddot{y}_{D}-CA^{2}\bar{x}+\alpha_{0}e+\alpha_{1}\dot{e}\right)\ \alpha_{i}>0\]

\end_inset


\end_layout

\begin_layout Standard
In this case, the error dynamics become
\begin_inset Formula \[
\dot{e}=\begin{bmatrix}0 & 1\\
-\alpha_{0} & -\alpha_{1}\end{bmatrix}e\]

\end_inset

Want this to be stable so output converges to our desired value.
\end_layout

\begin_layout Paragraph

\series bold
Generalized:
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $CAB=0$
\end_inset

, continue this process of differentiating the error dynamics until we find
 
\begin_inset Formula $CA^{\gamma-1}B\ne0$
\end_inset

 for some 
\begin_inset Formula $\gamma\ge1$
\end_inset

.
 The smallest value of 
\begin_inset Formula $\gamma$
\end_inset

 that satisfies 
\begin_inset Formula $CA^{\gamma-1}B\ne0$
\end_inset

 is the 
\bar under
relative degree
\bar default
 of the transfer function 
\begin_inset Formula $C\left(sI-A\right)^{-1}B$
\end_inset

.
 In the general case, we choose
\begin_inset Formula \[
u=\frac{1}{CA^{\gamma-1}B}\left(y_{D}^{\left(\gamma\right)}-CA^{\gamma}\bar{x}+\bar{\alpha}^{T}\bar{e}\right)\]

\end_inset

where 
\begin_inset Formula $y_{D}^{\left(\gamma\right)}=\gamma^{th}$
\end_inset

 time derivative of 
\begin_inset Formula $y_{D}$
\end_inset


\begin_inset Formula \[
\bar{\alpha}=\begin{bmatrix}\alpha_{0}\\
\alpha_{1}\\
\vdots\\
\alpha_{\gamma-1}\end{bmatrix},\ \bar{e}=\begin{bmatrix}e\\
\dot{e}\\
\vdots\\
e^{\left(\gamma-1\right)}\end{bmatrix}\]

\end_inset


\end_layout

\begin_layout Standard
The output will converge to the desired output inf 
\begin_inset Formula $\alpha_{i}>0$
\end_inset

 are chosen such that the LTI system
\begin_inset Formula \[
\dot{\bar{e}}=\begin{bmatrix}0 & 1 & 0 & \dots & 0\\
0 & 0 & 1 & \dots & 0\\
\vdots & \vdots & \vdots &  & \vdots\\
-\alpha_{0} & -\alpha_{1} & -\alpha_{2} & \dots & -\alpha_{\gamma-1}\end{bmatrix}\bar{e}\]

\end_inset

 is stable.
\end_layout

\begin_layout Standard
The characteristic polynomial associated with the error dynamics is
\begin_inset Formula \[
\lambda^{\gamma}+\alpha_{\gamma-1}\lambda^{\gamma-1}+\dots\alpha_{1}\lambda+\alpha_{0}=0\]

\end_inset

our parameters 
\begin_inset Formula $\alpha_{i}$
\end_inset

 can be chosen so that the eror dynamics decay quickly when compared to
 the system dynamics.
\end_layout

\begin_layout Itemize
Chose poles for error dynamics such that the frequency is greater than the
 highest frequency in the referency trajectory.
\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
11/10/2010
\end_layout

\begin_layout Itemize
Generating smooth reference trajectories
\end_layout

\begin_layout Itemize
Example of SISO output tracking
\end_layout

\begin_layout Itemize
Output tracking for square MIMO systems
\end_layout

\begin_layout Itemize
Estimators/observers
\end_layout

\begin_layout Subsection
Generating reference trajectories
\end_layout

\begin_layout Standard
For a system of relative degree 
\begin_inset Formula $\gamma\ge1$
\end_inset

 our control law (for SISO system) requires that reference trajectory 
\begin_inset Formula $y_{D}$
\end_inset

 is 
\begin_inset Formula $\gamma$
\end_inset

 times differentiable.
\end_layout

\begin_layout Itemize
We can generate a smooth reference trajectory by using a parallel system
 with the same relative degree.
\end_layout

\begin_layout Subsubsection
Example
\end_layout

\begin_layout Standard
\begin_inset Formula $\gamma=2$
\end_inset

, define a reference model state 
\begin_inset Formula $\bar{z}=\begin{bmatrix}z_{1}\\
z_{2}\end{bmatrix}$
\end_inset

 and 
\begin_inset Formula $\dot{\bar{z}}=\begin{bmatrix}0 & 1\\
-\omega_{n}^{2} & -2\zeta\omega_{n}\end{bmatrix}\bar{z}+\begin{bmatrix}0\\
\omega_{n}^{2}\end{bmatrix}r(t)$
\end_inset

, 
\begin_inset Formula $y_{D}=\begin{bmatrix}1 & 0\end{bmatrix}\bar{z}$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Formula $\omega_{n}>0$
\end_inset

, 
\begin_inset Formula $\zeta>0$
\end_inset

 
\begin_inset Formula $\rightarrow$
\end_inset

 parameters we choose even if 
\begin_inset Formula $r(t)$
\end_inset

 is not smooth (i.e.
 unit step) our output will be smooth.
\end_layout

\begin_layout Itemize
Choose 
\begin_inset Formula $\omega_{n}$
\end_inset

, 
\begin_inset Formula $\zeta$
\end_inset

 to make 
\begin_inset Formula $y_{D}$
\end_inset

 approximate 
\begin_inset Formula $r(t)$
\end_inset

 to some specified precision.
\end_layout

\begin_layout Standard
If we choose 
\begin_inset Formula $\omega_{n}=5$
\end_inset

, 
\begin_inset Formula $\zeta=1$
\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{\bar{z}} & = & \begin{bmatrix}0 & 1\\
-25 & -10\end{bmatrix}\bar{z}+\begin{bmatrix}0\\
25\end{bmatrix}\underbrace{r(t)}_{\text{unit step}}\\
y_{D} & = & \begin{bmatrix}1 & 0\end{bmatrix}\bar{z}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
For the general case of a system with a relative degree 
\begin_inset Formula $\gamma$
\end_inset

, define
\begin_inset Formula \[
\bar{z}=\begin{bmatrix}z_{1}\\
\vdots\\
z_{\gamma}\end{bmatrix}\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{\bar{z}} & = & \begin{bmatrix}0 & 1 & 0 & \dots & 0\\
0 & 0 & 1 & \dots & 0\\
\vdots & \vdots & \vdots &  & \vdots\\
-a_{r_{0}} & -a_{r_{1}} & -a_{r_{2}} & \dots & -a_{r_{\gamma-1}}\end{bmatrix}\bar{z}+\begin{bmatrix}0\\
\vdots\\
a_{r_{0}}\end{bmatrix}r(t)\\
y_{D} & = & \begin{bmatrix}1 & 0 & \dots & 0\end{bmatrix}\bar{z}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsubsection
Example: servomotor
\end_layout

\begin_layout Standard
DC servomotor connected to a motor controller/amplifier.
 
\begin_inset Formula $2^{nd}$
\end_inset

 order system:
\begin_inset Formula \[
\bar{x}=\begin{bmatrix}\theta\\
\dot{\theta}\end{bmatrix}\]

\end_inset


\begin_inset Formula \[
\dot{\bar{x}}=\begin{bmatrix}0 & 1\\
0 & \frac{-d_{\theta}}{J}\end{bmatrix}\bar{x}+\begin{bmatrix}0\\
\frac{k_{T}}{J}\end{bmatrix}u\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
J & : & \text{inertia of rotor shaft}\\
d_{\theta} & : & \text{viscous damping in bearings}\\
k_{T} & : & \text{torque const (relates current to torque)}\\
\theta & : & \text{motor shaft angle}\\
u & : & \text{motor current}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
y & = & \begin{bmatrix}1 & 0\end{bmatrix}\\
y_{d} & = & sin(t)\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Check controllability:
\begin_inset Formula \begin{eqnarray*}
\mathcal{C}\left(A,B\right) & = & \begin{bmatrix}\begin{array}{c}
0\\
\frac{k_{T}}{J}\end{array} & \begin{bmatrix}0 & 1\\
0 & \frac{-d_{\theta}}{J}\end{bmatrix} & \begin{bmatrix}0\\
\frac{k_{T}}{J}\end{bmatrix}\end{bmatrix}\\
 & = & \begin{bmatrix}0 & \frac{k_{T}}{J}\\
\frac{k_{T}}{J} & \frac{-d_{\theta}k_{T}}{J^{2}}\end{bmatrix}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
rank 
\begin_inset Formula $\mathcal{C}=2$
\end_inset

 
\begin_inset Formula $\rightarrow$
\end_inset

 system is controllable.
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
u & = & -k\bar{x}+v\\
 & = & \frac{J}{k_{T}}\left(-\begin{bmatrix}a_{0} & \left(a_{1}-\frac{d_{\theta}}{J}\right)\end{bmatrix}\bar{x}+v\right)\end{eqnarray*}

\end_inset

now:
\begin_inset Formula \[
\dot{\bar{x}}=\begin{bmatrix}0 & 1\\
-a_{0} & -a_{1}\end{bmatrix}\bar{x}+\begin{bmatrix}0\\
1\end{bmatrix}v\]

\end_inset


\end_layout

\begin_layout Standard
Compute relative degree:
\begin_inset Formula \[
CB=\begin{bmatrix}1 & 0\end{bmatrix}\begin{bmatrix}0\\
1\end{bmatrix}=0\]

\end_inset


\begin_inset Formula \[
CAB=\begin{bmatrix}1 & 0\end{bmatrix}\begin{bmatrix}0 & 1\\
-a_{0} & -a_{1}\end{bmatrix}\begin{bmatrix}0\\
1\end{bmatrix}=\begin{bmatrix}0 & 1\end{bmatrix}\begin{bmatrix}0\\
1\end{bmatrix}=1\ne0\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $\gamma=2$
\end_inset

 and since our system is stable (through choice of 
\begin_inset Formula $a_{0}$
\end_inset

, 
\begin_inset Formula $a_{1}$
\end_inset

) we can use it to track any twice differentiable signal.
 Our control law (from general from)
\begin_inset Formula \[
v=\frac{1}{CAB}\left(\ddot{y}_{D}-CA^{2}\bar{x}+\bar{\alpha}^{T}\bar{e}\right)\]

\end_inset


\begin_inset Formula \[
CAB=1\]

\end_inset


\begin_inset Formula \[
CA^{2}=\begin{bmatrix}1 & 0\end{bmatrix}\begin{bmatrix}0 & 1\\
-a_{0} & -a_{1}\end{bmatrix}\begin{bmatrix}0 & 1\\
-a_{0} & -a_{1}\end{bmatrix}=\begin{bmatrix}-a_{0} & -a_{1}\end{bmatrix}\]

\end_inset


\begin_inset Formula \[
\bar{\alpha}^{T}\bar{e}=\begin{bmatrix}\alpha_{0} & \alpha_{1}\end{bmatrix}\begin{bmatrix}e\\
\dot{e}\end{bmatrix}=\alpha_{0}e+\alpha_{1}\dot{e}\]

\end_inset


\begin_inset Formula \[
v=\ddot{y}_{d}+a_{0}x_{1}+a_{1}x_{2}+\alpha_{0}e+\alpha_{1}\dot{e}\]

\end_inset


\end_layout

\begin_layout Standard
Combined system:
\begin_inset Formula \begin{eqnarray*}
\begin{bmatrix}\dot{\bar{x}}\\
\dot{\bar{e}}\end{bmatrix} & = & \begin{bmatrix}0 & 1 & 0 & 0\\
-a_{0} & -a_{1} & 0 & 0\\
0 & 0 & 0 & 1\\
0 & 0 & -\alpha_{0} & -\alpha_{1}\end{bmatrix}\begin{bmatrix}\bar{x}\\
\bar{e}\end{bmatrix}+\begin{bmatrix}0\\
1\\
0\\
0\end{bmatrix}v\\
y & = & \begin{bmatrix}1 & 0 & 0 & 0\end{bmatrix}\begin{bmatrix}\bar{x}\\
\bar{e}\end{bmatrix}\end{eqnarray*}

\end_inset

Substitue in for 
\begin_inset Formula $v$
\end_inset

:
\begin_inset Formula \[
\begin{bmatrix}\dot{\bar{x}}\\
\dot{\bar{e}}\end{bmatrix}=\begin{bmatrix}0 & 1 & 0 & 0\\
0 & 0 & \alpha_{0} & \alpha_{1}\\
0 & 0 & 0 & 1\\
0 & 0 & -\alpha_{0} & -\alpha_{1}\end{bmatrix}\begin{bmatrix}\bar{x}\\
\bar{e}\end{bmatrix}+\begin{bmatrix}0\\
1\\
0\\
0\end{bmatrix}\ddot{y}_{d}\]

\end_inset


\end_layout

\begin_layout Standard
Now choose 
\begin_inset Formula $\alpha_{0}$
\end_inset

 and 
\begin_inset Formula $\alpha_{1}$
\end_inset

and simulate
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{e}} & = & \begin{bmatrix}0 & 1\\
-\alpha_{0} & -\alpha_{1}\end{bmatrix}\bar{e}\\
 & = & \begin{bmatrix}0 & 1\\
-\omega_{n}^{2} & -2\zeta\omega_{n}\end{bmatrix}\bar{e}\end{eqnarray*}

\end_inset


\begin_inset Formula \[
y_{D}=\sin(t)\ \rightarrow\ \omega=1\]

\end_inset

Choose 
\begin_inset Formula $\zeta=0.7$
\end_inset

, 
\begin_inset Formula $\omega_{n}=3$
\end_inset

 (
\begin_inset Formula $\omega_{n}$
\end_inset

 should roughly be much larger than 
\begin_inset Formula $\omega$
\end_inset

).
\begin_inset Formula \[
\lambda^{2}+2\zeta\omega_{n}\lambda+\omega_{n}^{2}\]

\end_inset


\begin_inset Formula \[
\lambda^{2}+\alpha_{1}\lambda+\alpha_{0}\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
\alpha_{0} & = & 9\\
\alpha_{1} & = & 4.2\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Inital conditions
\begin_inset Formula \[
x(0)=\dot{x}(0)=0\]

\end_inset


\begin_inset Formula \[
e(0)=y_{D}-y(0)=\sin(0)-C\bar{x}(0)=0\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{e}\left(0\right)=\dot{y}_{D}\left(0\right)-\dot{y}\left(0\right) & = & \cos\left(0\right)-C\dot{\bar{x}}\left(0\right)\\
 & = & \cos\left(0\right)-CAx\left(0\right)+CB\ddot{y}_{D}\\
 & = & 1\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsection
Output tracking for square MIMO systems
\end_layout

\begin_layout Itemize
We can extend our analysis for SISO systems to square MIMO systems.
\end_layout

\begin_layout Standard

\series bold
Assume:
\series default

\begin_inset Formula \begin{eqnarray*}
\bar{x} & = & A\bar{x}+B\bar{u}\\
\bar{y} & = & C\bar{x}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
y & \in & \mathbb{R}^{m}\\
u & \in & \mathbb{R}^{m}\end{eqnarray*}

\end_inset

Our system is stable or can be made stable through state feedback.
\end_layout

\begin_layout Standard
Define tracking error:
\begin_inset Formula \begin{eqnarray*}
\bar{e} & = & \bar{y}_{D}-\bar{y}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{\bar{e}} & = & \dot{\bar{y}}_{D}-\dot{\bar{y}}\\
 & = & \dot{\bar{y}}_{D}-C\dot{\bar{x}}\\
 & = & \dot{\bar{y}}_{D}-CA\bar{x}-CB\bar{u}\end{eqnarray*}

\end_inset

Suppose 
\begin_inset Formula $CB$
\end_inset

 is non-singular.
 Assuming 
\begin_inset Formula $\bar{x}$
\end_inset

 is available for feedback we can choose
\begin_inset Formula \[
\bar{u}=\left(CB\right)^{-1}\left(\dot{\bar{y}}_{D}-CA\bar{x}+\alpha\bar{e}\right)\]

\end_inset

Error dynamics
\begin_inset Formula \[
\dot{\bar{e}}=-\alpha\bar{e}\]

\end_inset

we can choose 
\begin_inset Formula $\alpha$
\end_inset

 such that error goes to zero.
\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $CB$
\end_inset

 is singular, this control cannot be applied.
\end_layout

\begin_layout Itemize
For SISO systems, we differentiated the output 
\begin_inset Formula $y$
\end_inset

 until our control 
\begin_inset Formula $u$
\end_inset

 appeared in the 
\begin_inset Formula $\gamma^{th}$
\end_inset

 derivative.
\end_layout

\begin_layout Itemize
Cannot expect that components of 
\begin_inset Formula $u$
\end_inset

 will appear in the same derivative for each component of 
\begin_inset Formula $y$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Formula $\rightarrow$
\end_inset

 Need generalized notion of relative degree.
\end_layout

\begin_layout Standard
For each 
\begin_inset Formula $j\in\left[1,2\dots m\right]$
\end_inset

 define 
\begin_inset Formula $\gamma_{j}$
\end_inset

 to be the smallest integer so that at least one of the input components
 appears in 
\begin_inset Formula $y_{j}^{\left(\gamma_{j}\right)}$
\end_inset

.
 Denote rows of 
\begin_inset Formula $C$
\end_inset

 as 
\begin_inset Formula $c_{j}$
\end_inset

 so that
\begin_inset Formula \[
C=\begin{bmatrix}c_{1}\\
\vdots\\
c_{m}\end{bmatrix}\]

\end_inset

and define the 
\begin_inset Formula $m\times m$
\end_inset

 matrix
\begin_inset Formula \[
z=\begin{bmatrix}c_{1}A^{\gamma_{1}-1}B\\
c_{2}A^{\gamma_{2}-1}B\\
\vdots\\
c_{m}A^{\gamma_{m}-1}B\end{bmatrix}\]

\end_inset


\end_layout

\begin_layout Standard

\series bold
Definition:
\series default
 The system is said to have vector relative degree 
\begin_inset Formula $\left(\gamma_{1},\gamma_{2},\dots\gamma_{m}\right)$
\end_inset

 if 
\begin_inset Formula $z$
\end_inset

 is nonsingular.
\end_layout

\begin_layout Standard
If our system has a well defined vector relative degree we can choose our
 control
\begin_inset Formula \[
\bar{u}=z^{-1}\left[\begin{bmatrix}y_{D1}^{\left(\gamma_{1}\right)}\\
y_{D2}^{\left(\gamma_{2}\right)}\\
\vdots\\
y_{Dm}^{\left(\gamma_{m}\right)}\end{bmatrix}-\begin{bmatrix}c_{1}A^{\gamma_{1}}\bar{x}\\
c_{2}A^{\gamma_{2}}\bar{x}\\
\vdots\\
c_{m}A^{\gamma_{m}}\bar{x}\end{bmatrix}+\bar{v}\right]\]

\end_inset

yields closed-loop dynamics.
\begin_inset Formula \[
\begin{bmatrix}e_{1}^{\gamma_{1}}\\
e_{2}^{\gamma_{2}}\\
\vdots\\
e_{m}^{\gamma_{m}}\end{bmatrix}=\bar{v}\]

\end_inset


\end_layout

\begin_layout Itemize
Each row represents a chain of tracking error integrator forced by the input
 
\begin_inset Formula $v_{j}$
\end_inset

.
\end_layout

\begin_layout Itemize
Each of these chains can be controlled sparately as a controllable, SISO
 system.
\end_layout

\begin_layout Itemize
Each component 
\begin_inset Formula $e_{j}$
\end_inset

 of our tracking error can be driven independently to zero through suitable
 choice of 
\begin_inset Formula $v_{j}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
11/15/2010
\end_layout

\begin_layout Itemize
Example of MIMO tracking continued
\end_layout

\begin_layout Itemize
Estimator/observer design
\end_layout

\begin_deeper
\begin_layout Itemize
Open-loop
\end_layout

\begin_layout Itemize
Closed-loop
\end_layout

\end_deeper
\begin_layout Subsection
Example of MIMO tracking continued
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \begin{bmatrix}-1 & 0\\
0 & 4\end{bmatrix}\bar{x}+\begin{bmatrix}0 & 1\\
1 & 0\end{bmatrix}\bar{u}\\
\bar{y} & = & \begin{bmatrix}1 & 1\\
0 & 1\end{bmatrix}\bar{x}\end{eqnarray*}

\end_inset

Find 
\begin_inset Formula $u$
\end_inset

 such that 
\begin_inset Formula \[
y_{D}=\begin{Bmatrix}sin(t)\\
sin(2t)\end{Bmatrix}\]

\end_inset


\end_layout

\begin_layout Itemize
System is stable (eigenvalues 
\begin_inset Formula $-1,4$
\end_inset

).
\end_layout

\begin_layout Itemize
Find relative degree.
\begin_inset Formula \begin{eqnarray*}
C_{1} & = & \begin{bmatrix}1 & 1\end{bmatrix}\\
C_{2} & = & \begin{bmatrix}0 & 1\end{bmatrix}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
C_{1}B & = & \begin{bmatrix}1 & 1\end{bmatrix}\begin{bmatrix}0 & 1\\
1 & 0\end{bmatrix}\\
 & = & \begin{bmatrix}1 & 1\end{bmatrix}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
C_{2}B & = & \begin{bmatrix}0 & 1\end{bmatrix}\begin{bmatrix}0 & 1\\
1 & 0\end{bmatrix}\\
 & = & \begin{bmatrix}1 & 0\end{bmatrix}\end{eqnarray*}

\end_inset

Contention: 
\begin_inset Formula $\gamma_{1}=1$
\end_inset

, 
\begin_inset Formula $\gamma_{2}=1$
\end_inset

.
 Check:
\begin_inset Formula \begin{eqnarray*}
y_{1} & = & x_{1}+x_{2}\\
y_{2} & = & x_{2}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{y}_{1} & = & \dot{x}_{1}+\dot{x}_{2}\\
 & = & -x_{1}+u_{2}-4x_{2}+u_{1}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{y}_{2} & = & \dot{x}_{2}\\
 & = & -4x_{2}+u_{1}\end{eqnarray*}

\end_inset

Degree is in fact 
\begin_inset Formula $1$
\end_inset

.
\end_layout

\begin_layout Itemize
Using:
\begin_inset Formula \[
\bar{u}=z^{-1}\left[\begin{bmatrix}y_{D1}^{\left(\gamma_{1}\right)}\\
y_{D2}^{\left(\gamma_{2}\right)}\\
\vdots\\
y_{Dm}^{\left(\gamma_{m}\right)}\end{bmatrix}-\begin{bmatrix}c_{1}A^{\gamma_{1}}\bar{x}\\
c_{2}A^{\gamma_{2}}\bar{x}\\
\vdots\\
c_{m}A^{\gamma_{m}}\bar{x}\end{bmatrix}+\bar{v}\right]\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
z & = & \begin{bmatrix}c_{1}A^{\gamma_{1}-1}B\\
c_{2}A^{\gamma_{2}-1}B\\
\vdots\\
c_{m}A^{\gamma_{m}-1}B\end{bmatrix}\\
 & = & \begin{bmatrix}C_{1}B\\
C_{2}B\end{bmatrix}\\
 & = & \begin{bmatrix}1 & 1\\
1 & 0\end{bmatrix}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
z^{-1} & = & \frac{1}{-1}\begin{bmatrix}0 & -1\\
-1 & 1\end{bmatrix}\\
 &  & \begin{bmatrix}0 & 1\\
1 & -1\end{bmatrix}\end{eqnarray*}

\end_inset

We can find 
\begin_inset Formula $\bar{u}$
\end_inset


\begin_inset Formula \begin{eqnarray*}
\bar{u} & = & \begin{bmatrix}0 & 1\\
1 & -1\end{bmatrix}\left[\begin{bmatrix}\cos\left(t\right)\\
2\cos\left(2t\right)\end{bmatrix}-\begin{bmatrix}C_{1}A\bar{x}\\
C_{2}A\bar{x}\end{bmatrix}+\bar{v}\right]\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
C_{1}A & = & \begin{bmatrix}1 & 1\end{bmatrix}\begin{bmatrix}-1 & 0\\
0 & 4\end{bmatrix}\\
 & = & \begin{bmatrix}-1 & -4\end{bmatrix}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
C_{2}A & = & \begin{bmatrix}0 & 1\end{bmatrix}\begin{bmatrix}-1 & 0\\
0 & 4\end{bmatrix}\\
 & = & \begin{bmatrix}0 & -4\end{bmatrix}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\bar{u} & = & \begin{bmatrix}0 & 1\\
1 & -1\end{bmatrix}\begin{bmatrix}\cos\left(t\right)+x_{1}+4x_{2}+v_{1}\\
2\cos\left(2t\right)+4x_{2}+v_{2}\end{bmatrix}\\
 & = & \begin{bmatrix}2\cos\left(t\right)+4x_{2}+v_{2}\\
\cos\left(2t\right)+x_{1}-2\cos\left(2t\right)+v_{1}-v2\end{bmatrix}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
Examine error dynaimcs
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{e}} & = & \dot{\bar{y}}_{D}-\dot{\bar{y}}\\
 & = & \begin{Bmatrix}\dot{y}_{D1}\\
\dot{y}_{D2}\end{Bmatrix}-\begin{Bmatrix}\dot{y}_{1}\\
\dot{y}_{2}\end{Bmatrix}\\
 & = & \begin{Bmatrix}\cos\left(t\right)\\
2\cos\left(2t\right)\end{Bmatrix}-\begin{Bmatrix}\dot{x}_{1}+\dot{x}_{2}\\
\dot{x}_{2}\end{Bmatrix}\\
 & = & \begin{Bmatrix}\cos\left(t\right)-\left(-x_{1}+u_{2}-4x_{2}+u_{1}\right)\\
2\cos\left(2t\right)-\left(-4x_{2}+u_{1}\right)\end{Bmatrix}\\
 & = & \begin{Bmatrix}\cos\left(t\right)+x_{1}-\cos\left(t\right)-x_{1}+2\cos\left(2t\right)-v_{1}+v_{2}+4x_{2}-2\cos\left(2t\right)-4x_{2}-v_{2}\\
2\cos\left(2t\right)+4x_{2}-2\cos\left(2t\right)-4x_{2}-v_{2}\end{Bmatrix}\\
\begin{Bmatrix}\dot{e}_{1}\\
\dot{e}_{2}\end{Bmatrix} & = & \begin{Bmatrix}-v_{1}\\
-v_{2}\end{Bmatrix}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
Choose 
\begin_inset Formula $v_{1}$
\end_inset

 and 
\begin_inset Formula $v_{2}$
\end_inset

 such that 
\begin_inset Formula $e_{1},e_{2}\rightarrow0$
\end_inset

 as 
\begin_inset Formula $t\rightarrow\infty$
\end_inset

.
 If we choose
\begin_inset Formula \begin{eqnarray*}
\dot{e}_{1}=-e_{1} & \rightarrow & e_{1}\left(t\right)=A_{1}e^{-t}=e_{1}\left(0\right)e^{-t}\\
\dot{e}_{2}=-e_{2} & \rightarrow & e_{2}\left(t\right)=A_{2}e^{-t}=e_{2}\left(0\right)e^{-t}\end{eqnarray*}

\end_inset


\begin_inset Formula \[
\bar{u}=\begin{bmatrix}2\cos\left(t\right)+4x_{2}+e_{2}\left(0\right)e^{-t}\\
\cos\left(2t\right)+x_{1}-2\cos\left(2t\right)+e_{1}\left(0\right)e^{-t}-e_{2}\left(0\right)e^{-t}\end{bmatrix}\]

\end_inset


\end_layout

\begin_layout Itemize
Simulate with initial conditions
\begin_inset Formula \begin{eqnarray*}
x_{1}\left(0\right) & = & 2\\
x_{2}\left(0\right) & = & 1\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
e_{1}\left(0\right) & = & y_{D1}\left(0\right)-y_{1}\left(0\right)=0-x_{1}\left(0\right)-x_{2}\left(0\right)\\
 & = & -3\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
e_{2}\left(0\right) & = & y_{D2}\left(0\right)-y_{2}\left(0\right)=0-x_{2}\left(0\right)\\
 & = & -1\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsection
Need for estimators & observers
\end_layout

\begin_layout Standard

\series bold
Problem:
\series default
 Up until now we have assumed that all states 
\begin_inset Formula $\bar{x}$
\end_inset

 are available for feedback.
\end_layout

\begin_layout Itemize
In practice, complete state vector is not always measured.
\end_layout

\begin_layout Standard

\series bold
Solution:
\series default
 Develop a replica of the dynamic system that provides estimates of our
 system states.
\end_layout

\begin_layout Subsubsection
Observer
\end_layout

\begin_layout Standard
If a system is observable, the observer is used to estimate our state vector
 
\begin_inset Formula $\bar{x}$
\end_inset

 from the output measurements 
\begin_inset Formula $y\in\mathbb{R}^{q}$
\end_inset

 
\begin_inset Formula $q<n$
\end_inset

.
\end_layout

\begin_layout Standard

\series bold
Plan:
\series default
 Develop an estimate of our system state 
\begin_inset Formula $\bar{x}$
\end_inset

, denoted as 
\begin_inset Formula $\hat{\bar{x}}$
\end_inset

 
\begin_inset Foot
status open

\begin_layout Plain Layout
Aside: 
\begin_inset Formula $\hat{\bar{\left(\right)}}=estimates$
\end_inset

 
\begin_inset Formula $\tilde{\bar{\left(\right)}}=errors$
\end_inset


\end_layout

\end_inset

.
\end_layout

\begin_layout Itemize
Use the estimate of the state in our feedback control law 
\begin_inset Formula $\bar{u}=-k\bar{x}$
\end_inset

, use 
\begin_inset Formula $\bar{u}=-k\hat{\bar{x}}$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Observer design
\end_layout

\begin_layout Standard
Given a system
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}+B\bar{u}\\
\bar{y} & = & C\bar{x}\end{eqnarray*}

\end_inset

Find a dynamic system whose state 
\begin_inset Formula $\hat{\bar{x}}\left(t\right)\rightarrow\bar{x}\left(t\right)$
\end_inset

.
 
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
Three approaches that we will use:
\end_layout

\begin_layout Itemize
Open-loop
\end_layout

\begin_layout Itemize
Closed-loop
\end_layout

\begin_deeper
\begin_layout Itemize
Full order
\end_layout

\begin_layout Itemize
Reduced order
\end_layout

\end_deeper
\begin_layout Paragraph
Open-loop observer design
\end_layout

\begin_layout Standard
Since we know our state matrices and inputs we can assume that our state
 equations adequately represent our system, use these to run a simulation
 in parallel with our system
\begin_inset Formula \[
\dot{\hat{\bar{x}}}=A\hat{\bar{x}}+B\bar{u}\]

\end_inset

If we know our inital state 
\begin_inset Formula $\hat{\bar{x}}\left(0\right)=\bar{x}\left(0\right)$
\end_inset

 then our state estimate will track the state.
 If 
\begin_inset Formula $\bar{x}\left(0\right)\ne\hat{\bar{x}}\left(0\right)$
\end_inset

, does our estimate converge to 
\begin_inset Formula $\bar{x}$
\end_inset

 as 
\begin_inset Formula $t\rightarrow\infty$
\end_inset

?
\end_layout

\begin_layout Itemize
Examine estimtion error
\begin_inset Formula \[
\tilde{\bar{x}}=\bar{x}\left(t\right)-\hat{\bar{x}}\left(t\right)\]

\end_inset


\end_layout

\begin_layout Itemize
Differentiate
\begin_inset Formula \begin{eqnarray*}
\dot{\tilde{\bar{x}}} & = & \dot{\bar{x}}-\dot{\hat{\bar{x}}}\\
 & = & \left(A\bar{x}-B\bar{u}\right)-\left(A\hat{\bar{x}}-B\bar{u}\right)\\
 & = & A\left(\bar{x}-\hat{\bar{x}}\right)\\
\dot{\tilde{\bar{x}}} & = & A\tilde{\bar{x}}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $A$
\end_inset

 is Hurwitz (all stable eigenvalues) then the state estimate will converge
 to the true state as 
\begin_inset Formula $t\rightarrow\infty$
\end_inset

 (
\begin_inset Formula $\tilde{x}\left(t\right)=e^{At}\tilde{x}\left(0\right)$
\end_inset

)
\end_layout

\begin_layout Paragraph
Problems
\end_layout

\begin_layout Itemize
\begin_inset Formula $A$
\end_inset

 matrix typically not modified and may have 
\begin_inset Quotes eld
\end_inset

slow
\begin_inset Quotes erd
\end_inset

 eigenvalues.
 Estimation error goes to zero over a long time period.
\end_layout

\begin_layout Itemize
Physical systems have noise and disturbances which cannot be measured or
 modeled in our estimator system.
\end_layout

\begin_layout Itemize
No connection between our state estimate and our actual system dynamics
 other than the state equations.
\end_layout

\begin_layout Paragraph
Closed-loop estimator
\end_layout

\begin_layout Itemize
Design an improved estimator that makes use of all the available information:
\end_layout

\begin_deeper
\begin_layout Itemize
Measured output
\end_layout

\begin_layout Itemize
Applied inputs
\end_layout

\begin_layout Itemize
Linear dynaimc model
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}+B\bar{u}\\
\bar{y} & = & C\bar{x}+D\bar{u}\end{eqnarray*}

\end_inset

Where 
\begin_inset Formula $\bar{y}$
\end_inset

 has dimension 
\begin_inset Formula $q<n$
\end_inset

 and 
\begin_inset Formula $\left(A,C\right)$
\end_inset

 is an observable pair.
 Our open-loop observer
\begin_inset Formula \begin{eqnarray*}
\dot{\hat{\bar{x}}} & = & A\hat{\bar{x}}+B\bar{u}\\
\hat{\bar{y}} & = & C\hat{\bar{x}}+D\bar{u}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Then
\begin_inset Formula \begin{eqnarray*}
\tilde{\bar{y}}\left(t\right) & = & \bar{y}\left(t\right)-\hat{\bar{y}}\left(t\right)\\
 & = & C\bar{x}+D\bar{u}-\left(C\hat{\bar{x}}+D\bar{u}\right)\\
 & = & C\tilde{\bar{x}}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
This comparison provides some information about our error in the state estimate.
\end_layout

\begin_layout Paragraph
Approach
\end_layout

\begin_layout Itemize
Use our error between the true and estimated output to improve our state
 estimate
\begin_inset Formula \begin{eqnarray*}
\dot{\hat{\bar{x}}} & = & A\hat{\bar{x}}+B\bar{u}+\underbrace{G}_{\text{gain matrix}}\tilde{\bar{y}}\\
\hat{\bar{y}} & = & C\hat{\bar{x}}+D\bar{u}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{\hat{\bar{x}}} & = & A\hat{\bar{x}}+B\bar{u}+G\left(C\bar{x}-C\hat{\bar{x}}\right)\\
 & = & \left(A-GC\right)\hat{\bar{x}}+B\bar{u}+GC\bar{x}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
Look at
\begin_inset Formula \[
\tilde{\bar{x}}=\bar{x}-\hat{\bar{x}}\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{\tilde{\bar{x}}} & = & \dot{\bar{x}}-\dot{\hat{\bar{x}}}\\
 & = & A\bar{x}+B\bar{u}-\left(A\hat{\bar{x}}+B\bar{u}+GC\tilde{\bar{x}}\right)\\
 & = & A\tilde{\bar{x}}-GC\tilde{\bar{x}}\\
 & = & \left(A-GC\right)\tilde{\bar{x}}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
Even if 
\begin_inset Formula $A$
\end_inset

 is not hurwitz, we can choose 
\begin_inset Formula $G$
\end_inset

 to make 
\begin_inset Formula $\left(A-GC\right)$
\end_inset

 hurwitz and our state estimate error 
\begin_inset Formula $\rightarrow0$
\end_inset

 as 
\begin_inset Formula $t\rightarrow\infty$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
11/17/2010
\end_layout

\begin_layout Itemize
Estimator design detail
\end_layout

\begin_deeper
\begin_layout Itemize
Full order estimator and example
\end_layout

\begin_layout Itemize
Reduced order estimator
\end_layout

\end_deeper
\begin_layout Subsection
Estimator design detail
\end_layout

\begin_layout Paragraph
Question
\end_layout

\begin_layout Standard
When is it possible to choose our estimator gain 
\begin_inset Formula $G$
\end_inset

 such that 
\begin_inset Formula $A-GC$
\end_inset

 is hurwitz?
\end_layout

\begin_layout Standard
\begin_inset Formula $\rightarrow$
\end_inset

 When 
\begin_inset Formula $\left(A,C\right)$
\end_inset

 is observable.
\end_layout

\begin_layout Paragraph
Theorem
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $\left(A,C\right)$
\end_inset

 is observable there exists a gain matrix 
\begin_inset Formula $G$
\end_inset

 such that 
\begin_inset Formula $\hat{\bar{x}}\rightarrow\bar{x}$
\end_inset

 asymptotically.
\end_layout

\begin_layout Paragraph
Proof
\end_layout

\begin_layout Standard
System is observable iff the dual system
\begin_inset Formula \begin{equation}
\dot{\bar{z}}=A^{T}\bar{z}+C^{T}\bar{u}\label{eq:edd}\end{equation}

\end_inset

 is controllable.
 If equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:edd"

\end_inset

 is controllable then a gain matrix 
\begin_inset Formula $G^{T}$
\end_inset

 can be chosen to place the poles of 
\begin_inset Formula $A^{T}-C^{T}G^{T}$
\end_inset

 arbitrarily since 
\begin_inset Formula $A$
\end_inset

 matrix and its transpose have identical eigenvalues 
\begin_inset Formula $\rightarrow$
\end_inset

 we can arbitrarily place the eigenvalues of 
\begin_inset Formula $A-GC$
\end_inset

.
\end_layout

\begin_layout Subsection
Estimator gain selection
\end_layout

\begin_layout Itemize
Procedure is similar to determining the gain matrix for statefeedback control.
\end_layout

\begin_layout Subsubsection
Example
\end_layout

\begin_layout Standard
3-dimensional (but can be generalized further).
\end_layout

\begin_layout Itemize
Write our system in observable canonical form
\begin_inset Formula \[
\dot{\bar{x}}=\begin{bmatrix}-a_{2} & 1 & 0\\
-a_{1} & 0 & 1\\
-a_{0} & 0 & 0\end{bmatrix}\bar{x}+\begin{bmatrix}b_{2}\\
b_{1}\\
b_{0}\end{bmatrix}u\]

\end_inset


\end_layout

\begin_layout Itemize
Form 
\begin_inset Formula $A-GC$
\end_inset

:
\begin_inset Formula \begin{eqnarray*}
A-GC & = & \begin{bmatrix}-a_{2} & 1 & 0\\
-a_{1} & 0 & 1\\
-a_{0} & 0 & 0\end{bmatrix}\underbrace{-\begin{bmatrix}G_{2}\\
G_{1}\\
G_{0}\end{bmatrix}\begin{bmatrix}1 & 0 & 0\end{bmatrix}}_{\begin{bmatrix}-G_{2} & 0 & 0\\
-G_{1} & 0 & 0\\
-G_{0} & 0 & 0\end{bmatrix}}\\
 & = & \begin{bmatrix}-a_{2}-G_{2} & 1 & 0\\
-a_{1}-G_{1} & 0 & 1\\
-a_{0}-G_{0} & 0 & 0\end{bmatrix}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
Poles of estimator
\begin_inset Formula \[
\det\left[\lambda I-\left(A-GC\right)\right]=0\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
\det\begin{bmatrix}\lambda+a_{2}+G_{2} & 1 & 0\\
a_{1}+G_{1} & \lambda & 1\\
a_{0}+G_{0} & 0 & \lambda\end{bmatrix} & = & 0\\
\left(\lambda+a_{2}+G_{2}\right)\lambda^{2}+\left(\lambda\left(a_{1}+G_{1}\right)\right)+a_{0}+G_{0} & = & 0\\
\lambda^{3}+\left(a_{2}+G_{2}\right)\lambda^{2}+\left(a_{1}+G_{1}\right)\lambda+a_{0}+G_{0} & = & 0\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
Since 
\begin_inset Formula $G$
\end_inset

 values apperar in each coefficient we can modify our characteristic equation
 to yield poles at arbitrary locations.
\end_layout

\begin_layout Paragraph
Alternatively
\end_layout

\begin_layout Itemize
Poles of
\begin_inset Formula \begin{eqnarray*}
\left(A-GC\right) & =\\
\left(A-GC\right)^{T} & = & A^{T}-C^{T}G^{T}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
Designing 
\begin_inset Formula $G^{T}$
\end_inset

 for our estimator looks like finding 
\begin_inset Formula $k$
\end_inset

 for our standard state feedfback regulator 
\begin_inset Formula $\left(A-Bk\right)$
\end_inset

.
\end_layout

\begin_layout Itemize
The estimator equivalent of Ackermann's formula (CHECK THIS)
\begin_inset Formula \[
G=\Phi_{e}\left(A\right)\Theta^{-1}\begin{bmatrix}0\\
0\\
\vdots\\
1\end{bmatrix}\]

\end_inset

Where 
\begin_inset Formula $\Phi_{e}\left(A\right)$
\end_inset

 is the characteristic equation for estimator evaluated with 
\begin_inset Formula $\lambda=A$
\end_inset


\end_layout

\begin_layout Subsubsection
Notes
\end_layout

\begin_layout Itemize
As the designer of the estimator you get to choose 
\begin_inset Formula $G$
\end_inset

 such that the estimator dynamics estimation error goes to zero in an appropriat
e time window.
\end_layout

\begin_layout Itemize
By selecting 
\begin_inset Formula $G$
\end_inset

 such that the estimator dynaimcs are much faster than the system dynamics
 
\begin_inset Formula $\left(A\right)$
\end_inset

, we will be able to 
\begin_inset Quotes eld
\end_inset

latch on
\begin_inset Quotes erd
\end_inset

 and track the state variables as time increases.
\end_layout

\begin_layout Itemize
Typically, estimator poles are chosen to be 5-10 times 
\begin_inset Quotes eld
\end_inset

faster
\begin_inset Quotes erd
\end_inset

 than the system dynamics.
\end_layout

\begin_layout Itemize
If you make the poles of 
\begin_inset Formula $A-GC$
\end_inset

 too fast you may be too sensitive to noise and uncertainty.
\end_layout

\begin_layout Subsubsection
Example
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \begin{bmatrix}-1 & 1.5\\
1 & -2\end{bmatrix}\bar{x}+\begin{bmatrix}1\\
0\end{bmatrix}u\\
y & = & \begin{bmatrix}1 & 0\end{bmatrix}\bar{x}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Assume initial conditions are not well known and compare the the performance
 of open and closd-loop estimators.
\begin_inset Formula \begin{eqnarray*}
\text{Note:}\\
EIG\left(A\right) & = & -0.1771,\,-2.8229\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
Check observability:
\begin_inset Formula \begin{eqnarray*}
\mathcal{O}\left(C,A\right) & = & \begin{bmatrix}C\\
CA\end{bmatrix}\\
 & = & \begin{bmatrix}\begin{matrix}1 & 0\end{matrix}\\
\begin{bmatrix}1 & 0\end{bmatrix}\begin{bmatrix}-1 & 1.5\\
1 & -2\end{bmatrix}\end{bmatrix}\\
 & = & \begin{bmatrix}1 & 0\\
-1 & 1.5\end{bmatrix}\end{eqnarray*}

\end_inset

Rank 
\begin_inset Formula $\left(\mathcal{O}\left(C,A\right)\right)=2$
\end_inset

 
\begin_inset Formula $\rightarrow$
\end_inset

 system is observable
\end_layout

\begin_layout Itemize

\series bold
Open-loop:
\series default

\begin_inset Formula \begin{eqnarray*}
\dot{\hat{\bar{x}}} & = & A\hat{\bar{x}}+Bu\\
\hat{\bar{y}} & = & C\hat{\bar{x}}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize

\series bold
Closed-loop
\series default

\begin_inset Formula \begin{eqnarray*}
\dot{\hat{\bar{x}}} & = & A\hat{\bar{x}}+Bu+G\left(y-\hat{y}\right)\\
 & = & \left(A-GC\right)\hat{\bar{x}}+B\bar{u}+GC\bar{x}\\
\\\hat{y} & = & C\hat{\bar{x}}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
Choose poles 
\begin_inset Formula $-8$
\end_inset

, 
\begin_inset Formula $-10$
\end_inset


\begin_inset Formula \begin{eqnarray*}
\text{Characteristic eq:}\\
\left(\lambda+8\right)\left(\lambda+10\right) & = & \lambda^{2}+18\lambda+80\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
G & = & \left(A^{2}+18A+80\right)\begin{bmatrix}1 & 0\\
-1 & 1.5\end{bmatrix}^{-1}\begin{bmatrix}0\\
1\end{bmatrix}\\
 & = & \begin{bmatrix}64.5 & 22.5\\
15 & 49.5\end{bmatrix}\begin{bmatrix}1 & 0\\
\frac{2}{3} & \frac{2}{3}\end{bmatrix}\begin{bmatrix}0\\
1\end{bmatrix}\\
 & = & \begin{bmatrix}15\\
33\end{bmatrix}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
Simulate
\end_layout

\begin_deeper
\begin_layout Itemize
Open-loop
\begin_inset Formula \begin{eqnarray*}
\begin{bmatrix}\dot{\bar{x}}\\
\dot{\hat{\bar{x}}}\end{bmatrix} & = & \begin{bmatrix}A & 0\\
0 & A\end{bmatrix}\begin{bmatrix}\bar{x}\\
\hat{\bar{x}}\end{bmatrix}+\begin{bmatrix}B\\
B\end{bmatrix}u\\
\begin{bmatrix}y\\
\hat{y}\end{bmatrix} & = & \begin{bmatrix}C & 0\\
0 & C\end{bmatrix}\begin{bmatrix}\bar{x}\\
\hat{\bar{x}}\end{bmatrix}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
Closed-loop
\begin_inset Formula \begin{eqnarray*}
\begin{bmatrix}\dot{\bar{x}}\\
\dot{\hat{\bar{x}}}\end{bmatrix} & = & \begin{bmatrix}A & 0\\
GC & A-GC\end{bmatrix}\begin{bmatrix}\bar{x}\\
\hat{\bar{x}}\end{bmatrix}+\begin{bmatrix}B\\
B\end{bmatrix}u\\
\begin{bmatrix}y\\
\hat{y}\end{bmatrix} & = & \begin{bmatrix}C & 0\\
0 & C\end{bmatrix}\begin{bmatrix}\bar{x}\\
\hat{\bar{x}}\end{bmatrix}\end{eqnarray*}

\end_inset


\end_layout

\end_deeper
\begin_layout Subsection
Reduced order estimators
\end_layout

\begin_layout Itemize
Full order estimators adds an additional 
\begin_inset Formula $n$
\end_inset

 states to the system and therefore doubles the complexity.
\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $D=0$
\end_inset

 and each component of our measurement 
\begin_inset Formula $y$
\end_inset

 is independent of the others (
\begin_inset Formula $C$
\end_inset

 is full rank) then we only need to estimate 
\begin_inset Formula $r=n-p$
\end_inset

 components of our system state.
\end_layout

\begin_layout Itemize
Illustrate a reduced order estimator for the speical case where the components
 of 
\begin_inset Formula $y$
\end_inset

 are simply components of 
\begin_inset Formula $\bar{x}$
\end_inset

.
\end_layout

\begin_layout Itemize
Order our states:
\begin_inset Formula \[
\bar{y}=\begin{Bmatrix}x_{1}\\
\vdots\\
x_{p}\\
-\\
x_{p+1}\\
\vdots\\
x_{n}\end{Bmatrix}=C\bar{x}\]

\end_inset


\begin_inset Formula \[
C=\begin{bmatrix}\underbrace{I_{p}}_{\left(p\times p\right)} & \underbrace{0_{p\times r}}_{\left(p\times r\text{ zero matrix}\right)}\end{bmatrix}\]

\end_inset


\begin_inset Formula \[
\bar{x}_{p}=\begin{Bmatrix}x_{1}\\
\vdots\\
x_{p}\end{Bmatrix}\]

\end_inset


\begin_inset Formula \[
\bar{x}_{r}=\begin{Bmatrix}x_{p+1}\\
\vdots\\
x_{n}\end{Bmatrix}\]

\end_inset


\end_layout

\begin_layout Itemize
Our system can be rewritten
\begin_inset Formula \[
\begin{Bmatrix}\dot{\bar{x}}_{p}\\
\dot{\bar{x}}_{r}\end{Bmatrix}=\begin{bmatrix}A_{pp} & A_{pr}\\
A_{rp} & A_{rr}\end{bmatrix}\begin{Bmatrix}\bar{x}_{p}\\
\bar{x}_{r}\end{Bmatrix}+\begin{bmatrix}B_{P}\\
B_{r}\end{bmatrix}u\]

\end_inset


\end_layout

\begin_layout Section
11/22/2010
\end_layout

\begin_layout Itemize
Reduced order observers
\end_layout

\begin_deeper
\begin_layout Itemize
Example
\end_layout

\end_deeper
\begin_layout Itemize
Combined regulators and observers
\end_layout

\begin_layout Subsection
Reduced order observers
\end_layout

\begin_layout Standard
\begin_inset Formula \[
\bar{y}=\begin{Bmatrix}x_{1}\\
\vdots\\
x_{p}\end{Bmatrix}\]

\end_inset


\begin_inset Formula \[
C=\begin{bmatrix}I_{p} & 0_{p\times r}\end{bmatrix}\]

\end_inset


\begin_inset Formula \[
\bar{x}_{p}=\begin{Bmatrix}x_{1}\\
\vdots\\
x_{p}\end{Bmatrix}\]

\end_inset


\begin_inset Formula \[
\bar{x}_{r}=\begin{Bmatrix}x_{p+1}\\
\vdots\\
x_{n}\end{Bmatrix}\]

\end_inset

Our resulting system can be written
\begin_inset Formula \[
\begin{Bmatrix}\dot{\bar{x}}_{p}\\
\dot{\bar{x}}_{r}\end{Bmatrix}=\begin{bmatrix}A_{pp} & A_{pr}\\
A_{rp} & A_{rr}\end{bmatrix}\begin{Bmatrix}\bar{x}_{p}\\
\bar{x}_{r}\end{Bmatrix}+\begin{bmatrix}B_{P}\\
B_{r}\end{bmatrix}u\]

\end_inset


\begin_inset Formula \[
y=\begin{bmatrix}I_{p} & O_{p\times r}\end{bmatrix}\begin{Bmatrix}\bar{x}_{p}\\
\bar{x}_{r}\end{Bmatrix}\]

\end_inset

Here 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 are partitioned to match our measured 
\begin_inset Formula $\left(\bar{x}_{p}\right)$
\end_inset

 and unmeasured 
\begin_inset Formula $\left(\bar{x}_{r}\right)$
\end_inset

 states
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}}_{p} & = & A_{pp}\bar{x}_{p}+A_{pr}\bar{x}_{r}+B_{p}u\\
\dot{\bar{x}}_{r} & = & A_{rp}\bar{x}_{p}+A_{rr}\bar{x}_{r}+B_{r}u\end{eqnarray*}

\end_inset

Define a nwe output
\begin_inset Formula \[
\bar{z}=\dot{\bar{x}}_{p}-A_{pp}\bar{x}_{p}-B_{p}u\]

\end_inset


\end_layout

\begin_layout Itemize

\series bold
Note:
\series default
 
\begin_inset Formula $\bar{z}$
\end_inset

 can be computed directly as we konw 
\begin_inset Formula $\bar{x}_{p}$
\end_inset

 and u.
\end_layout

\begin_layout Itemize
While 
\begin_inset Formula $\dot{\bar{x}}_{p}=\dot{\bar{y}}$
\end_inset

, it is generally not a good idea to differentiate a signal (due to discontinuit
ies or noise).
\end_layout

\begin_layout Itemize
With our new output our new state equations are a 
\begin_inset Formula $r^{th}$
\end_inset

 order LTI system with a state matrix of 
\begin_inset Formula $A_{rr}$
\end_inset

.
\end_layout

\begin_layout Itemize
Desing an observer gain 
\begin_inset Formula $G$
\end_inset

 for our reduced order system.
\begin_inset Formula \begin{eqnarray*}
\dot{\hat{\bar{x}}}_{r} & = & A_{rr}\hat{\bar{x}}_{r}+A_{rp}\bar{x}_{p}+B_{r}u+G\left(\bar{z}-A_{pr}\hat{\bar{x}}_{r}\right)\\
 & = & A_{rr}\hat{\bar{x}}_{r}+A_{rp}\bar{x}_{p}+B_{r}u+G\left(\dot{\bar{x}}_{p}-A_{pp}\bar{x}_{p}-B_{p}u-A_{pr}\hat{\bar{x}}_{r}\right)\end{eqnarray*}

\end_inset

Rearrange
\begin_inset Formula \begin{equation}
\dot{\hat{\bar{x}}}_{r}=\left(A_{rr}-GA_{pr}\right)\hat{\bar{x}}_{r}+\left(A_{rp}-GA_{pp}\right)\bar{x}_{p}+\left(B_{r}-GB_{p}\right)u+G\dot{\bar{x}}_{p}\label{eq:dothatxr}\end{equation}

\end_inset

Design 
\begin_inset Formula $G$
\end_inset

 such that 
\begin_inset Formula $\left(A_{rr}-GA_{pr}\right)$
\end_inset

 is stable avoid differentiating 
\begin_inset Formula $\bar{x}_{p}$
\end_inset

 by bringing that term to the left hand side and make a change of variables.
\begin_inset Formula \[
\bar{\psi}=\hat{\bar{x}}_{r}-G\bar{x}_{p}\]

\end_inset


\begin_inset Formula \[
\hat{\bar{x}}_{r}=\bar{\psi}+G\bar{x}_{p}\]

\end_inset

Substitue into 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:dothatxr"

\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{\bar{\psi}}+G\dot{\bar{x}}_{p} & = & \left(A_{rr}-GA_{pr}\right)\left(\bar{\psi}+G\bar{x}_{p}\right)+\left(A_{rp}-GA_{pp}\right)\bar{x}_{p}+\left(B_{r}-GB_{p}\right)u+G\dot{\bar{x}}_{p}\\
\dot{\bar{\psi}} & = & \left(A_{rr}-GA_{pr}\right)\bar{\psi}+\left(A_{rr}G-GA_{pr}G+A_{rp}-GA_{pp}\right)\hat{\bar{x}}_{p}+\left(B_{r}-GB_{p}\right)u\end{eqnarray*}

\end_inset

Our partial state estimate 
\begin_inset Formula $\hat{\bar{x}}_{r}=\bar{\psi}+G\bar{x}_{p}$
\end_inset

 can be computed as our 
\begin_inset Formula $\dot{\bar{\psi}}$
\end_inset

 equation is integrated.
\end_layout

\begin_layout Subsubsection
General case
\end_layout

\begin_layout Standard
The components of 
\begin_inset Formula $y$
\end_inset

 are not necessarily components of 
\begin_inset Formula $\bar{x}$
\end_inset

.
 If 
\begin_inset Formula $C$
\end_inset

 is full rank (rank p) there exists a transformation 
\begin_inset Formula $q=T\bar{x}$
\end_inset

 for which the first 
\begin_inset Formula $p$
\end_inset

 components of 
\begin_inset Formula $q$
\end_inset

 are the outputs 
\begin_inset Formula $\bar{y}$
\end_inset

.
 The desired transformation matrix
\begin_inset Formula \[
T=\begin{bmatrix}C\\
S\end{bmatrix}\]

\end_inset


\begin_inset Formula $S$
\end_inset

 is any 
\begin_inset Formula $r\times n$
\end_inset

 matrix whose 
\begin_inset Formula $r$
\end_inset

 rows are independent of the rows of 
\begin_inset Formula $C$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $T$
\end_inset

 is full rank and invertible.
\end_layout

\begin_layout Itemize
The design procedure is as before but int he new 
\begin_inset Formula $\bar{q}$
\end_inset

 coordinates, rather than 
\begin_inset Formula $\bar{x}$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Example
\end_layout

\begin_layout Standard
\begin_inset Formula \[
\dot{\bar{x}}=\begin{bmatrix}0 & 1\\
-49 & -2\end{bmatrix}\bar{x}+\begin{bmatrix}0\\
1\end{bmatrix}u\]

\end_inset


\begin_inset Formula \[
y=\begin{bmatrix}1 & 0\end{bmatrix}\bar{x}+0u\]

\end_inset


\end_layout

\begin_layout Enumerate
Full order observer
\end_layout

\begin_layout Enumerate
Reduced order observer
\end_layout

\begin_layout Itemize
Check observability
\begin_inset Formula \[
\mathcal{O}=\begin{bmatrix}C\\
CA\end{bmatrix}=\begin{bmatrix}\begin{matrix}1 & 0\end{matrix}\\
\begin{bmatrix}1 & 0\end{bmatrix}\begin{bmatrix}0 & 1\\
-49 & -2\end{bmatrix}\end{bmatrix}=\underbrace{\begin{bmatrix}1 & 0\\
0 & 1\end{bmatrix}}_{\text{rank }\mathcal{O}=2}\]

\end_inset


\begin_inset Formula $\rightarrow$
\end_inset

 observable.
\end_layout

\begin_layout Itemize
Eigenvalues of 
\begin_inset Formula $A$
\end_inset

 
\begin_inset Formula $\rightarrow$
\end_inset

 
\begin_inset Formula $\det\left(\lambda I-A\right)=0$
\end_inset


\begin_inset Formula \[
\lambda=-1\pm6.9282i\]

\end_inset


\end_layout

\begin_layout Itemize
Choose observer poles faster than our dominant dynamics
\begin_inset Formula \[
\lambda_{o}=-7\text{ (twice)}\]

\end_inset


\end_layout

\begin_layout Itemize
Desired characteristic equation 
\begin_inset Formula $\left(\lambda+7\right)^{2}$
\end_inset


\begin_inset Formula \[
\lambda^{2}+14\lambda+49=0\]

\end_inset


\end_layout

\begin_layout Itemize
Ackermann's formula for an observer
\begin_inset Formula \begin{eqnarray*}
G & = & \left(A^{2}+14A+49I\right)\underbrace{\begin{bmatrix}1 & 0\\
0 & 1\end{bmatrix}^{-1}}_{\mathcal{O}^{-1}}\underbrace{\begin{bmatrix}0\\
1\end{bmatrix}}_{B}\\
 & = & \left(A^{2}+14A+49I\right)\begin{bmatrix}0\\
1\end{bmatrix}\\
G & = & \begin{bmatrix}12\\
-24\end{bmatrix}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
Simulate:
\begin_inset Formula \[
\dot{\bar{x}}=A\bar{x}+Bu\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{\hat{\bar{x}}} & = & A\hat{\bar{x}}+Bu+G\left(y-\hat{y}\right)\\
 & = & \left(A-GC\right)\hat{\bar{x}}+Bu+GC\bar{x}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\begin{bmatrix}\dot{\bar{x}}\\
\dot{\hat{\bar{x}}}\end{bmatrix} & = & \begin{bmatrix}A & 0\\
GC & A-GC\end{bmatrix}\begin{bmatrix}\bar{x}\\
\hat{\bar{x}}\end{bmatrix}+\begin{bmatrix}B\\
B\end{bmatrix}u\\
\begin{bmatrix}y\\
\hat{y}\end{bmatrix} & = & \begin{bmatrix}C & 0\\
0 & C\end{bmatrix}\begin{bmatrix}\bar{x}\\
\hat{\bar{x}}\end{bmatrix}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
Reduced order observer:
\end_layout

\begin_deeper
\begin_layout Itemize
system is already in desired form
\begin_inset Formula \[
x_{p}=x_{1},\ x_{r}=x_{2}\]

\end_inset


\begin_inset Formula \[
\begin{bmatrix}\dot{x}_{p}\\
\dot{x}_{r}\end{bmatrix}=\begin{bmatrix}0 & 1\\
-49 & -2\end{bmatrix}\begin{bmatrix}x_{p}\\
x_{r}\end{bmatrix}+\begin{bmatrix}0\\
1\end{bmatrix}u\]

\end_inset


\end_layout

\begin_layout Itemize
Compare our system with the partitioned prototype system
\begin_inset Formula \begin{eqnarray*}
A_{pp} & = & 0\\
A_{pr} & = & 1\\
A_{rp} & = & -49\\
A_{rr} & = & -2\\
B_{p} & = & 0\\
B_{r} & = & 1\end{eqnarray*}

\end_inset

From before, use equation for 
\begin_inset Formula $\dot{\bar{\psi}}$
\end_inset


\begin_inset Formula \[
\dot{\psi}=\left(A_{rr}-GA_{pr}\right)\psi+\left(A_{rr}G-GA_{pr}G+A_{rp}-GA_{pp}\right)x_{p}+\left(B_{r}-GB_{p}\right)u\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
G & = & \text{PLACE}\left(A_{rr,}A_{pr,}-10\right)\\
 & = & 8\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
Substitue this 
\begin_inset Formula $G$
\end_inset

 value and all other 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 values
\begin_inset Formula \begin{eqnarray*}
\dot{\psi} & = & -10\psi+\left(-2\left(8\right)-8\left(1\right)8-49-8\left(0\right)\right)x_{p}+\left(1-8\left(0\right)\right)u\\
 & = & -10\psi-129x_{p}+u\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\hat{\bar{x}}_{r} & = & \bar{\psi}+G\bar{x}_{p}\\
 & = & \psi+8x_{p}\end{eqnarray*}

\end_inset


\end_layout

\end_deeper
\begin_layout Subsection
Combined estimators & regulators
\end_layout

\begin_layout Itemize
Since our state estimate converges (by design) to our actual state, go ahead
 and use our state estimate in the control law.
\begin_inset Formula \[
\bar{u}=-K\hat{\bar{x}}+\tilde{N}\bar{r}\]

\end_inset


\end_layout

\begin_layout Itemize
Assume we have designed a state estimator
\begin_inset Formula \[
\dot{\hat{\bar{x}}}=A\hat{\bar{x}}+B\bar{u}+G\left(\bar{y}-\hat{\bar{y}}\right)\]

\end_inset


\begin_inset Formula \[
\hat{\bar{y}}=C\hat{\bar{x}}\]

\end_inset


\end_layout

\begin_layout Paragraph
Closed-loop dynamics
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}+B\bar{u}\\
\dot{\hat{\bar{x}}} & = & A\hat{\bar{x}}+B\bar{u}+G\left(\bar{y}-\hat{\bar{y}}\right)\\
\bar{y} & = & C\bar{x}\\
\hat{\bar{y}} & = & C\hat{\bar{x}}\end{eqnarray*}

\end_inset

Substitute 
\begin_inset Formula $\bar{u}$
\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & A\bar{x}-Bk\hat{\bar{x}}+B\tilde{N}\bar{r}\\
\dot{\hat{\bar{x}}} & = & A\hat{\bar{x}}-Bk\hat{\bar{x}}+B\tilde{N}\bar{r}+GC\bar{x}-GC\hat{\bar{x}}\end{eqnarray*}

\end_inset

Rearrange:
\begin_inset Formula \[
\begin{bmatrix}\dot{\bar{x}}\\
\dot{\hat{\bar{x}}}\end{bmatrix}=\begin{bmatrix}A & -BK\\
GC & A-BK-GC\end{bmatrix}\begin{bmatrix}\bar{x}\\
\hat{\bar{x}}\end{bmatrix}+\begin{bmatrix}B\tilde{N}\\
B\tilde{N}\end{bmatrix}\bar{r}\]

\end_inset


\begin_inset Formula \[
\begin{bmatrix}\bar{y}\\
\hat{\bar{y}}\end{bmatrix}=\begin{bmatrix}C & 0\\
0 & C\end{bmatrix}\begin{bmatrix}\bar{x}\\
\hat{\bar{x}}\end{bmatrix}\]

\end_inset


\end_layout

\begin_layout Itemize

\series bold
Question:
\series default
 Have the closed-loop poles changed from our designed values?
\end_layout

\begin_layout Standard
Introduce a new variable
\begin_inset Formula \[
\tilde{\bar{x}}=\bar{x}-\hat{\bar{x}}\text{ (estimation error)}\]

\end_inset

and convert our system into these coordinates by a similarity transformation
\begin_inset Formula \[
\begin{bmatrix}\bar{x}\\
\tilde{\bar{x}}\end{bmatrix}=\underbrace{\begin{bmatrix}I & 0\\
I & -I\end{bmatrix}}_{T}\begin{bmatrix}\bar{x}\\
\hat{\bar{x}}\end{bmatrix}\]

\end_inset

(note: 
\begin_inset Formula $T=T^{-1}$
\end_inset

)
\begin_inset Formula \[
\begin{bmatrix}I & 0\\
I & -I\end{bmatrix}\begin{bmatrix}\dot{\bar{x}}\\
\dot{\tilde{\bar{x}}}\end{bmatrix}=\begin{bmatrix}A & -BK\\
GC & A-BK-GC\end{bmatrix}\begin{bmatrix}I & 0\\
I & -I\end{bmatrix}\begin{bmatrix}\bar{x}\\
\tilde{\bar{x}}\end{bmatrix}+\begin{bmatrix}B\tilde{N}\\
B\tilde{N}\end{bmatrix}\bar{r}\]

\end_inset


\begin_inset Formula \[
\begin{bmatrix}\dot{\bar{x}}\\
\dot{\tilde{\bar{x}}}\end{bmatrix}=\begin{bmatrix}A-BK & -BK\\
0 & A-GC\end{bmatrix}\begin{bmatrix}\bar{x}\\
\tilde{\bar{x}}\end{bmatrix}+\begin{bmatrix}B\tilde{N}\\
0\end{bmatrix}\bar{r}\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
11/29/2010
\end_layout

\begin_layout Itemize
Finish combined estimators and regulators
\end_layout

\begin_layout Itemize
Example
\end_layout

\begin_layout Itemize
LQR basics
\end_layout

\begin_layout Subsection
Combined estimators and regulators continued
\end_layout

\begin_layout Standard
\begin_inset Formula \[
\begin{bmatrix}\dot{\bar{x}}\\
\dot{\tilde{\bar{x}}}\end{bmatrix}=\begin{bmatrix}A-BK & -BK\\
0 & A-GC\end{bmatrix}\begin{bmatrix}\bar{x}\\
\tilde{\bar{x}}\end{bmatrix}+\begin{bmatrix}B\tilde{N}\\
0\end{bmatrix}\bar{r}\]

\end_inset


\begin_inset Formula $\rightarrow$
\end_inset

 The closed-loop poles for the combined system will be those designed for
 the regulator and estimator 
\begin_inset Formula $\rightarrow$
\end_inset

 This is called the 
\bar under
separation principle
\bar default
.
\end_layout

\begin_layout Itemize
We can design our regulator and estimator separately and combine them at
 the end.
 Our resulting system should behave (more or less) as if the true states
 were being utilized in our feedback control.
\end_layout

\begin_layout Standard

\series bold
Note:
\series default
 We want our state estimate to converge quickly in comparison to the system
 dynamics.
\end_layout

\begin_layout Itemize
Rule of thumb: choose the real part of the dominant eigenvalues of our estimator
 to be 5-10 times the real part of the dominant eigenvalues of the closed-loop
 system.
\end_layout

\begin_layout Subsection
Example: Electromagnet and Ball Problem
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
\bar{x} & = & \begin{bmatrix}h\\
\dot{h}\\
I\end{bmatrix}\\
\\h & = & \text{height of ball}\\
I & = & \text{input current}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \begin{bmatrix}0 & 1 & 0\\
980 & 0 & -2.8\\
0 & 0 & -100\end{bmatrix}\bar{x}+\begin{bmatrix}0\\
0\\
100\end{bmatrix}u\\
y & = & \begin{bmatrix}1 & 0 & 0\end{bmatrix}\bar{x}\\
\\u & = & \text{input voltage}\end{eqnarray*}

\end_inset

Want 
\begin_inset Formula $T_{s}<0.5\ sec.$
\end_inset


\end_layout

\begin_layout Subsubsection
Design a regulator (see matlab script)
\end_layout

\begin_layout Itemize
Poles of 
\begin_inset Formula $A$
\end_inset

? (do I need control?)
\end_layout

\begin_layout Itemize
Use ITAE to find pole locations (see script)
\end_layout

\begin_layout Itemize
Make the ball move upwards by 
\begin_inset Formula $0.001\, m$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Design a full order estimator
\end_layout

\begin_layout Standard
\begin_inset Formula \[
u=-K\hat{\bar{x}}+r\]

\end_inset


\end_layout

\begin_layout Itemize
Check observability
\end_layout

\begin_layout Itemize
\begin_inset Formula $\begin{bmatrix}\dot{\bar{x}}\\
\dot{\underbrace{\tilde{\bar{x}}}_{\text{estimator error}}}\end{bmatrix}=\begin{bmatrix}A-BK & -BK\\
0 & A-GC\end{bmatrix}\begin{bmatrix}\bar{x}\\
\tilde{\bar{x}}\end{bmatrix}+\begin{bmatrix}B\tilde{N}\\
0\end{bmatrix}\bar{r}$
\end_inset


\end_layout

\begin_layout Subsubsection
Design a reduced order estimator
\end_layout

\begin_layout Itemize
Know h, just estimate 
\begin_inset Formula $\dot{h}$
\end_inset

, and 
\begin_inset Formula $I$
\end_inset

.
\end_layout

\begin_layout Itemize
Use 
\begin_inset Formula $\dot{\psi}$
\end_inset

 equation.
\end_layout

\begin_deeper
\begin_layout Itemize
system is already in the correct form
\begin_inset Formula \[
x_{p}=x_{1}=h\]

\end_inset


\begin_inset Formula \[
x_{r}=\begin{bmatrix}x_{2}\\
x_{3}\end{bmatrix}=\begin{bmatrix}\dot{h}\\
I\end{bmatrix}\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
A_{pp} & = & 0\\
A_{pr} & = & \begin{bmatrix}1 & 0\end{bmatrix}\\
A_{rp} & = & \begin{bmatrix}980\\
0\end{bmatrix}\\
A_{rr} & = & \begin{bmatrix}0 & -2.8\\
0 & -100\end{bmatrix}\end{eqnarray*}

\end_inset


\begin_inset Formula \begin{eqnarray*}
B_{p} & = & 0\\
B_{r} & = & \begin{bmatrix}0\\
100\end{bmatrix}\end{eqnarray*}

\end_inset


\begin_inset Formula \[
G=\text{place}\left(A_{rr}',A_{pr}',\begin{bmatrix}-90 & -95\end{bmatrix}\right)'\]

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
12/1/2010
\end_layout

\begin_layout Itemize
LQR basics
\end_layout

\begin_layout Subsection
Linear quadratic regulators design
\end_layout

\begin_layout Standard
LTI system
\begin_inset Formula \[
\dot{\bar{x}}=A\bar{x}+B\bar{u}\]

\end_inset


\end_layout

\begin_layout Standard
Find input 
\begin_inset Formula $\bar{u}=f(x)$
\end_inset

 which stabilizes the origin.
 While minimizing a cost function
\begin_inset Formula \[
J=\int_{0}^{\infty}\,\bar{x}^{T}Q\bar{x}+\bar{u}^{T}R\bar{u}\, dt\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
Q & = & Q^{T}\ge0\\
R & = & R^{T}>0\end{eqnarray*}

\end_inset


\begin_inset Formula $Q$
\end_inset

 and 
\begin_inset Formula $R$
\end_inset

 are state and control penalty matrices.
 
\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $Q\gg R$
\end_inset

 system should converge faster with larger control effort.
\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $Q\ll R$
\end_inset

 system convergence is slower with smaller control effort.
\end_layout

\begin_layout Standard
The control law that minimizes 
\begin_inset Formula $J$
\end_inset

 is 
\begin_inset Formula $\bar{u}=-K\bar{x}$
\end_inset

 such that:
\begin_inset Formula \begin{eqnarray*}
\dot{\bar{x}} & = & \left(A-BK\right)\bar{x}\\
\\J & = & \int_{0}^{\infty}\,\bar{x}^{T}Q\bar{x}+\bar{x}^{T}K^{T}RK\bar{x}\, dt\\
 & = & \int_{0}^{\infty}\,\bar{x}^{T}\underbrace{\left(Q+K^{T}RK\right)}_{S}\bar{x}\, dt\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsubsection
Theorem
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $\dot{\bar{x}}=\tilde{A}\bar{x}$
\end_inset

 
\begin_inset Formula $\bar{x}\left(0\right)=\bar{x}_{0}$
\end_inset

 where 
\begin_inset Formula $\tilde{A}$
\end_inset

 is hurwitz, let 
\begin_inset Formula $S=S^{T}\ge0$
\end_inset

 then
\begin_inset Formula \[
J=\int_{0}^{\infty}\,\bar{x}^{T}S\bar{x}\, dt=\bar{x}_{0}^{T}P\bar{x}_{0}\]

\end_inset

where 
\begin_inset Formula $P=P^{T}\ge0$
\end_inset

 solution to the matrix Lyapunov equation
\begin_inset Formula \[
\tilde{A}^{T}P+P\tilde{A}=-S\]

\end_inset


\end_layout

\begin_layout Standard
If we are given 
\begin_inset Formula $K$
\end_inset

, 
\begin_inset Formula $Q$
\end_inset

, 
\begin_inset Formula $R$
\end_inset

, 
\begin_inset Formula $\bar{x}_{0}$
\end_inset

 we can compute the value of our cost function 
\begin_inset Formula $J$
\end_inset

.
 Matrix Lyapunov equation is just a set of linear algebraic equations for
 the 
\begin_inset Formula $\frac{1}{2}n\left(n+1\right)$
\end_inset

 distinct values of 
\begin_inset Formula $P$
\end_inset

 and can be solved easily.
\end_layout

\begin_layout Itemize
Goal is to design 
\begin_inset Formula $K$
\end_inset

 such that 
\begin_inset Formula $J$
\end_inset

 is minimized for a particular initial condition 
\begin_inset Formula $\bar{x}_{0}$
\end_inset

.
\end_layout

\begin_layout Paragraph
Potential problem:
\end_layout

\begin_layout Standard
Finding a 
\begin_inset Formula $K$
\end_inset

 which minimizes 
\begin_inset Formula $J$
\end_inset

 means that you need to find 
\begin_inset Formula $K$
\end_inset

 that minimizes 
\begin_inset Formula \[
\begin{pmatrix}\frac{\delta J}{\delta k_{1}}\\
\vdots\\
\frac{\delta J}{\delta k_{z}}\end{pmatrix}_{K^{*}}=\bar{0}\]

\end_inset

and the Hessian
\begin_inset Formula \[
\begin{bmatrix}\frac{\delta^{2}J}{\delta k_{1}^{2}} & \dots & \frac{\delta^{2}J}{\delta k_{1}k_{z}}\\
\vdots & \ddots & \vdots\\
\frac{\delta^{2}J}{\delta k_{1}k_{z}} & \dots & \frac{\delta^{2}J}{\delta k_{z}^{2}}\end{bmatrix}_{K^{*}}>0\]

\end_inset

The resulting 
\begin_inset Formula $K^{*}$
\end_inset

 may not result in a Hurwitz 
\begin_inset Formula $A-BK^{*}$
\end_inset

 which violates an assumption of the theorem.
\end_layout

\begin_layout Subsubsection
Theorem:
\end_layout

\begin_layout Standard
Suppose there exists a matrix 
\begin_inset Formula $P=P^{T}\ge0$
\end_inset

 which satisfies
\begin_inset Formula \[
\tilde{A}^{T}P+P\tilde{A}=-S\]

\end_inset

with 
\begin_inset Formula \[
S=S^{T}\ge0\]

\end_inset

Furthermore, suppose that the pair 
\begin_inset Formula $\left(S^{\frac{1}{2}},A\right)$
\end_inset

 is detectable.
 Then, 
\begin_inset Formula $\tilde{A}$
\end_inset

 is Hurwitz.
\end_layout

\begin_layout Standard
\begin_inset Formula $S^{\frac{1}{2}}$
\end_inset

 represents any matrix satisfying 
\begin_inset Formula \[
\left(S^{\frac{1}{2}}\right)^{T}S^{\frac{1}{2}}=S\]

\end_inset


\end_layout

\begin_layout Paragraph
Note
\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $S\ge0$
\end_inset

, at least one matrix 
\begin_inset Formula $S^{\frac{1}{2}}$
\end_inset

 exists.
\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $S>0$
\end_inset

, there exists a square, full rank 
\begin_inset Formula $S^{\frac{1}{2}}$
\end_inset

 such that 
\begin_inset Formula $\left(S^{\frac{1}{2}},A\right)$
\end_inset

 is detectable.
\end_layout

\begin_layout Subsubsection
Summary
\end_layout

\begin_layout Standard
Find 
\begin_inset Formula $K$
\end_inset

 for 
\begin_inset Formula $\bar{u}=-K\bar{x}$
\end_inset

 such that 
\begin_inset Formula $\dot{\bar{x}}=\left(A-BK\right)\bar{x}=\tilde{A}\bar{x}$
\end_inset

 is stable while minimizing
\begin_inset Formula \[
J=\int_{0}^{\infty}\,\bar{x}^{T}Q\bar{x}+\bar{x}^{T}K^{T}RK\bar{x}\, dt==\int_{0}^{\infty}\,\bar{x}^{T}S\bar{x}\, dt\]

\end_inset

with 
\begin_inset Formula $Q=Q^{T}\ge0$
\end_inset

, 
\begin_inset Formula $R=R^{T}>0$
\end_inset

 and the minimum cost is 
\begin_inset Formula $J=\bar{x}_{0}^{T}P\bar{x}_{0}$
\end_inset

 and 
\begin_inset Formula $P$
\end_inset

 solves 
\begin_inset Formula $\tilde{A}P+P\tilde{A}=-S$
\end_inset

.
\end_layout

\begin_layout Standard
Solving this set of linear equations for 
\begin_inset Formula $P\left(k\right)$
\end_inset

 determines A minimizing gain matrix 
\begin_inset Formula $K$
\end_inset

.
\end_layout

\begin_layout Itemize
The 
\begin_inset Formula $K$
\end_inset

 matrix will stabilize our system as long as 
\begin_inset Formula $\left(S^{\frac{1}{2}},A\right)$
\end_inset

 is detectable.
\end_layout

\begin_layout Itemize
A sufficient conditionfor 
\begin_inset Formula $\left(S^{\frac{1}{2}},A\right)$
\end_inset

 to be detectable is that 
\begin_inset Formula $\left(Q^{\frac{1}{2}},A\right)$
\end_inset

 is detectable.
\end_layout

\begin_layout Subsection
LQR problem statement
\end_layout

\begin_layout Standard
Given a stabilizable LTI system
\begin_inset Formula \[
\dot{\bar{x}}=A\bar{x}+B\bar{u}\]

\end_inset

find the gain matrix 
\begin_inset Formula $K$
\end_inset

, for 
\begin_inset Formula $\bar{u}=-K\bar{x}$
\end_inset

 which minimizes 
\begin_inset Formula \[
J=\int_{0}^{\infty}\,\bar{x}^{T}Q\bar{x}+\bar{u}^{T}R\bar{u}\, dt\]

\end_inset

with 
\begin_inset Formula $R=R^{T}>0$
\end_inset

, 
\begin_inset Formula $Q=Q^{T}\ge0$
\end_inset

 and 
\begin_inset Formula $\left(A,Q^{\frac{1}{2}}\right)$
\end_inset

 detectable.
\end_layout

\begin_layout Subsubsection
Theorem
\end_layout

\begin_layout Standard
The gain matrix 
\begin_inset Formula $K$
\end_inset

 that solves the LQR problem is 
\begin_inset Formula \[
K=R^{-1}B^{T}P^{*}\]

\end_inset

where 
\begin_inset Formula $P^{*}$
\end_inset

 is the unique, positive semidefinite solution to the algebraic Ricatti
 equation (ARE)
\begin_inset Formula \[
A^{T}P^{*}+P^{*}A-P^{*}BR^{-1}B^{T}P^{*}+Q=0\]

\end_inset

which comes from
\begin_inset Formula \[
\left(A-BK^{*}\right)^{T}P^{*}+P^{*}\left(A-BK^{*}\right)=-Q-K^{*^{T}}RK^{*}\]

\end_inset


\end_layout

\begin_layout Itemize
Our optimal control problem simpifies to finding 
\begin_inset Formula $P^{*}$
\end_inset

 that statisfies the ARE such that 
\begin_inset Formula $K^{*}=R^{-1}B^{T}P^{*}$
\end_inset


\end_layout

\begin_layout Itemize
Numerical routines have been developed to help (Matlab)
\begin_inset Formula \[
P^{*}=\text{ARE}\left(A,BR^{-1}B^{T},Q\right)\]

\end_inset


\begin_inset Formula \[
\left[K^{*},P^{*},E\right]=\text{LQR}\left(A,B,Q,R\right)\]

\end_inset


\end_layout

\begin_layout Subsection
Guidelines for choosing 
\begin_inset Formula $Q$
\end_inset

 and 
\begin_inset Formula $R$
\end_inset


\end_layout

\begin_layout Standard
Common approach is to nondimensionalize the cost function and then choose
 
\begin_inset Formula $Q$
\end_inset

 and 
\begin_inset Formula $R$
\end_inset

 such that
\begin_inset Formula \[
Q=\begin{bmatrix}\frac{Q_{1}}{\tilde{x}_{1}^{2}} & 0 & \dots & 0\\
0 & \frac{Q_{2}}{\tilde{x}_{2}^{2}} & \dots & 0\\
\vdots & \vdots & \ddots & \vdots\\
0 & 0 & \dots & \frac{Q_{n}}{\tilde{x}_{n}^{2}}\end{bmatrix}\]

\end_inset


\begin_inset Formula \[
R=\begin{bmatrix}\frac{R_{1}}{\tilde{u}_{1}^{2}} & 0 & \dots & 0\\
0 & \frac{R_{2}}{\tilde{u}_{2}^{2}} & \dots & 0\\
\vdots & \vdots & \ddots & \vdots\\
0 & 0 & \dots & \frac{R_{n}}{\tilde{u}_{n}^{2}}\end{bmatrix}\]

\end_inset

All 
\begin_inset Formula $Q_{i}\ge0$
\end_inset

, 
\begin_inset Formula $R_{j}>0$
\end_inset

 and 
\begin_inset Formula $\tilde{x}_{i}$
\end_inset

 is a desired upper bound on 
\begin_inset Formula $x_{i}\left(t\right)$
\end_inset

 and 
\begin_inset Formula $\tilde{u}_{j}$
\end_inset

 a desired upper bound on 
\begin_inset Formula $u_{j}\left(t\right)$
\end_inset

.
\end_layout

\begin_layout Paragraph
Cost function:
\end_layout

\begin_layout Standard
\begin_inset Formula \[
J=\int_{0}^{\infty}\,\tilde{\bar{x}}^{T}Q\tilde{\bar{x}}+\tilde{\bar{u}}^{T}R\tilde{\bar{u}}\, dt\]

\end_inset


\end_layout

\begin_layout Paragraph
Rule of thumb:
\end_layout

\begin_layout Standard
Start with 
\begin_inset Formula $\tilde{R}=I$
\end_inset

 and 
\begin_inset Formula $\tilde{Q}=10I$
\end_inset


\end_layout

\begin_layout Itemize
Simulate the system with computed 
\begin_inset Formula $K^{*}$
\end_inset

 and a representative initial condition.
\end_layout

\begin_layout Itemize
Tweak 
\begin_inset Formula $\tilde{R}$
\end_inset

 and 
\begin_inset Formula $\tilde{Q}$
\end_inset

 to obtain desired performance.
 Increase 
\begin_inset Formula $Q_{i}$
\end_inset

 to speed convergence of 
\begin_inset Formula $\tilde{x}_{i}$
\end_inset

, increase 
\begin_inset Formula $R_{j}$
\end_inset

 to reduce control effort 
\begin_inset Formula $\tilde{u}_{j}$
\end_inset

.
\end_layout

\begin_layout Subsection
LQR example
\end_layout

\begin_layout Standard
Inverted pendulum on a cart.
\end_layout

\begin_layout Standard
Linearization:
\begin_inset Formula \begin{eqnarray*}
\frac{d}{dt}\begin{bmatrix}x\\
\dot{x}\\
\theta\\
\dot{\theta}\end{bmatrix} & = & \begin{bmatrix}0 & 1 & 0 & 0\\
0 & -0.1818 & 2.6727 & 0\\
0 & 0 & 0 & 1\\
0 & -0.4545 & 31.1818 & 0\end{bmatrix}\bar{x}+\begin{bmatrix}0\\
1.8182\\
0\\
4.5455\end{bmatrix}u\\
\bar{y} & = & \begin{bmatrix}1 & 0 & 0 & 0\\
0 & 0 & 1 & 0\end{bmatrix}\bar{x}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
See matlab script
\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
\start_of_appendix
Matrix Math
\end_layout

\begin_layout Subsection
Determinants
\end_layout

\begin_layout Subsubsection
\begin_inset Formula $2\times2$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \[
\det\begin{bmatrix}a & b\\
c & d\end{bmatrix}\equiv\begin{vmatrix}a & b\\
c & d\end{vmatrix}\equiv ad-bc\]

\end_inset


\end_layout

\begin_layout Subsubsection
\begin_inset Formula $3\times3$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \[
\det\begin{bmatrix}a_{1} & a_{2} & a_{3}\\
b_{1} & b_{2} & b_{3}\\
c_{1} & c_{2} & c_{3}\end{bmatrix}=a_{1}\left(b_{2}c_{3}-b_{3}c_{2}\right)-a_{2}\left(b_{1}c_{3}-b_{3}c_{1}\right)+a_{3}\left(b_{1}c_{2}-b_{2}c_{1}\right)\]

\end_inset


\end_layout

\begin_layout Subsubsection
\begin_inset Formula $k\times k$
\end_inset


\end_layout

\begin_layout Standard
A 
\begin_inset Formula $k\times k$
\end_inset

 determinant can be expanded "by minors" to obtain
\begin_inset Formula \[
\begin{vmatrix}a_{11} & a_{12} & a_{13} & \dots & a_{1k}\\
a_{21} & a_{22} & a_{23} & \dots & a_{2k}\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
a_{k1} & a_{k2} & a_{k3} & \dots & a_{kk}\end{vmatrix}=a_{11}\begin{vmatrix}a_{22} & a_{23} & \dots & a_{2k}\\
\vdots & \vdots & \ddots & \vdots\\
a_{k2} & a_{k3} & \dots & a_{kk}\end{vmatrix}-a_{12}\begin{vmatrix}a_{21} & a_{23} & \dots & a_{2k}\\
\vdots & \vdots & \ddots & \vdots\\
a_{k1} & a_{k3} & \dots & a_{kk}\end{vmatrix}-\dots\pm a_{1k}\begin{vmatrix}a_{21} & a_{22} & \dots & a_{2(k-1)}\\
\vdots & \vdots & \ddots & \vdots\\
a_{k1} & a_{k2} & \dots & a_{k(k-1)}\end{vmatrix}\]

\end_inset


\end_layout

\begin_layout Subsection
Invsersions
\end_layout

\begin_layout Standard
\begin_inset Formula \[
AA^{-1}=I\]

\end_inset


\end_layout

\begin_layout Subsubsection
\begin_inset Formula $2\times2$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \[
A=\begin{bmatrix}a & b\\
c & d\end{bmatrix}\]

\end_inset


\begin_inset Formula \begin{eqnarray*}
A^{-1} & = & \frac{1}{\det[A]}\begin{bmatrix}d & -b\\
-c & a\end{bmatrix}\\
\\ & = & \frac{1}{ad-bc}\begin{bmatrix}d & -b\\
-c & a\end{bmatrix}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsubsection
\begin_inset Formula $3\times3$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \[
A=\begin{bmatrix}a_{11} & a_{12} & a_{13}\\
a_{21} & a_{22} & a_{23}\\
a_{31} & a_{32} & a_{33}\end{bmatrix}\]

\end_inset


\begin_inset Formula \[
A^{-1}=\frac{1}{\det[A]}\begin{bmatrix}\begin{vmatrix}a_{22} & a_{23}\\
a_{32} & a_{33}\end{vmatrix} & \begin{vmatrix}a_{13} & a_{12}\\
a_{33} & a_{32}\end{vmatrix} & \begin{vmatrix}a_{12} & a_{13}\\
a_{22} & a_{23}\end{vmatrix}\\
\\\begin{vmatrix}a_{23} & a_{21}\\
a_{33} & a_{31}\end{vmatrix} & \begin{vmatrix}a_{11} & a_{13}\\
a_{31} & a_{33}\end{vmatrix} & \begin{vmatrix}a_{13} & a_{11}\\
a_{23} & a_{21}\end{vmatrix}\\
\\\begin{vmatrix}a_{21} & a_{22}\\
a_{31} & a_{32}\end{vmatrix} & \begin{vmatrix}a_{12} & a_{11}\\
a_{32} & a_{31}\end{vmatrix} & \begin{vmatrix}a_{11} & a_{12}\\
a_{21} & a_{22}\end{vmatrix}\end{bmatrix}\]

\end_inset


\end_layout

\begin_layout Section
Integration
\end_layout

\begin_layout Itemize
\begin_inset Formula $\int\, a\, dx=kx$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\int\, x^{a}\, dx=\frac{x^{a+1}}{a+1}$
\end_inset


\end_layout

\begin_layout Section
Derivatives
\end_layout

\begin_layout Itemize
\begin_inset Formula $\frac{d}{dx}\, c=0$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\frac{d}{dx}\, x=1$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\frac{d}{dx}\, cx=c$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\frac{d}{dx}\, x^{c}=cx^{c-1}$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\frac{d}{dx}\,\frac{1}{x^{c}}=\frac{d}{dx}\, x^{-c}=-cx^{-\left(c+1\right)}=-\frac{c}{x^{c+1}}$
\end_inset


\end_layout

\begin_layout Itemize

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
\begin_inset Formula $\frac{d}{dx}\,\sqrt{x}=\frac{d}{dx}\, x^{\frac{1}{2}}=\frac{1}{2}x^{-\frac{1}{2}}=\frac{1}{2\sqrt{x}}\ x>0$
\end_inset


\end_layout

\end_body
\end_document
